---
title: "TICQ Report: `r params$title`"
subtitle: "Total Ion Current Quality Assessment of Mass Spectrometry Spectral Data"
author: "Vimalnath Nambiar and Shabarinath Nambiar"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: 
  html_notebook:
    toc: true
    toc_float: true
    toc_depth: 6
    theme: paper
  html_document:
    toc: true
    toc_float: true
    toc_depth: 6
    theme: paper
params:
    title: "test"
    inputPath: "/run/media/vimalnathnambiar/WD/data/JSON/test/"
    outputDirectoryPath: NULL
    historicalDataPath: NULL
    targetFilePath: NULL
    anpcMethodLibrary: "MS-AA-POS"
    chromatogramRegion: NULL
    roundDecimalPlace: 4
    metadataAnonymiser: FALSE
---

# Configuration Parameters {.tabset}
Parameters configured for TICQ assessment.
```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Load packages
loadPackage(packageName = c("DT", "dplyr"))

# Configuration parameters
inputPath <- params$inputPath
outputDirectoryPath <- params$outputDirectoryPath
historicalDataPath <- params$historicalDataPath
targetFilePath <- params$targetFilePath
anpcMethodLibrary <- params$anpcMethodLibrary
chromatogramRegion <- params$chromatogramRegion
roundDecimalPlace <- params$roundDecimalPlace
metadataAnonymiser <- params$metadataAnonymiser
```

## Input
```{r, echo = FALSE, warning = FALSE}
# Validate input path
jsonFileCount <- length(retrieveFileName(inputPath = inputPath, fileExtension = "JSON"))
if (jsonFileCount == 0) {
  stop("Invalid 'inputPath': No available JSON file(s) was found at the specified path")
} 

# Update new sample status
newSampleStatus <- TRUE
print(paste("Input path:", inputPath))
print(paste("Available JSON files:", jsonFileCount))

rm(jsonFileCount)
```

## Output
```{r, echo = FALSE, warning = FALSE}
# Validate output directory path
if (length(outputDirectoryPath) == 0) {
  message(paste0("Setting default path"))
  outputDirectoryPath <- paste0(getwd(), "/output/")
}
createDirectoryPath(parameterName = 'outputDirectoryPath', parameterValue = outputDirectoryPath)
print(paste("Output directory path:", outputDirectoryPath))
```

## Historical Data
```{r, echo = FALSE, warning = FALSE}
# Validate historical data path
if (!is.null(historicalDataPath)) {
  if (length(parameterValue) != 1 || !is.character(parameterValue) || is.na(parameterValue) || parameterValue == "") {
    stop("Invalid 'historicalDataPath: Must either be NULL or a non-NA, non-empty character string of length 1")
  } else if (!validateFileExtension(parameterName = 'historicalDataPath', parameterValue = historicalDataPath, fileExtension = "RDS")) {
    stop("Invalid 'historicalDataPath': No available RDS file found at the specified path")
  }
}

# Update historical data status
historicalDataStatus <- !is.null(historicalDataPath)
if (historicalDataStatus) {
  print(paste("Historical data path:", historicalDataPath))
} else {
  print("No available historical data")
  rm(historicalDataPath)
}
```

## Target File
```{r, echo = FALSE, warning = FALSE}
# Validate target file path and ANPC method library
targetFile <- extractTargetFile(
  targetFilePath = targetFilePath,
  anpcMethodLibrary = anpcMethodLibrary,
  roundDecimalPlace = roundDecimalPlace
)

# Update target file status
targetFileStatus <- !is.null(targetFile)
if (targetFileStatus) {
  DT::datatable(data = targetFile, filter = "top", options = list(scrollX = TRUE))
} else {
  print("No available target file data")
  rm(targetFile)
}

rm(targetFilePath)
```

## Chromatogram Region
```{r, echo = FALSE, warning = FALSE}
# ANPC method library associated chromatogram region data
anpcChromatogramRegionData <- list(
  "MS-AA-POS" = list(massCalibrationEnd = 0.3, washStart = 5),
  "MS-HIL-POS" = list(massCalibrationEnd = 0.7, washStart = 11),
  "MS-HIL-NEG" = list(massCalibrationEnd = 0.7, washStart = 11),
  "MS-RP-POS" = list(massCalibrationEnd = 0.7, washStart = 11),
  "MS-RP-NEG" = list(massCalibrationEnd = 0.7, washStart = 11)
)

# Validate chromatogram region data
if (!is.null(chromatogramRegion) && !validateChromatogramRegion(parameterName = "chromatogramRegion", parameterValue = chromatogramRegion)) {
  message("Setting default value")
  chromatogramRegion <- NULL
}

if (is.null(chromatogramRegion) && !is.null(anpcMethodLibrary) && anpcMethodLibrary %in% names(anpcChromatogramRegionData)) {
  message(paste("Setting new region data (based on ANPC", anpcMethodLibrary, "method library)"))
  chromatogramRegion <- configureChromatogramRegion(
    massCalibrationEnd = anpcChromatogramRegionData[[anpcMethodLibrary]]$massCalibrationEnd,
    washStart = anpcChromatogramRegionData[[anpcMethodLibrary]]$washStart
  )
}

# Update chromatogram region status
chromatogramRegionStatus <- !is.null(chromatogramRegion)
if (chromatogramRegionStatus) {
  print(chromatogramRegion)
} else {
  print("No available chromatogram region data")
}

rm(anpcMethodLibrary, regionPattern, timePattern, anpcChromatogramRegionData)
invisible(gc())
```

# Spectral Data Extraction
Spectral data is extracted from ExfilMS generated JSON files located at input path.
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newSampleStatus) {
  # Extract spectral data and sample metadata
  result <- extractExfilMS(inputPath = inputPath)
  
  # Update new sample status
  newSampleStatus <- nrow(result$passedData) > 0
  if (newSampleStatus) {
    passedData <- result$passedData
    saveRDS(passedData, file = paste0(outputDirectoryPath, params$title, ".rds"))
  }
  
  # Display result
  print(paste("Number of files that failed spectral data extraction:", nrow(result$failedData)))
  if (nrow(result$failedData) != 0) {
    print(DT::datatable(data = result$failedData, filter = "top", options = list(scrollX = TRUE)) %>%
            DT::formatStyle("fileName", target = "row", backgroundColor = "pink"))
  }
  
  rm(inputPath, result)
  invisible(gc())
} else {
  message("Unable to perform Spectral Data Extraction: No available JSON files")
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample status
if (newSampleStatus) {
  # Column names of extracted spectral data
  sampleID <- "sampleID"
  project <- "project"
  cohort <- "cohort"
  projectCohort <- "projectCohort"
  sampleType <- "sampleType"
  method <- "method"
  instrument <- "instrument"
  plate <- "plate"
  timestamp <- "timestamp"
  spectrumCount <- "spectrumCount"
  arrayLength <- "spectrum.arrayLength"
  msLevel <- "spectrum.msLevel"
  retentionTime <- "spectrum.retentionTime"
  basePeakIntensity <- "spectrum.basePeakIntensity"
  totalIonCurrent <- "spectrum.totalIonCurrent"
  mzArray <- "spectrum.mzArray"
  intensityArray <- "spectrum.intensityArray"
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Validate metadata anonymiser
validateLogicalValue(parameterName = "metadataAnonymiser", parameterValue = metadataAnonymiser)

# Check new sample status and anonymise metadata
if (newSampleStatus && metadataAnonymiser) {
  passedData <- anonymiseMetadata(
    data = passedData,
    sampleID = sampleID,
    project = project,
    cohort = cohort,
    projectCohort = projectCohort,
    method = method,
    instrument = instrument,
    plate = plate
  )
}

rm(metadataAnonymiser)
```

# Preliminary Data Check {.tabset}
## Undefined Sample Type Check
Extracted samples are checked for the presence of undefined sample type (based on metadata).
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newSampleStatus) {
  # Check undefined sample types
  result <- checkUndefinedSampleType(
    data = passedData,
    commonColumn = colnames(passedData)[which(colnames(passedData) == sampleID):which(colnames(passedData) == spectrumCount)],
    sampleType = sampleType,
    spectrumCount = spectrumCount
  )
  
  # Update new sample status
  newSampleStatus <- nrow(result$passedData) > 0
  if (newSampleStatus) {
    passedData <- result$passedData
  } else {
    rm(
      passedData,
      sampleID,
      project,
      cohort,
      projectCohort,
      sampleType,
      method,
      instrument,
      plate,
      timestamp,
      spectrumCount,
      arrayLength,
      msLevel,
      retentionTime,
      basePeakIntensity,
      totalIonCurrent,
      mzArray,
      intensityArray
    )
    invisible(gc())
  }
  
  # Display result
  print(paste("Number of samples with undefined sample type:", nrow(result$failedData)))
  if (nrow(result$failedData) != 0) {
    print(DT::datatable(data = result$failedData, filter = "top", options = list(scrollX = TRUE)) %>%
            DT::formatStyle("sampleType", target = "row", backgroundColor = "pink"))
  }
  
  rm(result)
  invisible(gc())
} else {
  message("Unable to perform Undefined Sample Type Check: No available sample data")
}
```

## Spectrum Count Check
The total number of spectral data (spectrum count) of each sample is checked against a threshold limit below the average mean of all samples.
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newSampleStatus) {
  # Check historical data status
  if (historicalDataStatus) {
    historicalData <- readRDS(historicalDataPath)
    if (ncol(historicalData) == ncol(passedData) && all(colnames(historicalData) == colnames(passedData))) {
      passedData <- rbind(historicalData, passedData)
    } else {
      message("Unable to append historical data: Inconsistencies between historical and sample data")
    }
    rm(historicalData)
    invisible(gc())
  }
  
  # Check spectrum count
  result <- if (length(unique(passedData[[sampleID]])) > 1) {
    checkSpectrumCount(
      data = passedData,
      commonColumn = colnames(passedData)[which(colnames(passedData) == sampleID):which(colnames(passedData) == spectrumCount)],
      sampleID = sampleID,
      spectrumCount = spectrumCount
    )
  } else {
    message("Unable to perform Spectrum Count Check: Only one sample data available")
    NULL
  }
  
  # Check result
  if (!is.null(result)) {
    # Remove historical data
    result$passedData <- result$passedData %>%
      dplyr::filter(.data[[projectCohort]] != "Historical")
    
    result$failedData <- result$failedData %>%
      dplyr::filter(.data[[projectCohort]] != "Historical")
    
    # Update new sample status
    newSampleStatus <- nrow(result$passedData) > 0
    if (newSampleStatus) {
      passedData <- result$passedData
    } else {
      rm(
        passedData,
        sampleID,
        project,
        cohort,
        projectCohort,
        sampleType,
        method,
        instrument,
        plate,
        timestamp,
        spectrumCount,
        arrayLength,
        msLevel,
        retentionTime,
        basePeakIntensity,
        totalIonCurrent,
        mzArray,
        intensityArray
      )
      invisible(gc())
    }
    
    # Display result
    print(paste("Sample size (n):", result$n))
    print(paste("Spectrum count (SUM):", result$sum))
    print(paste("Spectrum count (MEAN):", result$mean))
    print(paste("Accepted threshold limit (%):", result$threshold))
    print(paste("Samples with a spectrum count outside the accepted threshold limit:", nrow(result$failedData)))
    if (nrow(result$failedData) != 0) {
      print(DT::datatable(data = result$failedData, filter = "top", options = list(scrollX = TRUE)) %>%
              DT::formatStyle("spectrumCount", target = "row", backgroundColor = "pink"))
    }
  }
  
  rm(result)
  invisible(gc())
} else {
  message("Unable to perform Spectrum Count Check: No available sample data")
}
```

# Available Sample Types
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and display available sample type list
if (newSampleStatus) {
  sampleTypeList <- unique(passedData[[sampleType]])
  print(sampleTypeList)
} else {
  print("No available data")
}
```

# Total Ion Chromatogram {.tabset}
Chromatogram overview (Total ion current, TIC vs Retention Time, RT) of each sample type along with 3 chromatographic regions of interest (mass calibration, analyte, and wash regions) are plotted using full scan MS level 1 spectral data.
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newSampleStatus) {
  # Check and update spectral data status
  spectralDataStatus <- any(passedData[[msLevel]] == 1)
  if (spectralDataStatus) {
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 1) %>%
      dplyr::select(
        all_of(colnames(passedData)[which(colnames(passedData) == sampleID):which(colnames(passedData) == spectrumCount)]),
        retentionTime, totalIonCurrent
      )
    
    # Check historical data status
    if (historicalDataStatus) {
      historicalData <- readRDS(historicalDataPath)
      if (ncol(historicalData) == ncol(passedData) && all(colnames(historicalData) == colnames(passedData))) {
        plotData <- historicalData %>%
          dplyr::filter(.data[[msLevel]] == 1) %>%
          dplyr::select(
            all_of(colnames(historicalData)[which(colnames(historicalData) == sampleID):which(colnames(historicalData) == spectrumCount)]),
            retentionTime, totalIonCurrent
          ) %>%
          rbind(., plotData)
      } else {
        message("Unable to append historical data: Inconsistencies between historical and sample data")
      }
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
    x <- retentionTime
    y <- totalIonCurrent
    title <- "Total Ion Chromatogram"
    xLabel <- "RT"
    yLabel <- "TIC"
    colour <- if (length(unique(plotData[[projectCohort]])) > 1) projectCohort else plate
    colourLabel <- if (length(unique(plotData[[projectCohort]])) > 1) "Project" else "Plate"
  } else {
    message("Unable to display Total Ion Chromatogram: No available MS level 1 spectral data")
  }
} else {
  message("Unable to display Total Ion Chromatogram: No available sample data")
}
```

## LTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Display total ion chromatogram
  pattern <- c("sLTR Plasma", "LTR Plasma", "sLTR Serum", "LTR Serum", "sLTR Urine", "LTR Urine")
  if (any(pattern %in% sampleTypeList)) {
    for (i in unique(sub("sLTR |LTR ", "", pattern))) {
      tmpPattern <- c(paste("sLTR", i), paste("LTR", i))
      if (any(tmpPattern %in% sampleTypeList)) {
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = paste("LTR", i),
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
      rm(tmpPattern)
    }
  } else {
    print("No available data")
  }
}
```

## dLTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Display total ion chromatogram
  pattern <- c("dLTR Plasma", "dLTR Serum", "dLTR Urine")
  if (any(pattern %in% sampleTypeList)) {
    for (i in pattern) {
      if (i %in% sampleTypeList) {
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## PQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Display total ion chromatogram
  pattern <- c("PQC Plasma", "PQC Serum", "PQC Urine")
  if (any(pattern %in% sampleTypeList)) {
    for (i in pattern) {
      if (i %in% sampleTypeList) {
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## dPQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Display total ion chromatogram
  pattern <- c("dPQC Plasma", "dPQC Serum", "dPQC Urine")
  if (any(pattern %in% sampleTypeList)) {
    for (i in pattern) {
      if (i %in% sampleTypeList) {
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## QC
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Display total ion chromatogram
  pattern <- c("QC01", "QC02", "QC03", "QC04")
  if (any(pattern %in% sampleTypeList)) {
    for (i in pattern) {
      if (i %in% sampleTypeList) {
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## CAL
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Display total ion chromatogram
  pattern <- c("CAL01", "CAL02", "CAL03", "CAL04", "CAL05", "CAL06", "CAL07", "CAL08")
  if (any(pattern %in% sampleTypeList)) {
    for (i in pattern) {
      if (i %in% sampleTypeList) {
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Display total ion chromatogram
  pattern <- c("Single Blank", "Double Blank")
  if (any(pattern %in% sampleTypeList)) {
    for (i in pattern) {
      if (i %in% sampleTypeList) {
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## Sample
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Display total ion chromatogram
  pattern <- c("Sample Plasma", "Sample Serum", "Sample Urine")
  if (any(pattern %in% sampleTypeList)) {
    for (i in pattern) {
      if (i %in% sampleTypeList) {
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## dSample
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Display total ion chromatogram
  pattern <- c("dSample Plasma", "dSample Serum", "dSample Urine")
  if (any(pattern %in% sampleTypeList)) {
    for (i in pattern) {
      if (i %in% sampleTypeList) {
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
  
  rm(x, y, title, xLabel, yLabel, colour, colourLabel, pattern, i)
}
```

# Statistical Analysis {.tabset}
The chromatogram regions of interest (mass calibration, analyte, and wash regions) of the samples are assessed by their corresponding sample type using statistical methodologies such as principal component, time series, and violin plot analyses.
```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Splice chromatogram regions
  plotData <- spliceChromatogramRegion(
    data = plotData,
    commonColumn = colnames(plotData)[which(colnames(plotData) == sampleID):which(colnames(plotData) == spectrumCount)],
    spectrumCount = spectrumCount,
    chromatogramRegion = chromatogramRegion,
    retentionTime = retentionTime,
    sumColumn = totalIonCurrent
  )

  prewashRegion <- "prewashRegion"
  massCalibrationRegion <- "massCalibrationRegion"
  analyteRegion <- "analyteRegion"
  washRegion <- "washRegion"

  # Plot variables and labels
  shape <- sampleType
  shapeLabel <-  "Sample Type"
  colour <- if (length(unique(plotData[[projectCohort]])) > 1) projectCohort else plate
  colourLabel <- if (length(unique(plotData[[projectCohort]])) > 1) "Project" else "Plate"
} else if (!chromatogramRegionStatus) {
  rm(plotData)
  invisible(gc())
}
```

## Principal Component Analysis (PCA) {.tabset}
PCA provides an overview of the overall sample variance influenced by the 3 chromatogram regions of interest: mass calibration, analyte, and wash regions.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Plot variables and labels
  firstColumnIndex <- which(colnames(plotData) == massCalibrationRegion)
  scoresPlotToggle <- FALSE
  loadingsPlotToggle <- FALSE
} else if (!newSampleStatus) {
  message("Unable to perform Principal Component Analysis: No available sample data")
} else if (!spectralDataStatus) {
  message("Unable to perform Principal Component Analysis: No available MS level 1 spectral data")
} else if (!chromatogramRegionStatus) {
  message("Unable to perform Principal Component Analysis: No available chromatogram region data")
}
```

### LTR {.tabset}
#### LTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("sLTR Plasma", "LTR Plasma")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = "LTR Plasma",
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("sLTR Serum", "LTR Serum")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = "LTR Serum",
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("sLTR Urine", "LTR Urine")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = "LTR Urine",
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

### dLTR {.tabset}
#### dLTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("dLTR Plasma")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("dLTR Serum")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("dLTR Urine")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

### PQC {.tabset}
#### PQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("PQC Plasma")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("PQC Serum")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("PQC Urine")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

### dPQC {.tabset}
#### dPQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("dPQC Plasma")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("dPQC Serum")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("dPQC Urine")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

### QC {.tabset}
#### QC01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("QC01")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### QC02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("QC02")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### QC03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("QC03")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### QC04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("QC04")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

### CAL {.tabset}
#### CAL01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("CAL01")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### CAL02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("CAL02")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### CAL03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("CAL03")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### CAL04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("CAL04")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### CAL05
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("CAL05")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### CAL06
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("CAL06")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### CAL07
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("CAL07")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### CAL08
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("CAL08")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

### Blank {.tabset}
#### Single Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("Single Blank")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### Double Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("Double Blank")
  if (any(pattern %in% sampleTypeList)) {
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

### Sample {.tabset}
#### Sample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("Sample Plasma")
  if (any(pattern %in% sampleTypeList)) {
    tmpPattern <- c("sLTR Plasma", "LTR Plasma")
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
    rm(tmpPattern)
  } else {
    print("No available data")
  }
}
```

#### Sample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("Sample Serum")
  if (any(pattern %in% sampleTypeList)) {
    tmpPattern <- c("sLTR Serum", "LTR Serum")
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
    rm(tmpPattern)
  } else {
    print("No available data")
  }
}
```

#### Sample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("Sample Urine")
  if (any(pattern %in% sampleTypeList)) {
    tmpPattern <- c("sLTR Urine", "LTR Urine")
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
    rm(tmpPattern)
  } else {
    print("No available data")
  }
}
```

### dSample {.tabset}
#### dSample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("dSample Plasma")
  if (any(pattern %in% sampleTypeList)) {
    tmpPattern <- c("dLTR Plasma")
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
    rm(tmpPattern)
  } else {
    print("No available data")
  }
}
```

#### dSample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("dSample Serum")
  if (any(pattern %in% sampleTypeList)) {
    tmpPattern <- c("dLTR Serum")
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
    rm(tmpPattern)
  } else {
    print("No available data")
  }
}
```

#### dSample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display principal component analysis
  pattern <- c("dSample Urine")
  if (any(pattern %in% sampleTypeList)) {
    tmpPattern <- c("dLTR Urine")
    displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
    rm(tmpPattern)
  } else {
    print("No available data")
  }
  
  rm(firstColumnIndex, scoresPlotToggle, loadingsPlotToggle, pattern)
}
```

## Time Series Analysis {.tabset}
Time series analysis focuses on the prewash region (combined mass calibration and analyte regions). This analysis provides a temporal trendline and assesses the combined performance of mass calibration references, internal standards and endogenous analytes present within the samples in the region. A report is generated highlighting the samples that have a significant 1st and 2nd standard deviation from the average mean performance of the region.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Plot variables and labels
  x <- timestamp
  y <- prewashRegion
  title <- "Time Series Analysis"
  xLabel <- "Timestamp"
  yLabel <- "Prewash Region (TIC)"
  boundary <- "sd"
  xTickToggle <- FALSE
  
  # Data frame to store analysis result
  analysisResult_TS <- data.frame()
} else if (!newSampleStatus) {
  message("Unable to perform Time Series Analysis: No available sample data")
} else if (!spectralDataStatus) {
  message("Unable to perform Time Series Analysis: No available MS level 1 spectral data")
} else if (!chromatogramRegionStatus) {
  message("Unable to perform Time Series Analysis: No available chromatogram region data")
}
```

### LTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma", "sLTR Serum", "LTR Serum", "sLTR Urine", "LTR Urine")

  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in unique(sub("sLTR |LTR ", "", pattern))) {
      # Check pattern
      tmpPattern <- c(paste("sLTR", i), paste("LTR", i))
      if (any(tmpPattern %in% sampleTypeList)) {
        # Perform time series analysis
        analysisResult_TS <- displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = paste("LTR", i),
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          xTickToggle = xTickToggle
        ) %>%
          rbind(analysisResult_TS, .)
      }

      # Clean environment
      rm(tmpPattern)
    }
  } else {
    print("No available data")
  }
}
```

### dLTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma", "dLTR Serum", "dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform time series analysis
        analysisResult_TS <- displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          xTickToggle = xTickToggle
        ) %>%
          rbind(analysisResult_TS, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

### PQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma", "PQC Serum", "PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform time series analysis
        analysisResult_TS <- displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          xTickToggle = xTickToggle
        ) %>%
          rbind(analysisResult_TS, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

### dPQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma", "dPQC Serum", "dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform time series analysis
        analysisResult_TS <- displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          xTickToggle = xTickToggle
        ) %>%
          rbind(analysisResult_TS, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

### QC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("QC01", "QC02", "QC03", "QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform time series analysis
        analysisResult_TS <- displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          xTickToggle = xTickToggle
        ) %>%
          rbind(analysisResult_TS, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

### CAL
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("CAL01", "CAL02", "CAL03", "CAL04", "CAL05", "CAL06", "CAL07", "CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform time series analysis
        analysisResult_TS <- displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          xTickToggle = xTickToggle
        ) %>%
          rbind(analysisResult_TS, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

### Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank", "Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform time series analysis
        analysisResult_TS <- displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          xTickToggle = xTickToggle
        ) %>%
          rbind(analysisResult_TS, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

### Sample
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma", "Sample Serum", "Sample Urine")

  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Compare against long term references
        tmpPattern <- sub("Sample ", "", i)
        tmpPattern <- c(paste("sLTR", tmpPattern), paste("LTR", tmpPattern))
                
        # Perform time series analysis
        analysisResult_TS <- displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          referenceData = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          xTickToggle = xTickToggle
        ) %>%
          dplyr::filter(.data[[sampleType]] %in% i) %>%
          rbind(analysisResult_TS, .)
        
        # Clean environment
        rm(tmpPattern)
      }
    }
  } else {
    print("No available data")
  }
}
```

### dSample
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma", "dSample Serum", "dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Compare against long term references
        tmpPattern <- sub("dSample ", "", i)
        tmpPattern <- c(paste("dLTR", tmpPattern))
                
        # Perform time series analysis
        analysisResult_TS <- displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          referenceData = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          xTickToggle = xTickToggle
        ) %>%
          dplyr::filter(.data[[sampleType]] %in% i) %>%
          rbind(analysisResult_TS, .)
        
        # Clean environment
        rm(tmpPattern)
      }
    }
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(x, y, title, xLabel, yLabel, boundary, xTickToggle, pattern, i)
}
```

## Violin Plot Analysis {.tabset}
Violin plot analysis focuses on the two distinct chromatogram regions that made up the prewash region previously assessed - mass calibration and analyte region. Two reports are generated highlighting the samples that have a significant 1st and 2nd standard deviation from the average mean of the overall data distribution in the two regions, respectively.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Plot variables and labels
  x <- instrument
  title <- "Violin Plot Analysis"
  xLabel <- "Instrument"
  boundary <- "sd"
  boxWidth <- 0.05
} else if (!newSampleStatus) {
  message("Unable to perform Violin Plot Analysis: No available sample data")
} else if (!spectralDataStatus) {
  message("Unable to perform Violin Plot Analysis: No available MS level 1 spectral data")
} else if (!chromatogramRegionStatus) {
  message("Unable to perform Violin Plot Analysis: No available chromatogram region data")
}
```

### Mass Calibration Region {.tabset}
Violin plot analysis of the mass calibration region assesses the performance of the mass calibration references present within the samples.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Plot variables and labels
  y <- massCalibrationRegion
  yLabel <- "Mass Calibration Region (TIC)"
  
  # Data frame to store analysis result
  analysisResult_VP_massCalibrationRegion <- data.frame()
}
```

#### LTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma", "sLTR Serum", "LTR Serum", "sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in unique(sub("sLTR |LTR ", "", pattern))) {
      # Check pattern
      tmpPattern <- c(paste("sLTR", i), paste("LTR", i))
      if (any(tmpPattern %in% sampleTypeList)) {
        # Perform violin plot analysis
        analysisResult_VP_massCalibrationRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = paste("LTR", i),
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        ) %>%
          rbind(analysisResult_VP_massCalibrationRegion, .)
      }
      
      # Clean environment
      rm(tmpPattern)
    }
  } else {
    print("No available data")
  }
}
```

#### dLTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma", "dLTR Serum", "dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform violin plot analysis
        analysisResult_VP_massCalibrationRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        ) %>%
          rbind(analysisResult_VP_massCalibrationRegion, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### PQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma", "PQC Serum", "PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform violin plot analysis
        analysisResult_VP_massCalibrationRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        ) %>%
          rbind(analysisResult_VP_massCalibrationRegion, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### dPQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma", "dPQC Serum", "dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform violin plot analysis
        analysisResult_VP_massCalibrationRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        ) %>%
          rbind(analysisResult_VP_massCalibrationRegion, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### QC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("QC01", "QC02", "QC03", "QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform violin plot analysis
        analysisResult_VP_massCalibrationRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        ) %>%
          rbind(analysisResult_VP_massCalibrationRegion, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### CAL
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("CAL01", "CAL02", "CAL03", "CAL04", "CAL05", "CAL06", "CAL07", "CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform violin plot analysis
        analysisResult_VP_massCalibrationRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        ) %>%
          rbind(analysisResult_VP_massCalibrationRegion, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank", "Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform violin plot analysis
        analysisResult_VP_massCalibrationRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        ) %>%
          rbind(analysisResult_VP_massCalibrationRegion, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### Sample
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma", "Sample Serum", "Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Compare against long term references
        tmpPattern <- sub("Sample ", "", i)
        tmpPattern <- c(paste("sLTR", tmpPattern), paste("LTR", tmpPattern))
        
        # Perform violin plot analysis
        analysisResult_VP_massCalibrationRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          referenceData = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          boxWidth = boxWidth
        ) %>%
          dplyr::filter(.data[[sampleType]] %in% i) %>%
          rbind(analysisResult_VP_massCalibrationRegion, .)
        
        # Clean environment
        rm(tmpPattern)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### dSample
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma", "dSample Serum", "dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Compare against long term references
        tmpPattern <- sub("dSample ", "", i)
        tmpPattern <- c(paste("dLTR", tmpPattern))
        
        # Perform violin plot analysis
        analysisResult_VP_massCalibrationRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          referenceData = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          boxWidth = boxWidth
        ) %>%
          dplyr::filter(.data[[sampleType]] %in% i) %>%
          rbind(analysisResult_VP_massCalibrationRegion, .)
        
        # Clean environment
        rm(tmpPattern)
      }
    }
  } else {
    print("No available data")
  }
}
```

### Analyte Region {.tabset}
Violin plot analysis of the analyte region assesses the combined performance of the internal standards and endogenous analytes present within the samples.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Plot variables and labels
  y <- analyteRegion
  yLabel <- "Analyte Region (TIC)"
  
  # Data frame to store analysis result
  analysisResult_VP_analyteRegion <- data.frame()
}
```

#### LTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma", "sLTR Serum", "LTR Serum", "sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in unique(sub("sLTR |LTR ", "", pattern))) {
      # Check pattern
      tmpPattern <- c(paste("sLTR", i), paste("LTR", i))
      if (any(tmpPattern %in% sampleTypeList)) {
        # Perform violin plot analysis
        analysisResult_VP_analyteRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = paste("LTR", i),
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        ) %>%
          rbind(analysisResult_VP_analyteRegion, .)
      }
      
      # Clean environment
      rm(tmpPattern)
    }
  } else {
    print("No available data")
  }
}
```

#### dLTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma", "dLTR Serum", "dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform violin plot analysis
        analysisResult_VP_analyteRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        ) %>%
          rbind(analysisResult_VP_analyteRegion, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### PQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma", "PQC Serum", "PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform violin plot analysis
        analysisResult_VP_analyteRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        ) %>%
          rbind(analysisResult_VP_analyteRegion, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### dPQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma", "dPQC Serum", "dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform violin plot analysis
        analysisResult_VP_analyteRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        ) %>%
          rbind(analysisResult_VP_analyteRegion, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### QC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("QC01", "QC02", "QC03", "QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform violin plot analysis
        analysisResult_VP_analyteRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        ) %>%
          rbind(analysisResult_VP_analyteRegion, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### CAL
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("CAL01", "CAL02", "CAL03", "CAL04", "CAL05", "CAL06", "CAL07", "CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform violin plot analysis
        analysisResult_VP_analyteRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        ) %>%
          rbind(analysisResult_VP_analyteRegion, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank", "Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Perform violin plot analysis
        analysisResult_VP_analyteRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        ) %>%
          rbind(analysisResult_VP_analyteRegion, .)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### Sample
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma", "Sample Serum", "Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Compare against long term references
        tmpPattern <- sub("Sample ", "", i)
        tmpPattern <- c(paste("sLTR", tmpPattern), paste("LTR", tmpPattern))
        
        # Perform violin plot analysis
        analysisResult_VP_analyteRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          referenceData = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          boxWidth = boxWidth
        ) %>%
          dplyr::filter(.data[[sampleType]] %in% i) %>%
          rbind(analysisResult_VP_analyteRegion, .)
        
        # Clean environment
        rm(tmpPattern)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### dSample
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma", "dSample Serum", "dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Compare against long term references
        tmpPattern <- sub("dSample ", "", i)
        tmpPattern <- c(paste("dLTR", tmpPattern))
        
        # Perform violin plot analysis
        analysisResult_VP_analyteRegion <- displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          referenceData = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          boxWidth = boxWidth
        ) %>%
          dplyr::filter(.data[[sampleType]] %in% i) %>%
          rbind(analysisResult_VP_analyteRegion, .)
        
        # Clean environment
        rm(tmpPattern)
      }
    }
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData, prewashRegion, massCalibrationRegion, analyteRegion, washRegion, shape, shapeLabel, colour, colourLabel, x, title, xLabel,
     boundary, boxWidth, y, yLabel, pattern, i)
  invisible(gc())
}
```

# Report {.tabset}
## Time Series Analysis
The report highlights the deviation significance of the samples from the average mean performance of the prewash region.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal  
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display analysis result
  if (ncol(analysisResult_TS) != 0) {
    print(
      DT::datatable(
        data = analysisResult_TS %>%
          dplyr::select(
            all_of(
              colnames(analysisResult_TS)[which(colnames(analysisResult_TS) == sampleID):which(colnames(analysisResult_TS) == spectrumCount)]
            ),
            prewashRegion, sampleRange
          ) %>%
          dplyr::filter(.data[[projectCohort]] != "Historical"),
        filter = "top", options = list(scrollX = TRUE)
      ) %>%
        DT::formatStyle(
          "sampleRange", target = "row",
          backgroundColor = styleEqual(
            c("Very Low", "Low", "Normal", "High", "Very High"),
            c("pink", "lightyellow", "lightgreen", "lightyellow", "pink")
          )
        )
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(analysisResult_TS)
  invisible(gc())
} else if (!newSampleStatus) {
  message("Unable to report Time Series Analysis: No available sample data")
} else if (!spectralDataStatus) {
  message("Unable to report Time Series Analysis: No available MS level 1 spectral data")
} else if (!chromatogramRegionStatus) {
  message("Unable to report Time Series Analysis: No available chromatogram region data")
}
```

## Violin Plot Analysis {.tabset}
The reports below highlights the deviation significance of the samples from the average mean of the overall data distribution in the mass calibration and analyte regions, respectively.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (!newSampleStatus) {
  message("Unable to report Violin Plot Analysis: No available sample data")
} else if (!spectralDataStatus) {
  message("Unable to report Violin Plot Analysis: No available MS level 1 spectral data")
} else if (!chromatogramRegionStatus) {
  message("Unable to report Violin Plot Analysis: No available chromatogram region data")
}
```

### Mass Calibration Region
The report highlights the deviation significance of the performance of the mass calibration references present within the samples.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal    
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display analysis result
  if (ncol(analysisResult_VP_massCalibrationRegion) != 0) {
    print(
      DT::datatable(
        data = analysisResult_VP_massCalibrationRegion %>%
          dplyr::select(
            all_of(
              colnames(analysisResult_VP_massCalibrationRegion)[which(colnames(analysisResult_VP_massCalibrationRegion) == sampleID):
                                                                which(colnames(analysisResult_VP_massCalibrationRegion) == spectrumCount)]
            ),
            massCalibrationRegion, sampleRange
          ) %>%
          dplyr::filter(.data[[projectCohort]] != "Historical"),
        filter = "top", options = list(scrollX = TRUE)
      ) %>%
        DT::formatStyle(
          "sampleRange", target = "row", 
          backgroundColor = styleEqual(
            c("Very Low", "Low", "Normal", "High", "Very High"),
            c("pink", "lightyellow", "lightgreen", "lightyellow", "pink")
          )
        )
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(analysisResult_VP_massCalibrationRegion)
  invisible(gc())
}
```

### Analyte Region
The report highlights deviation significance of the combined performance of the internal standards and endogenous analytes present within the samples.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal  
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display analysis result
  if (ncol(analysisResult_VP_analyteRegion) != 0) {
    print(
      DT::datatable(
        data = analysisResult_VP_analyteRegion %>%
          dplyr::select(
            all_of(
              colnames(analysisResult_VP_analyteRegion)[which(colnames(analysisResult_VP_analyteRegion) == sampleID):
                                                        which(colnames(analysisResult_VP_analyteRegion) == spectrumCount)]
            ),
            analyteRegion, sampleRange
          ) %>%
          dplyr::filter(.data[[projectCohort]] != "Historical"),
        filter = "top", options = list(scrollX = TRUE)
      ) %>%
        DT::formatStyle(
          "sampleRange", target = "row",
          backgroundColor = styleEqual(
            c("Very Low", "Low", "Normal", "High", "Very High"),
            c("pink", "lightyellow", "lightgreen", "lightyellow", "pink")
          )
        )
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(analysisResult_VP_analyteRegion)
  invisible(gc())
}

# Check new sample status
if (newSampleStatus) {
  # Clean environment
  rm(spectralDataStatus)
}
```

# Base Peak Chromatogram {.tabset}
Chromatogram overview (Base Peak Intensity, BPI vs Retention Time, RT) of each sample type along with 3 chromatographic regions of interest (mass calibration, analyte, and wash regions) are plotted using full scan MS level 1 spectral data.
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newSampleStatus) {
  # Check and update spectral data status
  spectralDataStatus <- any(passedData[[msLevel]] == 1)
  if (spectralDataStatus) {
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 1) %>%
      dplyr::select(
        all_of(colnames(passedData)[which(colnames(passedData) == sampleID):which(colnames(passedData) == spectrumCount)]),
        retentionTime, basePeakIntensity
      )
    
    # Check historical data status
    if (historicalDataStatus) {
      historicalData <- readRDS(historicalDataPath)
      if (ncol(historicalData) == ncol(passedData) && all(colnames(historicalData) == colnames(passedData))) {
        plotData <- historicalData %>%
          dplyr::filter(.data[[msLevel]] == 1) %>%
          dplyr::select(
            all_of(colnames(historicalData)[which(colnames(historicalData) == sampleID):which(colnames(historicalData) == spectrumCount)]),
            retentionTime, basePeakIntensity
          ) %>%
          rbind(., plotData)
      } else {
        message("Unable to append historical data: Inconsistencies between historical and sample data")
      }
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
    x <- retentionTime
    y <- basePeakIntensity
    title <- "Base Peak Chromatogram"
    xLabel <- "RT"
    yLabel <- "BPI"
    colour <- if (length(unique(plotData[[projectCohort]])) > 1) projectCohort else plate
    colourLabel <- if (length(unique(plotData[[projectCohort]])) > 1) "Project" else "Plate"
  } else {
    message("Unable to display Base Peak Chromatogram: No available MS level 1 spectral data")
  }
} else {
  message("Unable to display Base Peak Chromatogram: No available sample data")
}
```

## LTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma", "sLTR Serum", "LTR Serum", "sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in unique(sub("sLTR |LTR ", "", pattern))) {
      # Check pattern
      tmpPattern <- c(paste("sLTR", i), paste("LTR", i))
      if (any(tmpPattern %in% sampleTypeList)) {
        # Display base peak chromatogram
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = paste("LTR", i),
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
      
      # Clean environment
      rm(tmpPattern)
    }
  } else {
    print("No available data")
  }
}
```

## dLTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma", "dLTR Serum", "dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## PQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma", "PQC Serum", "PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## dPQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma", "dPQC Serum", "dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## QC
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("QC01", "QC02", "QC03", "QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## CAL
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("CAL01", "CAL02", "CAL03", "CAL04", "CAL05", "CAL06", "CAL07", "CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank", "Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## Sample
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma", "Sample Serum", "Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## dSample
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma", "dSample Serum", "dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData, x, y, title, xLabel, yLabel, colour, colourLabel, pattern, i)
  invisible(gc())
}

# Check new sample status
if (newSampleStatus) {
  # Clean environment
  rm(spectralDataStatus)
}
```

# Extracted Ion Chromatogram {.tabset}
Chromatogram overview (Extracted Ion Current, EIC vs Retention Time, RT) of targeted mass calibration references, internal standards, endogenous analytes, and products present within the samples are plotted by their corresponding chromatogram region and sample type. The chromatograms are plotted using MS level 1 spectral data for mass calibration references, internal standards, and endogenous analytes; whereas MS level 2 spectral data is used for products.
```{r, echo = FALSE, warning = FALSE}
# Check new sample and target file status
if (newSampleStatus && targetFileStatus) {
  # Filter target file data
  targetFile <- targetFile[targetFile$msLevel %in% unique(passedData[[msLevel]]), ]
  
  # Update extracted ion status
  extractedIonStatus <- if (length(unique(passedData[[arrayLength]])) != 1 ||
                            nrow(targetFile) == 0 ||
                            length(unique(targetFile$mzValue)) != unique(passedData[[arrayLength]])) FALSE else TRUE
}
```

```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Common data columns
  commonColumn <- colnames(passedData)[which(colnames(passedData) == sampleID):which(colnames(passedData) == spectrumCount)]
  
  # Plot variables and labels
  x <- retentionTime
  title <- "Extracted Ion Chromatogram"
  caption <- "m/z"
  xLabel <- "RT"
  yLabel <- "EIC"
  plotColumn <- 2
  plotRow <- 2
} else if (!newSampleStatus) {
  message("Unable to display Extracted Ion Chromatogram: No available sample data")
} else if (!targetFileStatus) {
  message("Unable to display Extracted Ion Chromatogram: No available target file data")
} else if (!extractedIonStatus) {
  message("Unable to display Extracted Ion Chromatogram: Inconsistencies between spectra and target m/z data")
} else if (!chromatogramRegionStatus) {
  message("Unable to display Extracted Ion Chromatogram: No available chromatogram region data")
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Check and update spectral data status
  spectralDataStatus <- any(passedData[[msLevel]] == 1)
  if (spectralDataStatus) {
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 1)
    
    # Check historical data status
    if (historicalDataStatus) {
      historicalData <- readRDS(historicalDataPath)
      if (ncol(historicalData) == ncol(passedData) &&
          all(colnames(historicalData) == colnames(passedData)) &&
          length(unique(historicalData[[arrayLength]])) == 1 &&
          unique(historicalData[[arrayLength]]) == unique(passedData[[arrayLength]])) {
        plotData <- historicalData %>%
          dplyr::filter(.data[[msLevel]] == 1) %>%
          rbind(., plotData)
      } else {
        message("Unable to append historical data: Inconsistencies between historical and sample data")
      }
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
    colour <- if (length(unique(plotData[[projectCohort]])) > 1) projectCohort else plate
    colourLabel <- if (length(unique(plotData[[projectCohort]])) > 1) "Project" else "Plate"
    
    # Extract extracted ion current (EIC)
    plotData <- extractEIC(data = plotData, intensityArray = intensityArray, targetMZ = as.character(sort(unique(targetFile$mzValue))))
  }
}
```

## Mass Calibration References {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- as.character(
    sort(unique(targetFile %>% dplyr::filter(compoundType == "Mass Calibration Reference" & msLevel == 1) %>% dplyr::pull(mzValue)))
  )
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Extracted ions
    plotData_filtered <- filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$massCalibration,
      retentionTime = retentionTime
    )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
  } else {
    message("Unable to display Extracted Ion Chromatogram: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  message("Unable to display Extracted Ion Chromatogram: No available MS level 1 spectral data")
}
```

### LTR {.tabset}
#### LTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dLTR {.tabset}
#### dLTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### PQC {.tabset}
#### PQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dPQC {.tabset}
#### dPQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### QC {.tabset}
#### QC01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### CAL {.tabset}
#### CAL01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL05
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL06
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL07
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL08
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Blank {.tabset}
#### Single Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Double Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Sample {.tabset}
#### Sample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dSample {.tabset}
#### dSample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern)
  invisible(gc())
}
```

## Internal Standards {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- as.character(
    sort(unique(targetFile %>% dplyr::filter(compoundType == "Internal Standard" & msLevel == 1) %>% dplyr::pull(mzValue)))
  )
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Extracted ions
    plotData_filtered <- filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$analyte,
      retentionTime = retentionTime
    )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
  } else {
    message("Unable to display Extracted Ion Chromatogram: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  message("Unable to display Extracted Ion Chromatogram: No available MS level 1 spectral data")
}
```

### LTR {.tabset}
#### LTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dLTR {.tabset}
#### dLTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### PQC {.tabset}
#### PQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dPQC {.tabset}
#### dPQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### QC {.tabset}
#### QC01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### CAL {.tabset}
#### CAL01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL05
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL06
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL07
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL08
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Blank {.tabset}
#### Single Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Double Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Sample {.tabset}
#### Sample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dSample {.tabset}
#### dSample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern)
  invisible(gc())
}
```

## Endogenous Analytes {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- as.character(
    sort(unique(targetFile %>% dplyr::filter(compoundType == "Endogenous Analyte" & msLevel == 1) %>% dplyr::pull(mzValue)))
  )
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Extracted ions
    plotData_filtered <- filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$analyte,
      retentionTime = retentionTime
    )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
  } else {
    message("Unable to display Extracted Ion Chromatogram: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  message("Unable to display Extracted Ion Chromatogram: No available MS level 1 spectral data")
}
```

### LTR {.tabset}
#### LTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dLTR {.tabset}
#### dLTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### PQC {.tabset}
#### PQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dPQC {.tabset}
#### dPQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### QC {.tabset}
#### QC01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### CAL {.tabset}
#### CAL01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL05
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL06
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL07
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL08
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Blank {.tabset}
#### Single Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Double Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Sample {.tabset}
#### Sample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dSample {.tabset}
#### dSample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern)
  invisible(gc())
}

# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Clean environment
  rm(plotData, colour, colourLabel, targetMzStatus)
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Check and update spectral data status
  spectralDataStatus <- any(passedData[[msLevel]] == 2)
  if (spectralDataStatus) {
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 2)
    
    # Check historical data status
    if (historicalDataStatus) {
      historicalData <- readRDS(historicalDataPath)
      if (ncol(historicalData) == ncol(passedData) &&
          all(colnames(historicalData) == colnames(passedData)) &&
          length(unique(historicalData[[arrayLength]])) == 1 &&
          unique(historicalData[[arrayLength]]) == unique(passedData[[arrayLength]])) {
        plotData <- historicalData %>%
          dplyr::filter(.data[[msLevel]] == 2) %>%
          rbind(., plotData)
      } else {
        message("Unable to append historical data: Inconsistencies between historical and sample data")
      }
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
    colour <- if (length(unique(plotData[[projectCohort]])) > 1) projectCohort else plate
    colourLabel <- if (length(unique(plotData[[projectCohort]])) > 1) "Project" else "Plate"
    
    # Extract extracted ion current (EIC)
    plotData <- extractEIC(data = plotData, intensityArray = intensityArray, targetMZ = as.character(sort(unique(targetFile$mzValue))))
  }
}
```

## Products {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- as.character(
    sort(unique(targetFile %>% dplyr::filter(compoundType == "Product" & msLevel == 2) %>% dplyr::pull(mzValue)))
  )
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Extracted ions
    plotData_filtered <- filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$analyte,
      retentionTime = retentionTime
    )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
  } else {
    message("Unable to display Extracted Ion Chromatogram: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  message("Unable to display Extracted Ion Chromatogram: No available MS level 2 spectral data")
}
```

### LTR {.tabset}
#### LTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dLTR {.tabset}
#### dLTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### PQC {.tabset}
#### PQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dPQC {.tabset}
#### dPQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### QC {.tabset}
#### QC01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### CAL {.tabset}
#### CAL01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL05
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL06
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL07
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL08
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Blank {.tabset}
#### Single Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Double Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Sample {.tabset}
#### Sample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dSample {.tabset}
#### dSample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern)
  invisible(gc())
}

# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Clean environment
  rm(plotData, colour, colourLabel, targetMzStatus)
}

# Check new sample, target file, extracted ion, and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Clean environment
  rm(commonColumn, x, title, caption, xLabel, yLabel, plotColumn, plotRow, spectralDataStatus)
}
```

# Statistical Analysis {.tabset}
The mass calibration references, internal standards, endogenous analytes, and products of interest present within the samples are assessed by their corresponding chromatogram region and sample type using statistical methodologies such as time series analysis.

## Time Series Analysis {.tabset}
Time series analysis provides a temporal trendline and assesses the performance of the mass calibration references, internal standards, endogenous analytes, and products by their corresponding target m/z, chromatogram region, and sample type. A report is generated highlighting the target m/z that have a significant 1st and 2nd standard deviation from the average mean performance.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Common data columns
  commonColumn <- colnames(passedData)[which(colnames(passedData) == sampleID):which(colnames(passedData) == spectrumCount)]
  
  # Plot variables and labels
  x <- timestamp
  title <- "Time Series Analysis"
  caption <- "m/z"
  xLabel <- "Timestamp"
  yLabel <- "EIC"
  shape <- sampleType
  shapeLabel <- "Sample Type"
  boundary <- "sd"
  xTickToggle <- FALSE
  plotColumn <- 2
  plotRow <- 2
} else if (!newSampleStatus) {
  message("Unable to perform Time Series Analysis: No available sample data")
} else if (!targetFileStatus) {
  message("Unable to perform Time Series Analysis: No available target file data")
} else if (!extractedIonStatus) {
  message("Unable to perform Time Series Analysis: Inconsistencies between spectra and target m/z data")
} else if (!chromatogramRegionStatus) {
  message("Unable to perform Time Series Analysis: No available chromatogram region data")
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Check and update spectral data status
  spectralDataStatus <- any(passedData[[msLevel]] == 1)
  if (spectralDataStatus) {
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 1)
    
    # Check historical data status
    if (historicalDataStatus) {
      historicalData <- readRDS(historicalDataPath)
      if (ncol(historicalData) == ncol(passedData) &&
          all(colnames(historicalData) == colnames(passedData)) &&
          length(unique(historicalData[[arrayLength]])) == 1 &&
          unique(historicalData[[arrayLength]]) == unique(passedData[[arrayLength]])) {
        plotData <- historicalData %>%
          dplyr::filter(.data[[msLevel]] == 1) %>%
          rbind(., plotData)
      } else {
        message("Unable to append historical data: Inconsistencies between historical and sample data")
      }
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
    colour <- if (length(unique(plotData[[projectCohort]])) > 1) projectCohort else plate
    colourLabel <- if (length(unique(plotData[[projectCohort]])) > 1) "Project" else "Plate"
    
    # Extract extracted ion current (EIC)
    plotData <- extractEIC(data = plotData, intensityArray = intensityArray, targetMZ = as.character(sort(unique(targetFile$mzValue))))
  }
}
```

### Mass Calibration References {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- as.character(
    sort(unique(targetFile %>% dplyr::filter(compoundType == "Mass Calibration Reference" & msLevel == 1) %>% dplyr::pull(mzValue)))
  )
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Summed extracted ion current
    plotData_filtered <- filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$massCalibration,
      retentionTime = retentionTime
    ) %>%
      sumEIC(
        data = .,
        commonColumn = commonColumn,
        spectrumCount = spectrumCount,
        firstColumnIndex = which(colnames(.) == targetMZ[1])
      )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
    
    # Data frame to store analysis result
    analysisResult_TS_massCalibrationReference <- data.frame()
  } else {
    message("Unable to perform Time Series Analysis: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  message("Unable to perform Time Series Analysis: No available MS level 1 spectral data")
}
```

#### LTR {.tabset}
##### LTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### LTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### LTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

#### dLTR {.tabset}
##### dLTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### dLTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### dLTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

#### PQC {.tabset}
##### PQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### PQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### PQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

#### dPQC {.tabset}
##### dPQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### dPQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### dPQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

#### QC {.tabset}
##### QC01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### QC02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### QC03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### QC04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

#### CAL {.tabset}
##### CAL01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### CAL02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### CAL03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### CAL04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### CAL05
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### CAL06
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### CAL07
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### CAL08
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

#### Blank {.tabset}
##### Single Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

##### Double Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
  } else {
    print("No available data")
  }
}
```

#### Sample {.tabset}
##### Sample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Plasma", "LTR Plasma")
    
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### Sample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Serum", "LTR Serum")
    
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### Sample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Urine", "LTR Urine")
    
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

#### dSample {.tabset}
##### dSample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Plasma")
    
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### dSample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Serum")
    
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### dSample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Urine")
    
    # Perform time series analysis
    analysisResult_TS_massCalibrationReference <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_massCalibrationReference, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
    
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern)
  invisible(gc())
}
```

### Internal Standards {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- as.character(
    sort(unique(targetFile %>% dplyr::filter(compoundType == "Internal Standard" & msLevel == 1) %>% dplyr::pull(mzValue)))
  )
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Summed extracted ion current
    plotData_filtered <- filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$analyte,
      retentionTime = retentionTime
    ) %>%
      sumEIC(
        data = .,
        commonColumn = commonColumn,
        spectrumCount = spectrumCount,
        firstColumnIndex = which(colnames(.) == targetMZ[1])
      )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
    
    # Data frame to store analysis result
    analysisResult_TS_internalStandard <- data.frame()
  } else {
    message("Unable to perform Time Series Analysis: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  message("Unable to perform Time Series Analysis: No available MS level 1 spectral data")
}
```

#### LTR {.tabset}
##### LTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### LTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### LTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

#### dLTR {.tabset}
##### dLTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### dLTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard,)
  } else {
    print("No available data")
  }
}
```

##### dLTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

#### PQC {.tabset}
##### PQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### PQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### PQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

#### dPQC {.tabset}
##### dPQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### dPQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### dPQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

#### QC {.tabset}
##### QC01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### QC02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### QC03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### QC04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

#### CAL {.tabset}
##### CAL01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### CAL02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### CAL03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### CAL04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### CAL05
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### CAL06
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### CAL07
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### CAL08
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

#### Blank {.tabset}
##### Single Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

##### Double Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_internalStandard, .)
  } else {
    print("No available data")
  }
}
```

#### Sample {.tabset}
##### Sample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Plasma", "LTR Plasma")
    
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_internalStandard, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### Sample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Serum", "LTR Serum")
    
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_internalStandard, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### Sample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Urine", "LTR Urine")
    
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_internalStandard, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

#### dSample {.tabset}
##### dSample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Plasma")
    
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_internalStandard, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### dSample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Serum")
    
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_internalStandard, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### dSample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Urine")
    
    # Perform time series analysis
    analysisResult_TS_internalStandard <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_internalStandard, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
    
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern)
  invisible(gc())
}
```

### Endogenous Analytes {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- as.character(
    sort(unique(targetFile %>% dplyr::filter(compoundType == "Endogenous Analyte" & msLevel == 1) %>% dplyr::pull(mzValue)))
  )
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Summed extracted ion current
    plotData_filtered <- filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$analyte,
      retentionTime = retentionTime
    ) %>%
      sumEIC(
        data = .,
        commonColumn = commonColumn,
        spectrumCount = spectrumCount,
        firstColumnIndex = which(colnames(.) == targetMZ[1])
      )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
    
    # Data frame to store analysis result
    analysisResult_TS_endogenousAnalyte <- data.frame()
  } else {
    message("Unable to perform Time Series Analysis: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  message("Unable to perform Time Series Analysis: No available MS level 1 spectral data")
}
```

#### LTR {.tabset}
##### LTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### LTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### LTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

#### dLTR {.tabset}
##### dLTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### dLTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### dLTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

#### PQC {.tabset}
##### PQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### PQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### PQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

#### dPQC {.tabset}
##### dPQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### dPQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### dPQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

#### QC {.tabset}
##### QC01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### QC02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### QC03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### QC04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

#### CAL {.tabset}
##### CAL01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### CAL02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### CAL03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### CAL04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### CAL05
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### CAL06
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### CAL07
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### CAL08
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

#### Blank {.tabset}
##### Single Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

##### Double Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
  } else {
    print("No available data")
  }
}
```

#### Sample {.tabset}
##### Sample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Plasma", "LTR Plasma")
    
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### Sample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Serum", "LTR Serum")
    
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### Sample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Urine", "LTR Urine")
    
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

#### dSample {.tabset}
##### dSample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Plasma")
    
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### dSample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Serum")
    
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### dSample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Urine")
    
    # Perform time series analysis
    analysisResult_TS_endogenousAnalyte <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_endogenousAnalyte, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
    
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern)
  invisible(gc())
}

# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Clean environment
  rm(plotData, colour, colourLabel, targetMzStatus)
  invisible(gc())
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Check and update spectral data status
  spectralDataStatus <- any(passedData[[msLevel]] == 2)
  if (spectralDataStatus) {
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 2)
    
    # Check historical data status
    if (historicalDataStatus) {
      historicalData <- readRDS(historicalDataPath)
      if (ncol(historicalData) == ncol(passedData) &&
          all(colnames(historicalData) == colnames(passedData)) &&
          length(unique(historicalData[[arrayLength]])) == 1 &&
          unique(historicalData[[arrayLength]]) == unique(passedData[[arrayLength]])) {
        plotData <- historicalData %>%
          dplyr::filter(.data[[msLevel]] == 2) %>%
          rbind(., plotData)
      } else {
        message("Unable to append historical data: Inconsistencies between historical and sample data")
      }
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
    colour <- if (length(unique(plotData[[projectCohort]])) > 1) projectCohort else plate
    colourLabel <- if (length(unique(plotData[[projectCohort]])) > 1) "Project" else "Plate"
    
    # Extract extracted ion current (EIC)
    plotData <- extractEIC(data = plotData, intensityArray = intensityArray, targetMZ = as.character(sort(unique(targetFile$mzValue))))
  }
}
```

### Products {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- as.character(
    sort(unique(targetFile %>% dplyr::filter(compoundType == "Product" & msLevel == 2) %>% dplyr::pull(mzValue)))
  )
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Summed extracted ion current
    plotData_filtered <- filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$analyte,
      retentionTime = retentionTime
    ) %>%
      sumEIC(
        data = .,
        commonColumn = commonColumn,
        spectrumCount = spectrumCount,
        firstColumnIndex = which(colnames(.) == targetMZ[1])
      )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
    
    # Data frame to store analysis result
    analysisResult_TS_product <- data.frame()
  } else {
    message("Unable to perform Time Series Analysis: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  message("Unable to perform Time Series Analysis: No available MS level 2 spectral data")
}
```

#### LTR {.tabset}
##### LTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### LTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### LTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

#### dLTR {.tabset}
##### dLTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### dLTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### dLTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

#### PQC {.tabset}
##### PQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### PQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### PQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

#### dPQC {.tabset}
##### dPQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### dPQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### dPQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

#### QC {.tabset}
##### QC01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### QC02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### QC03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### QC04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

#### CAL {.tabset}
##### CAL01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### CAL02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### CAL03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### CAL04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### CAL05
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### CAL06
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### CAL07
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### CAL08
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

#### Blank {.tabset}
##### Single Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

##### Double Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      rbind(analysisResult_TS_product, .)
  } else {
    print("No available data")
  }
}
```

#### Sample {.tabset}
##### Sample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Plasma", "LTR Plasma")
    
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_product, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### Sample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Serum", "LTR Serum")
    
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_product, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### Sample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Urine", "LTR Urine")
    
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_product, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

#### dSample {.tabset}
##### dSample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Plasma")
    
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_product, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### dSample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Serum")
    
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_product, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
}
```

##### dSample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Urine")
    
    # Perform time series analysis
    analysisResult_TS_product <- displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% tmpPattern),
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern) %>%
      rbind(analysisResult_TS_product, .)
    
    # Clean environment
    rm(tmpPattern)
  } else { 
    print("No available data") 
  }
    
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern)
  invisible(gc())
}

# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Clean environment
  rm(plotData, colour, colourLabel, targetMzStatus)
  invisible(gc())
}

# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Clean environment
  rm(commonColumn, x, title, caption, xLabel, yLabel, shape, shapeLabel, boundary, xTickToggle, plotColumn, plotRow, spectralDataStatus)
}
```

## Mass Accuracy Analysis {.tabset}
Mass accuracy analysis provides an assessment of instrument performance in detecting target m/z based on the average mass accuracy (in ppm). A report is generated highlighting the target m/z that falls outside the accepted mass accuracy threshold.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file and extracted ion status
if (newSampleStatus && targetFileStatus && extractedIonStatus) {
  # Common data columns
  commonColumn <- colnames(passedData)[which(colnames(passedData) == sampleID):which(colnames(passedData) == spectrumCount)]
  
  # Target m/z
  targetMZ <- sort(unique(targetFile$mzValue))
  
  # Check historical data status
  massAccuracyData <- passedData
  if (historicalDataStatus) {
    historicalData <- readRDS(historicalDataPath)
    if (ncol(historicalData) == ncol(passedData) &&
        all(colnames(historicalData) == colnames(passedData)) &&
        length(unique(historicalData[[arrayLength]])) == 1 &&
        unique(historicalData[[arrayLength]]) == unique(passedData[[arrayLength]])) {
      massAccuracyData <- rbind(historicalData, massAccuracyData)
    } else {
      message("Unable to append historical data: Inconsistencies between historical and sample data")
    }
    
    # Clean environment
    rm(historicalData)
    invisible(gc())
  }
  
  # Calculate average mass accuracy (in ppm)
  plotData <- countSpectrum(data = massAccuracyData, commonColumn = commonColumn, spectrumCount)
  massAccuracyData <- calculateMassAccuracy(
    data = massAccuracyData,
    mzArray = mzArray,
    targetMZ = targetMZ,
    roundDecimalPlace = roundDecimalPlace
  )
  
    # Loop through each MS level
    uniqueMsLevel <- unique(massAccuracyData[[msLevel]])
    for (i in 1:length(uniqueMsLevel)) {
      # Filter target m/z
      targetMZ_filtered <- sort(unique(targetFile %>% dplyr::filter(msLevel == uniqueMsLevel[i]) %>% dplyr::pull(mzValue)))
      
      # Calculate average mass accuracy for each target m/z
      if (length(targetMZ_filtered) > 0) {
        plotData <- massAccuracyData %>%
          dplyr::filter(.data[[msLevel]] == uniqueMsLevel[i]) %>%
          dplyr::select(all_of(commonColumn), all_of(as.character(targetMZ_filtered))) %>%
          calculateAverageMassAccuracy(
            data = .,
            commonColumn = commonColumn,
            spectrumCount = spectrumCount,
            firstColumnIndex = which(colnames(.) == targetMZ_filtered[1]),
            roundDecimalPlace = roundDecimalPlace
          ) %>%
          dplyr::select(-spectrumCount) %>%
          dplyr::left_join(plotData, ., by = commonColumn[commonColumn != spectrumCount])
      }
      
      # Clean environment
      rm(targetMZ_filtered)
    }
    
    plotData <- plotData %>%
      dplyr::select(all_of(commonColumn), all_of(as.character(targetMZ)))
    
    # Clean environment
    rm(massAccuracyData, uniqueMsLevel, i)
    invisible(gc())
    
  # Plot variables and labels
  x <- timestamp
  firstColumnIndex <- which(colnames(plotData) == as.character(targetMZ[1]))
  title <- "Mass Accuracy Analysis"
  subtitle <- paste(length(targetMZ), "Extracted Ions")
  caption <- "m/z"
  xLabel <- "Timestamp"
  yLabel <- "ppm"
  boundary <- "value"
  boundaryValue <- 5
  trendlineToggle <- FALSE
  xTickToggle <- FALSE
  facetWrapBy <- instrument
  plotColumn <- 2
  plotRow <- 2
  colour <- if (length(unique(plotData[[projectCohort]])) > 1) projectCohort else plate
  colourLabel <- if (length(unique(plotData[[projectCohort]])) > 1) "Project" else "Plate"
  
  # Perform mass accuracy analysis
  analysisResult_MA <- displayMultipleTimeSeries(
    data = plotData,
    commonColumn = commonColumn,
    x = x,
    firstColumnIndex = firstColumnIndex,
    colour = colour,
    title = title,
    subtitle = subtitle,
    caption = caption,
    xLabel = xLabel,
    yLabel = yLabel,
    colourLabel = colourLabel,
    boundary = boundary,
    boundaryValue = boundaryValue,
    trendlineToggle = trendlineToggle,
    xTickToggle = xTickToggle,
    facetWrapBy = facetWrapBy,
    plotColumn = plotColumn,
    plotRow = plotRow
  )
  
  # Clean environment
  rm(commonColumn, targetMZ, plotData, x, firstColumnIndex, title, subtitle, caption, xLabel, yLabel, boundary, boundaryValue, trendlineToggle,
     xTickToggle, facetWrapBy, plotColumn, plotRow, colour, colourLabel)
  invisible(gc())
} else if (!newSampleStatus) {
  message("Unable to perform Mass Accuracy Analysis: No available sample data")
} else if (!targetFileStatus) {
  message("Unable to perform Mass Accuracy Analysis: No available target file data")
} else if (!extractedIonStatus) {
  message("Unable to perform Mass Accuracy Analysis: Inconsistencies between spectra and target m/z data")
}
```

# Report {.tabset}
## Time Series Analysis {.tabset}
The report highlights the deviation significance of mass calibration references, internal standards, endogenous analytes, and products present
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (!newSampleStatus) {
  message("Unable to report Time Series Analysis: No available sample data")
} else if (!targetFileStatus) {
  message("Unable to report Time Series Analysis: No available target file data")
} else if (!extractedIonStatus) {
  message("Unable to report Time Series Analysis: Inconsistencies between spectra and target m/z data")
} else if (!chromatogramRegionStatus) {
  message("Unable to report Time Series Analysis: No available chromatogram region data")
}
```

```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Check and update spectral data 
  spectralDataStatus <- any(passedData[[msLevel]] == 1)
}
```

### Mass Calibration References
The report highlights the deviation significance of m/z values associated with mass calibration references present within the samples.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal  
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check target m/z status
  targetMZ <- as.character(
    sort(unique(targetFile %>% dplyr::filter(compoundType == "Mass Calibration Reference" & msLevel == 1) %>% dplyr::pull(mzValue)))
  )
  
  if (length(targetMZ) > 0) {
    # Display analysis result
    if (ncol(analysisResult_TS_massCalibrationReference) != 0) {
      print(
        DT::datatable(
          data = analysisResult_TS_massCalibrationReference %>%
            dplyr::filter(.data[[projectCohort]] != "Historical"),
          filter = "top", options = list(scrollX = TRUE)
        ) %>%
          DT::formatStyle(
            columns = targetMZ, target = "cell",
            backgroundColor = styleEqual(
              c("Very Low", "Low", "Normal", "High", "Very High"),
              c("pink", "lightyellow", "lightgreen", "lightyellow", "pink")
            )
          )
      )
    } else {
      print("No available data")
    }
    
    # Clean environment
    rm(analysisResult_TS_massCalibrationReference)
    invisible(gc())
  } else {
    message("Unable to report Time Series Analysis: No available target m/z data")
  }
} else if (!spectralDataStatus) {
  message("Unable to report Time Series Analysis: No available MS level 1 spectral data")
}
```

### Internal Standards
The report highlights the deviation significance of m/z values associated with internal standards present within the samples.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal  
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check target m/z status
  targetMZ <- as.character(
    sort(unique(targetFile %>% dplyr::filter(compoundType == "Internal Standard" & msLevel == 1) %>% dplyr::pull(mzValue)))
  )
  
  if (length(targetMZ) > 0) {
    # Display analysis result
    if (ncol(analysisResult_TS_internalStandard) != 0) {
      print(
        DT::datatable(
          data = analysisResult_TS_internalStandard %>%
            dplyr::filter(.data[[projectCohort]] != "Historical"),
          filter = "top", options = list(scrollX = TRUE)
        ) %>%
          DT::formatStyle(
            columns = targetMZ, target = "cell",
            backgroundColor = styleEqual(
              c("Very Low", "Low", "Normal", "High", "Very High"),
              c("pink", "lightyellow", "lightgreen", "lightyellow", "pink")
            )
          )
      )
    } else {
      print("No available data")
    }
    
    # Clean environment
    rm(analysisResult_TS_internalStandard)
    invisible(gc())
  } else {
    message("Unable to report Time Series Analysis: No available target m/z data")
  }
} else if (!spectralDataStatus) {
  message("Unable to report Time Series Analysis: No available MS level 1 spectral data")
}
```

### Endogenous Analytes
The report highlights the deviation significance of m/z values associated with endogenous analytes present within the samples.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal  
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check target m/z status
  targetMZ <- as.character(
    sort(unique(targetFile %>% dplyr::filter(compoundType == "Endogenous Analyte" & msLevel == 1) %>% dplyr::pull(mzValue)))
  )
  
  if (length(targetMZ) > 0) {
    # Display analysis result
    if (ncol(analysisResult_TS_endogenousAnalyte) != 0) {
      print(
        DT::datatable(
          data = analysisResult_TS_endogenousAnalyte %>%
            dplyr::filter(.data[[projectCohort]] != "Historical"),
          filter = "top", options = list(scrollX = TRUE)
        ) %>%
          DT::formatStyle(
            columns = targetMZ, target = "cell",
            backgroundColor = styleEqual(
              c("Very Low", "Low", "Normal", "High", "Very High"),
              c("pink", "lightyellow", "lightgreen", "lightyellow", "pink")
            )
          )
      )
    } else {
      print("No available data")
    }
    
    # Clean environment
    rm(analysisResult_TS_endogenousAnalyte)
    invisible(gc())
  } else {
    message("Unable to report Time Series Analysis: No available target m/z data")
  }
} else if (!spectralDataStatus) {
  message("Unable to report Time Series Analysis: No available MS level 1 spectral data")
}

# Check new sample, target file, extracted ion, chromatogram region, spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Clean environment
  rm(targetMZ)
}
```

```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Check and update spectral data status
  spectralDataStatus <- any(passedData[[msLevel]] == 2)
}
```

### Products
The report highlights the deviation significance of m/z values associated with products present within the samples.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal  
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check target m/z status
  targetMZ <- as.character(
    sort(unique(targetFile %>% dplyr::filter(compoundType == "Product" & msLevel == 2) %>% dplyr::pull(mzValue)))
  )
  
  if (length(targetMZ) > 0) {
    # Display analysis result
    if (ncol(analysisResult_TS_product) != 0) {
      print(
        DT::datatable(
          data = analysisResult_TS_product %>%
            dplyr::filter(.data[[projectCohort]] != "Historical"),
          filter = "top", options = list(scrollX = TRUE)
        ) %>%
          DT::formatStyle(
            columns = targetMZ, target = "cell",
            backgroundColor = styleEqual(
              c("Very Low", "Low", "Normal", "High", "Very High"),
              c("pink", "lightyellow", "lightgreen", "lightyellow", "pink")
            )
          )
      )
    } else {
      print("No available data")
    }
    
    # Clean environment
    rm(analysisResult_TS_product)
    invisible(gc())
  } else {
    message("Unable to report Time Series Analysis: No available target m/z data")
  }
} else if (!spectralDataStatus) {
  message("Unable to report Time Series Analysis: No available MS level 2 spectral data")
}

# Check new sample, target file, extracted ion, chromatogram region, spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Clean environment
  rm(targetMZ)
}

# Check new sample, target file, extracted ion, and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Clean environment
  rm(spectralDataStatus)
}
```

## Mass Accuracy Analysis
The report highlights m/z values within the spectra that falls outside the accepted mass accuracy (in ppm) threshold.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file and extracted ion status
if (newSampleStatus && targetFileStatus && extractedIonStatus) {
  # Display analysis result
  if (!is.null(analysisResult_MA) && ncol(analysisResult_MA) != 0) {
    print(
      DT::datatable(
        data = analysisResult_MA %>%
          dplyr::filter(.data[[projectCohort]] != "Historical"),
        filter = "top", options = list(scrollX = TRUE)
      ) %>%
        DT::formatStyle(
          columns = as.character(sort(unique(targetFile$mzValue))), target = "cell",
          backgroundColor = styleEqual(
            c("Low", "Normal", "High"),
            c("pink", "lightgreen", "pink")
          )
        )
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(analysisResult_MA)
  invisible(gc())
} else if (!newSampleStatus) {
  message("Unable to report Mass Accuracy Analysis: No available sample data")
} else if (!targetFileStatus) {
  message("Unable to report Mass Accuracy Analysis: No available target file data")
} else if (!extractedIonStatus) {
  message("Unable to report Mass Accuracy Analysis: Inconsistencies between spectra and target m/z data")
}

# Check new sample and target file status
if (newSampleStatus && targetFileStatus) {
  # Clean environment
  rm(extractedIonStatus)
}
```

```{r, echo = FALSE, warning = FALSE}
# Clean environment
  # Check new sample status
  if (newSampleStatus) {
    rm(passedData, sampleID, project, cohort, projectCohort, sampleType, method, instrument, plate, timestamp, spectrumCount, arrayLength,
       msLevel, retentionTime, basePeakIntensity, totalIonCurrent, mzArray, intensityArray, sampleTypeList)
    invisible(gc())
  }

  # Check historical data status
  if (historicalDataStatus) {
    rm(historicalDataPath)
  }

  # Check target file status
  if (targetFileStatus) {
    rm(targetFile)
    invisible(gc())
  }

  rm(params, outputDirectoryPath, chromatogramRegion, roundDecimalPlace, newSampleStatus, historicalDataStatus, targetFileStatus,
     chromatogramRegionStatus)

```
