---
title: "TICQ Report: `r params$title`"
subtitle: "Total Ion Current Quality Assessment of Mass Spectrometry Spectral Data"
author: "Vimalnath Nambiar and Shabarinath Nambiar"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: 
  html_notebook:
    toc: true
    toc_float: true
    toc_depth: 6
    theme: paper
  html_document:
    toc: true
    toc_float: true
    toc_depth: 6
    theme: paper
params:
    title: ""
    inputPath: "/run/media/vimalnathnambiar/WD/data/JSON/test/"
    outputPath: "/home/vimalnathnambiar/git/github/vmalnathnambiar/ticq/output/"
    chromatogramRegion: NULL
    targetFile: NULL
    anpcMethodLibrary: "MS-AA-POS"
    historicalDataPath: NULL
    roundDecimal: 4
    anonymiserStatus: FALSE
---

# Configuration Parameters {.tabset}
Parameters configured for TICQ assessment.
```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Load packages
ticq::loadPackage(packageName = c("DT", "dplyr"))

# Define input path
inputPath <- params$inputPath

# Define output path
outputPath <- params$outputPath

# Define chromatogram regions
# chromatogramRegion <- params$chromatogramRegion
chromatogramRegion <- ticq::configureChromatogramRegion(massCalibrationStart = 0, massCalibrationEnd = 0.3, washStart = 5)

# Define target file / in-house ANPC method library (Either one)
targetFile <- params$targetFile
anpcMethodLibrary <- params$anpcMethodLibrary

# Define historical data path
historicalDataPath <- params$historicalDataPath

# Define number of decimal places for precision value rounding
roundDecimal <- params$roundDecimal

# Define anonymiser status
anonymiserStatus <- params$anonymiserStatus
```

## Input
```{r, echo = FALSE, warning = FALSE}
# Check input path
inputFiles <- ticq::retrieveFileName(inputPath = inputPath, fileExtension = "JSON")

# Update new sample status
newSampleStatus <- length(inputFiles) > 0
if (newSampleStatus) {
  # Display result
  print(paste("Input path:", inputPath))
  print(paste("Available JSON files:", length(inputFiles)))
} else {
  # Clean environment
  rm(inputPath)
}

# Clean environment
rm(inputFiles)
```

## Chromatogram Region
```{r, echo = FALSE, warning = FALSE}
# Check and update chromatogram region status
chromatogramRegionStatus <- !is.null(chromatogramRegion) &&
  all(c("prewash", "massCalibration", "analyte", "wash") %in% names(chromatogramRegion))

if (chromatogramRegionStatus) {
  # Display chromatogram region data
  print(chromatogramRegion)
} else {
  # Reset
  chromatogramRegion <- NULL
  print("No available chromatogram region data")
}
```

## Target File
```{r, echo = FALSE, warning = FALSE}
# Check target file
targetFile <- ticq::extractTargetFile(targetFile = targetFile, anpcMethodLibrary = anpcMethodLibrary, roundDecimal = roundDecimal)

# Update target file status
targetFileStatus <- !is.null(targetFile)
if (targetFileStatus) {
  DT::datatable(data = targetFile, filter = "top", options = list(scrollX = TRUE))
} else {
  # Clean environment
  rm(targetFile)
}

# Clean environment
rm(anpcMethodLibrary)
```

# Spectral Data Extraction
Spectral data is extracted from JSON file(s) retrieved from input.
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newSampleStatus) {
  # Extract spectral data and sample metadata from ExfilMS generated JSON files
  result <- ticq::extractExfilMS(inputPath = inputPath)
  
  # Update new sample status
  newSampleStatus <- nrow(result$passedData) > 0
  if (newSampleStatus) {
    passedData <- result$passedData
    saveRDS(passedData, file = paste0(outputPath, gsub("\\.json$", "", basename(inputPath), ignore.case = TRUE), ".rds"))
  }
  
  # Display result
  print(paste("Number of files that failed spectral data extraction:", nrow(result$failedData)))
  if (nrow(result$failedData) != 0) {
    print(DT::datatable(data = result$failedData, filter = "top", options = list(scrollX = TRUE)) %>%
            DT::formatStyle("fileName", target = "row", backgroundColor = "pink"))
  }
  
  # Clean environment
  rm(inputPath, result)
  invisible(gc())
} else {
  print("Unable to perform Spectral Data Extraction: No available input files")
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample status
if (newSampleStatus) {
  # Column names of extracted spectral data used by TICQ
  sampleID <- "sampleID"
  project <- "project"
  cohort <- "cohort"
  projectCohort <- "projectCohort"
  sampleType <- "sampleType"
  method <- "method"
  instrument <- "instrument"
  plate <- "plate"
  timestamp <- "timestamp"
  spectrumCount <- "spectrumCount"
  arrayLength <- "spectrum.arrayLength"
  msLevel <- "spectrum.msLevel"
  retentionTime <- "spectrum.retentionTime"
  basePeakIntensity <- "spectrum.basePeakIntensity"
  totalIonCurrent <- "spectrum.totalIonCurrent"
  mzArray <- "spectrum.mzArray"
  intensityArray <- "spectrum.intensityArray"
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample and anonymiser status
if (newSampleStatus && anonymiserStatus) {
  # Anonymise metadata
  passedData <- ticq::anonymiseMetadata(
    data = passedData,
    sampleID = sampleID,
    project = project,
    cohort = cohort,
    projectCohort = projectCohort,
    method = method,
    instrument = instrument,
    plate = plate
  )
}

# Clean environment
rm(anonymiserStatus)
```

# Preliminary Data Check {.tabset}
## Undefined Sample Type Check
Extracted samples are checked for the presence of undefined sample type (based on metadata).
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newSampleStatus) {
  # Check undefined sample types
  result <- ticq::checkUndefinedSampleType(
    data = passedData,
    commonColumn = colnames(passedData)[which(colnames(passedData) == sampleID):which(colnames(passedData) == spectrumCount)],
    sampleType = sampleType,
    spectrumCount = spectrumCount
  )
  
  # Update new sample status
  newSampleStatus <- nrow(result$passedData) > 0
  if (newSampleStatus) {
    passedData <- result$passedData
  } else {
    # Clean environment
    rm(passedData, sampleID, project, cohort, projectCohort, sampleType, method, instrument, plate, timestamp, spectrumCount, arrayLength,
       msLevel, retentionTime, basePeakIntensity, totalIonCurrent, mzArray, intensityArray)
    invisible(gc())
  }
  
  # Display result
  print(paste("Number of samples with undefined sample type:", nrow(result$failedData)))
  if (nrow(result$failedData) != 0) {
    print(DT::datatable(data = result$failedData, filter = "top", options = list(scrollX = TRUE)) %>%
            DT::formatStyle("sampleType", target = "row", backgroundColor = "pink"))
  }
  
  # Clean environment
  rm(result)
  invisible(gc())
} else {
  print("Unable to perform Undefined Sample Type Check: No available sample data")
}
```

## Spectrum Count Check
Spectrum count of samples are checked against a threshold limit below the average spectrum count of all samples (mean).
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newSampleStatus) {
  # Check historical data path
  if (!is.null(historicalDataPath) && file.exists(historicalDataPath)) {
    # Check historical data
    historicalData <- readRDS(historicalDataPath)
    
    if (ncol(historicalData) == ncol(passedData) && all(colnames(historicalData) == colnames(passedData))) {
      # Append historical data
      passedData <- rbind(historicalData, passedData)
    }
    
    # Clean environment
    rm(historicalData)
    invisible(gc())
  }
  
  # Check spectrum count
  if (length(unique(passedData[[sampleID]])) > 1) {
    result <- ticq::checkSpectrumCount(
      data = passedData,
      commonColumn = colnames(passedData)[which(colnames(passedData) == sampleID):which(colnames(passedData) == spectrumCount)],
      sampleID = sampleID,
      spectrumCount = spectrumCount
    )
  } else {
    print("Unable to perform Spectrum Count Check: Only one sample data available")
    result <- NULL
  }
  
  # Check result
  if (!is.null(result)) {
    # Remove historical data from passed and failed results
    result$passedData <- result$passedData %>%
      dplyr::filter(.data[[projectCohort]] != "Historical")
    
    result$failedData <- result$failedData %>%
      dplyr::filter(.data[[projectCohort]] != "Historical")
    
    # Update new sample status
    newSampleStatus <- nrow(result$passedData) > 0
    if (newSampleStatus) {
      passedData <- result$passedData
    } else {
      # Clean environment
      rm(passedData, sampleID, project, cohort, projectCohort, sampleType, method, instrument, plate, timestamp, spectrumCount, arrayLength,
         msLevel, retentionTime, basePeakIntensity, totalIonCurrent, mzArray, intensityArray)
      invisible(gc())
    }
    
    # Display result
    print(paste("Sample size:", result$sampleSize))
    print(paste("Spectrum count (TOTAL):", result$total))
    print(paste("Spectrum count (MEAN):", result$mean))
    print(paste("Accepted threshold limit (%):", result$threshold))
    print(paste("Number of samples with a spectrum count outside the accepted threshold limit:", nrow(result$failedData)))
    if (nrow(result$failedData) != 0) {
      print(DT::datatable(data = result$failedData, filter = "top", options = list(scrollX = TRUE)) %>%
              DT::formatStyle("spectrumCount", target = "row", backgroundColor = "pink"))
    }
  }
  
  # Clean environment
  rm(result)
  invisible(gc())
} else {
  print("Unable to perform Spectrum Count Check: No available sample data")
}
```

# Available Sample Types to Assess
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newSampleStatus) {
  # Display sample types to assess
  sampleTypeList <- unique(passedData[[sampleType]])
  print(sampleTypeList)
} else {
  print("No available sample data")
}
```

# Total Ion Chromatogram {.tabset}
Chromatogram overview (Total ion current, TIC vs Retention Time, RT) of each sample type along with 3 chromatographic regions of interest (mass calibration, analyte, and wash regions) are plotted using full scan MS level 1 spectral data.
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newSampleStatus) {
  # Check and update spectral data status
  spectralDataStatus <- any(passedData[[msLevel]] == 1)
  if (spectralDataStatus) {
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 1) %>%
      dplyr::select(
        all_of(colnames(passedData)[which(colnames(passedData) == sampleID):which(colnames(passedData) == spectrumCount)]),
        retentionTime, totalIonCurrent
      )
    
    # Check historical data path
    if (!is.null(historicalDataPath) && file.exists(historicalDataPath)) {
      # Check historical data
      historicalData <- readRDS(historicalDataPath)
      
      if (ncol(historicalData) == ncol(passedData) && all(colnames(historicalData) == colnames(passedData))) {
        # Append historical data
        historicalData <- historicalData %>%
          dplyr::filter(.data[[msLevel]] == 1) %>%
          dplyr::select(
            all_of(colnames(historicalData)[which(colnames(historicalData) == sampleID):which(colnames(historicalData) == spectrumCount)]),
            retentionTime, totalIonCurrent
          )
        
        plotData <- rbind(historicalData, plotData)
      }
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
    x <- retentionTime
    y <- totalIonCurrent
    title <- "Total Ion Chromatogram"
    xLabel <- "RT"
    yLabel <- "TIC"
    
    if (length(unique(plotData[[projectCohort]])) > 1) {
      colour <- projectCohort
      colourLabel <- "Project"
    } else {
      colour <- plate
      colourLabel <- "Plate"
    }
  } else {
    print("Unable to display Total Ion Chromatogram: No available MS level 1 spectral data")
  }
} else {
  print("Unable to display Total Ion Chromatogram: No available sample data")
}
```

## LTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma", "sLTR Serum", "LTR Serum", "sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in unique(sub("sLTR |LTR ", "", pattern))) {
      # Check pattern
      tmpPattern <- c(paste("sLTR", i), paste("LTR", i))
      if (any(tmpPattern %in% sampleTypeList)) {
        # Display total ion chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = paste("LTR", i),
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
      
      # Clean environment
      rm(tmpPattern)
    }
  } else {
    print("No available data")
  }
}
```

## dLTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma", "dLTR Serum", "dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display total ion chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## PQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma", "PQC Serum", "PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display total ion chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## dPQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma", "dPQC Serum", "dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display total ion chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## QC
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("QC01", "QC02", "QC03", "QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display total ion chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## CAL
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("CAL01", "CAL02", "CAL03", "CAL04", "CAL05", "CAL06", "CAL07", "CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display total ion chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank", "Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display total ion chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## Sample
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma", "Sample Serum", "Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display total ion chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## dSample
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma", "dSample Serum", "dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display total ion chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(x, y, title, xLabel, yLabel, colour, colourLabel, pattern, i)
}
```

# Statistical Analysis {.tabset}
The chromatogram regions of interest (mass calibration, analyte, and wash regions) of the samples are assessed by their corresponding sample type using statistical methodologies such as principal component, time series, and violin plot analyses.
```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Splice chromatogram regions
  plotData <- ticq::spliceChromatogramRegion(
    data = plotData,
    commonColumn = colnames(plotData)[which(colnames(plotData) == sampleID):which(colnames(plotData) == spectrumCount)],
    spectrumCount = spectrumCount,
    chromatogramRegion = chromatogramRegion,
    retentionTime = retentionTime,
    sumColumn = totalIonCurrent
  )

  # Column names of spliced chromatogram regions used for statistical analysis
  prewashRegion <- "prewashRegion"
  massCalibrationRegion <- "massCalibrationRegion"
  analyteRegion <- "analyteRegion"

  shape <- sampleType
  shapeLabel <-  "Sample Type"

  # Plot variables and labels
  if (length(unique(plotData[[projectCohort]])) > 1) {
    colour <- projectCohort
    colourLabel <- "Project"
  } else {
    colour <- plate
    colourLabel <- "Plate"
  }
} else if (!chromatogramRegionStatus) {
  # Clean environment
  rm(plotData)
  invisible(gc())
}
```

## Principal Component Analysis (PCA) {.tabset}
PCA provides an overview of the overall sample variance influenced by the 3 chromatogram regions of interest: mass calibration, analyte, and wash regions.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Plot variables and labels
  firstColumnIndex <- which(colnames(plotData) == massCalibrationRegion)
  scoresPlotToggle <- FALSE
  loadingsPlotToggle <- FALSE
} else if (!newSampleStatus) {
  print("Unable to perform Principal Component Analysis: No available sample data")
} else if (!spectralDataStatus) {
  print("Unable to perform Principal Component Analysis: No available MS level 1 spectral data")
} else if (!chromatogramRegionStatus) {
  print("Unable to perform Principal Component Analysis: No available chromatogram region data")
}
```

### LTR {.tabset}
#### LTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = "LTR Plasma",
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = "LTR Serum",
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = "LTR Urine",
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

### dLTR {.tabset}
#### dLTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

### PQC {.tabset}
#### PQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

### dPQC {.tabset}
#### dPQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

### QC {.tabset}
#### QC01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### QC02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### QC03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### QC04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

### CAL {.tabset}
#### CAL01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### CAL02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### CAL03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### CAL04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### CAL05
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### CAL06
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### CAL07
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### CAL08
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

### Blank {.tabset}
#### Single Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

#### Double Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
  } else {
    print("No available data")
  }
}
```

### Sample {.tabset}
#### Sample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Plasma", "LTR Plasma")
    
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
    
    # Clean environment
    rm(tmpPattern)
  } else {
    print("No available data")
  }
}
```

#### Sample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Serum", "LTR Serum")
    
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
    
    # Clean environment
    rm(tmpPattern)
  } else {
    print("No available data")
  }
}
```

#### Sample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Urine", "LTR Urine")
    
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
    
    # Clean environment
    rm(tmpPattern)
  } else {
    print("No available data")
  }
}
```

### dSample {.tabset}
#### dSample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Plasma")
    
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
    
    # Clean environment
    rm(tmpPattern)
  } else {
    print("No available data")
  }
}
```

#### dSample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Serum")
    
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
    
    # Clean environment
    rm(tmpPattern)
  } else {
    print("No available data")
  }
}
```

#### dSample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Urine")
    
    # Display PCA outcomes
    ticq::displayPCA(
      data = plotData %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      subtitle = pattern,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      scoresPlotToggle = scoresPlotToggle,
      loadingsPlotToggle = loadingsPlotToggle
    )
    
    # Clean environment
    rm(tmpPattern)
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(firstColumnIndex, scoresPlotToggle, loadingsPlotToggle, pattern)
}
```

## Time Series Analysis {.tabset}
Time series analysis focuses on the prewash region (combined mass calibration and analyte regions). This analysis provides a temporal trendline and assesses the combined performance of mass calibration references, internal standards and endogenous analytes present within the samples in the region. A report is generated highlighting the samples that have a significant 1st and 2nd standard deviation from the average mean performance of the region.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Plot variables and labels
  x <- timestamp
  y <- prewashRegion
  title <- "Time Series Analysis"
  xLabel <- "Timestamp"
  yLabel <- "Prewash Region (TIC)"
  boundary <- "sd"
  xTickToggle <- TRUE
  
  # Data frame to store analysis result
  analysisResult_TS <- data.frame()
} else if (!newSampleStatus) {
  print("Unable to perform Time Series Analysis: No available sample data")
} else if (!spectralDataStatus) {
  print("Unable to perform Time Series Analysis: No available MS level 1 spectral data")
} else if (!chromatogramRegionStatus) {
  print("Unable to perform Time Series Analysis: No available chromatogram region data")
}
```

### LTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma", "sLTR Serum", "LTR Serum", "sLTR Urine", "LTR Urine")

  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in unique(sub("sLTR |LTR ", "", pattern))) {
      # Check pattern
      tmpPattern <- c(paste("sLTR", i), paste("LTR", i))
      if (any(tmpPattern %in% sampleTypeList)) {
        # Display time series analysis
        result <- ticq::displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = paste("LTR", i),
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          xTickToggle = xTickToggle
        )

        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
      }

      # Clean environment
      rm(tmpPattern)
    }
  } else {
    print("No available data")
  }
}
```

### dLTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma", "dLTR Serum", "dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display time series analysis
        result <- ticq::displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          xTickToggle = xTickToggle
        )
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

### PQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma", "PQC Serum", "PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display time series analysis
        result <- ticq::displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          xTickToggle = xTickToggle
        )
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

### dPQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma", "dPQC Serum", "dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display time series analysis
        result <- ticq::displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          xTickToggle = xTickToggle
        )
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

### QC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("QC01", "QC02", "QC03", "QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display time series analysis
        result <- ticq::displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          xTickToggle = xTickToggle
        )
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

### CAL
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("CAL01", "CAL02", "CAL03", "CAL04", "CAL05", "CAL06", "CAL07", "CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display time series analysis
        result <- ticq::displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          xTickToggle = xTickToggle
        )
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

### Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank", "Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display time series analysis
        result <- ticq::displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          xTickToggle = xTickToggle
        )
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

### Sample
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma", "Sample Serum", "Sample Urine")

  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Compare against long term references
        tmpPattern <- sub("Sample ", "", i)
        tmpPattern <- c(paste("sLTR", tmpPattern), paste("LTR", tmpPattern))
        referenceData <- plotData %>%
          dplyr::filter(.data[[sampleType]] %in% tmpPattern)
                
        # Display time series analysis
        result <- ticq::displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          referenceData = referenceData,
          xTickToggle = xTickToggle
        ) %>%
          dplyr::filter(.data[[sampleType]] %in% i)
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
        
        # Clean environment
        rm(tmpPattern, referenceData)
        invisible(gc())
      }
    }
  } else {
    print("No available data")
  }
}
```

### dSample
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma", "dSample Serum", "dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Compare against long term references
        tmpPattern <- sub("dSample ", "", i)
        tmpPattern <- c(paste("dLTR", tmpPattern))
        referenceData <- plotData %>%
          dplyr::filter(.data[[sampleType]] %in% tmpPattern)
                
        # Display time series analysis
        result <- ticq::displayTimeSeries(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          referenceData = referenceData,
          xTickToggle = xTickToggle
        ) %>%
          dplyr::filter(.data[[sampleType]] %in% i)
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
        
        # Clean environment
        rm(tmpPattern, referenceData)
        invisible(gc())
      }
    }
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(x, y, title, xLabel, yLabel, boundary, xTickToggle, pattern, i, result)
  invisible(gc())
}
```

## Violin Plot Analysis {.tabset}
Violin plot analysis focuses on the two distinct chromatogram regions that made up the prewash region previously assessed - mass calibration and analyte region. Two reports are generated highlighting the samples that have a significant 1st and 2nd standard deviation from the average mean of the overall data distribution in the two regions, respectively.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Plot variables and labels
  x <- instrument
  title <- "Violin Plot Analysis"
  xLabel <- "Instrument"
  boundary <- "sd"
  boxWidth <- 0.05
} else if (!newSampleStatus) {
  print("Unable to perform Violin Plot Analysis: No available sample data")
} else if (!spectralDataStatus) {
  print("Unable to perform Violin Plot Analysis: No available MS level 1 spectral data")
} else if (!chromatogramRegionStatus) {
  print("Unable to perform Violin Plot Analysis: No available chromatogram region data")
}
```

### Mass Calibration Region {.tabset}
Violin plot analysis of the mass calibration region assesses the performance of the mass calibration references present within the samples.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Plot variables and labels
  y <- massCalibrationRegion
  yLabel <- "Mass Calibration Region (TIC)"
  
  # Data frame to store analysis result
  analysisResult_VP_massCalibrationRegion <- data.frame()
}
```

#### LTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma", "sLTR Serum", "LTR Serum", "sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in unique(sub("sLTR |LTR ", "", pattern))) {
      # Check pattern
      tmpPattern <- c(paste("sLTR", i), paste("LTR", i))
      if (any(tmpPattern %in% sampleTypeList)) {
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = paste("LTR", i),
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        )
        
        # Append analysis result
        analysisResult_VP_massCalibrationRegion <- rbind(analysisResult_VP_massCalibrationRegion, result)
      }
      
      # Clean environment
      rm(tmpPattern)
    }
  } else {
    print("No available data")
  }
}
```

#### dLTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma", "dLTR Serum", "dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        )

        # Append analysis result
        analysisResult_VP_massCalibrationRegion <- rbind(analysisResult_VP_massCalibrationRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### PQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma", "PQC Serum", "PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        )

        # Append analysis result
        analysisResult_VP_massCalibrationRegion <- rbind(analysisResult_VP_massCalibrationRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### dPQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma", "dPQC Serum", "dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        )

        # Append analysis result
        analysisResult_VP_massCalibrationRegion <- rbind(analysisResult_VP_massCalibrationRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### QC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("QC01", "QC02", "QC03", "QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        )

        # Append analysis result
        analysisResult_VP_massCalibrationRegion <- rbind(analysisResult_VP_massCalibrationRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### CAL
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("CAL01", "CAL02", "CAL03", "CAL04", "CAL05", "CAL06", "CAL07", "CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        )

        # Append analysis result
        analysisResult_VP_massCalibrationRegion <- rbind(analysisResult_VP_massCalibrationRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank", "Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        )

        # Append analysis result
        analysisResult_VP_massCalibrationRegion <- rbind(analysisResult_VP_massCalibrationRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### Sample
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma", "Sample Serum", "Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Compare against long term references
        tmpPattern <- sub("Sample ", "", i)
        tmpPattern <- c(paste("sLTR", tmpPattern), paste("LTR", tmpPattern))
        referenceData <- plotData %>%
          dplyr::filter(.data[[sampleType]] %in% tmpPattern)
        
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          referenceData = referenceData,
          boxWidth = boxWidth
        ) %>%
          dplyr::filter(.data[[sampleType]] %in% i)

        # Append analysis result
        analysisResult_VP_massCalibrationRegion <- rbind(analysisResult_VP_massCalibrationRegion, result)
        
        # Clean environment
        rm(tmpPattern, referenceData)
        invisible(gc())
      }
    }
  } else {
    print("No available data")
  }
}
```

#### dSample
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma", "dSample Serum", "dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Compare against long term references
        tmpPattern <- sub("dSample ", "", i)
        tmpPattern <- c(paste("dLTR", tmpPattern))
        referenceData <- plotData %>%
          dplyr::filter(.data[[sampleType]] %in% tmpPattern)
        
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          referenceData = referenceData,
          boxWidth = boxWidth
        ) %>%
          dplyr::filter(.data[[sampleType]] %in% i)

        # Append analysis result
        analysisResult_VP_massCalibrationRegion <- rbind(analysisResult_VP_massCalibrationRegion, result)
        
        # Clean environment
        rm(tmpPattern, referenceData)
        invisible(gc())
      }
    }
  } else {
    print("No available data")
  }
}
```

### Analyte Region {.tabset}
Violin plot analysis of the analyte region assesses the combined performance of the internal standards and endogenous analytes present within the samples.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Plot variables and labels
  y <- analyteRegion
  yLabel <- "Analyte Region (TIC)"
  
  # Data frame to store analysis result
  analysisResult_VP_analyteRegion <- data.frame()
}
```

#### LTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma", "sLTR Serum", "LTR Serum", "sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in unique(sub("sLTR |LTR ", "", pattern))) {
      # Check pattern
      tmpPattern <- c(paste("sLTR", i), paste("LTR", i))
      if (any(tmpPattern %in% sampleTypeList)) {
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = paste("LTR", i),
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        )

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
      }
      
      # Clean environment
      rm(tmpPattern)
    }
  } else {
    print("No available data")
  }
}
```

#### dLTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma", "dLTR Serum", "dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        )

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### PQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma", "PQC Serum", "PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        )

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### dPQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma", "dPQC Serum", "dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        )

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### QC
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("QC01", "QC02", "QC03", "QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        )

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### CAL
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("CAL01", "CAL02", "CAL03", "CAL04", "CAL05", "CAL06", "CAL07", "CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        )

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank", "Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          boxWidth = boxWidth
        )

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### Sample
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma", "Sample Serum", "Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Compare against long term references
        tmpPattern <- sub("Sample ", "", i)
        tmpPattern <- c(paste("sLTR", tmpPattern), paste("LTR", tmpPattern))
        referenceData <- plotData %>%
          dplyr::filter(.data[[sampleType]] %in% tmpPattern)
        
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          referenceData = referenceData,
          boxWidth = boxWidth
        ) %>%
          dplyr::filter(.data[[sampleType]] %in% i)

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
        
        # Clean environment
        rm(tmpPattern, referenceData)
        invisible(gc())
      }
    }
  } else {
    print("No available data")
  }
}
```

#### dSample
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma", "dSample Serum", "dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Compare against long term references
        tmpPattern <- sub("dSample ", "", i)
        tmpPattern <- c(paste("dLTR", tmpPattern))
        referenceData <- plotData %>%
          dplyr::filter(.data[[sampleType]] %in% tmpPattern)
        
        # Display violin plot analysis
        result <- ticq::displayViolinBox(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
          x = x,
          y = y,
          colour = colour,
          shape = shape,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          shapeLabel = shapeLabel,
          boundary = boundary,
          referenceData = referenceData,
          boxWidth = boxWidth
        ) %>%
          dplyr::filter(.data[[sampleType]] %in% i)

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
        
        # Clean environment
        rm(tmpPattern, referenceData)
        invisible(gc())
      }
    }
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData, prewashRegion, massCalibrationRegion, analyteRegion, shape, shapeLabel, colour, colourLabel, x, title, xLabel, boundary,
     boxWidth, y, yLabel, pattern, i, result)
  invisible(gc())
}
```

# Report {.tabset}
## Time Series Analysis
The report highlights the deviation significance of the samples from the average mean performance of the prewash region.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal  
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display analysis result
  if (ncol(analysisResult_TS) != 0) {
    print(
      DT::datatable(
        data = analysisResult_TS %>%
          dplyr::select(
            all_of(
              colnames(analysisResult_TS)[which(colnames(analysisResult_TS) == sampleID):which(colnames(analysisResult_TS) == spectrumCount)]
            ),
            prewashRegion, sampleRange
          ) %>%
          dplyr::filter(.data[[projectCohort]] != "Historical"),
        filter = "top", options = list(scrollX = TRUE)
      ) %>%
        DT::formatStyle(
          "sampleRange", target = "row",
          backgroundColor = styleEqual(
            c("Very Low", "Low", "Normal", "High", "Very High"),
            c("pink", "lightyellow", "lightgreen", "lightyellow", "pink")
          )
        )
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(analysisResult_TS)
  invisible(gc())
} else if (!newSampleStatus) {
  print("Unable to report Time Series Analysis: No available sample data")
} else if (!spectralDataStatus) {
  print("Unable to report Time Series Analysis: No available MS level 1 spectral data")
} else if (!chromatogramRegionStatus) {
  print("Unable to report Time Series Analysis: No available chromatogram region data")
}
```

## Violin Plot Analysis {.tabset}
The reports below highlights the deviation significance of the samples from the average mean of the overall data distribution in the mass calibration and analyte regions, respectively.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (!newSampleStatus) {
  print("Unable to report Violin Plot Analysis: No available sample data")
} else if (!spectralDataStatus) {
  print("Unable to report Violin Plot Analysis: No available MS level 1 spectral data")
} else if (!chromatogramRegionStatus) {
  print("Unable to report Violin Plot Analysis: No available chromatogram region data")
}
```

### Mass Calibration Region
The report highlights the deviation significance of the performance of the mass calibration references present within the samples.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal    
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display result
  if (ncol(analysisResult_VP_massCalibrationRegion) != 0) {
    print(
      DT::datatable(
        data = analysisResult_VP_massCalibrationRegion %>%
          dplyr::select(
            all_of(
              colnames(analysisResult_VP_massCalibrationRegion)[which(colnames(analysisResult_VP_massCalibrationRegion) == sampleID):
                                                                which(colnames(analysisResult_VP_massCalibrationRegion) == spectrumCount)]
            ),
            massCalibrationRegion, sampleRange
          ) %>%
          dplyr::filter(.data[[projectCohort]] != "Historical"),
        filter = "top", options = list(scrollX = TRUE)
      ) %>%
        DT::formatStyle(
          "sampleRange", target = "row", 
          backgroundColor = styleEqual(
            c("Very Low", "Low", "Normal", "High", "Very High"),
            c("pink", "lightyellow", "lightgreen", "lightyellow", "pink")
          )
        )
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(analysisResult_VP_massCalibrationRegion)
  invisible(gc())
}
```

### Analyte Region
The report highlights deviation significance of the combined performance of the internal standards and endogenous analytes present within the samples.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal  
```{r, echo = FALSE, warning = FALSE}
# Check new sample, spectral data and chromatogram region status
if (newSampleStatus && spectralDataStatus && chromatogramRegionStatus) {
  # Display result
  if (ncol(analysisResult_VP_analyteRegion) != 0) {
    print(
      DT::datatable(
        data = analysisResult_VP_analyteRegion %>%
          dplyr::select(
            all_of(
              colnames(analysisResult_VP_analyteRegion)[which(colnames(analysisResult_VP_analyteRegion) == sampleID):
                                                        which(colnames(analysisResult_VP_analyteRegion) == spectrumCount)]
            ),
            analyteRegion, sampleRange
          ) %>%
          dplyr::filter(.data[[projectCohort]] != "Historical"),
        filter = "top", options = list(scrollX = TRUE)
      ) %>%
        DT::formatStyle(
          "sampleRange", target = "row",
          backgroundColor = styleEqual(
            c("Very Low", "Low", "Normal", "High", "Very High"),
            c("pink", "lightyellow", "lightgreen", "lightyellow", "pink")
          )
        )
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(analysisResult_VP_analyteRegion)
  invisible(gc())
}

# Check new sample status
if (newSampleStatus) {
  # Clean environment
  rm(spectralDataStatus)
}
```

# Base Peak Chromatogram {.tabset}
Chromatogram overview (Base Peak Intensity, BPI vs Retention Time, RT) of each sample type along with 3 chromatographic regions of interest (mass calibration, analyte, and wash regions) are plotted using full scan MS level 1 spectral data.
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newSampleStatus) {
  # Check and update spectral data status
  spectralDataStatus <- any(passedData[[msLevel]] == 1)
  if (spectralDataStatus) {
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 1) %>%
      dplyr::select(
        all_of(colnames(passedData)[which(colnames(passedData) == sampleID):which(colnames(passedData) == spectrumCount)]),
        retentionTime, basePeakIntensity
      )
    
    # Check historical data path
    if (!is.null(historicalDataPath) && file.exists(historicalDataPath)) {
      # Check historical data
      historicalData <- readRDS(historicalDataPath)
      
      if (ncol(historicalData) == ncol(passedData) && all(colnames(historicalData) == colnames(passedData))) {
        # Append historical data
        historicalData <- historicalData %>%
          dplyr::filter(.data[[msLevel]] == 1) %>%
          dplyr::select(
            all_of(colnames(historicalData)[which(colnames(historicalData) == sampleID):which(colnames(historicalData) == spectrumCount)]),
            retentionTime, basePeakIntensity
          )
        
        plotData <- rbind(historicalData, plotData)
      }
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
    x <- retentionTime
    y <- basePeakIntensity
    title <- "Base Peak Chromatogram"
    xLabel <- "RT"
    yLabel <- "BPI"
    
    if (length(unique(plotData[[projectCohort]])) > 1) {
      colour <- projectCohort
      colourLabel <- "Project"
    } else {
      colour <- plate
      colourLabel <- "Plate"
    }
  } else {
    print("Unable to display Base Peak Chromatogram: No available MS level 1 spectral data")
  }
} else {
  print("Unable to display Base Peak Chromatogram: No available sample data")
}
```

## LTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma", "sLTR Serum", "LTR Serum", "sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in unique(sub("sLTR |LTR ", "", pattern))) {
      # Check pattern
      tmpPattern <- c(paste("sLTR", i), paste("LTR", i))
      if (any(tmpPattern %in% sampleTypeList)) {
        # Display base peak chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% tmpPattern),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = paste("LTR", i),
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
      
      # Clean environment
      rm(tmpPattern)
    }
  } else {
    print("No available data")
  }
}
```

## dLTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma", "dLTR Serum", "dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## PQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma", "PQC Serum", "PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## dPQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma", "dPQC Serum", "dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## QC
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("QC01", "QC02", "QC03", "QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## CAL
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("CAL01", "CAL02", "CAL03", "CAL04", "CAL05", "CAL06", "CAL07", "CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank", "Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## Sample
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma", "Sample Serum", "Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
}
```

## dSample
```{r, echo = FALSE, warning = FALSE}
# Check new sample and spectral data status
if (newSampleStatus && spectralDataStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma", "dSample Serum", "dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Loop through patterns
    for (i in pattern) {
      # Check pattern
      if (i %in% sampleTypeList) {
        # Display base peak chromatogram
        ticq::displayChromatogram(
          data = plotData %>%
            dplyr::filter(.data[[sampleType]] %in% i),
          x = x,
          y = y,
          colour = colour,
          title = title,
          subtitle = i,
          xLabel = xLabel,
          yLabel = yLabel,
          colourLabel = colourLabel,
          chromatogramRegion = chromatogramRegion
        )
      }
    }
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData, x, y, title, xLabel, yLabel, colour, colourLabel, pattern, i)
  invisible(gc())
}

# Check new sample status
if (newSampleStatus) {
  # Clean environment
  rm(spectralDataStatus)
}
```

# Extracted Ion Chromatogram {.tabset}
Chromatogram overview (Extracted Ion Current, EIC vs Retention Time, RT) of targeted mass calibration references, internal standards, endogenous analytes, and products present within the samples are plotted by their corresponding chromatogram region and sample type. The chromatograms are plotted using MS level 1 spectral data for mass calibration references, internal standards, and endogenous analytes; whereas MS level 2 spectral data is used for products.
```{r, echo = FALSE, warning = FALSE}
# Check new sample and target file status
if (newSampleStatus && targetFileStatus) {
  # Update extracted ion status
  targetFile <- targetFile[targetFile$msLevel %in% unique(passedData[[msLevel]]), ]
  
  extractedIonStatus <- if (length(unique(passedData[[arrayLength]])) != 1 ||
                            nrow(targetFile) == 0 ||
                            length(unique(targetFile$mzValue)) != unique(passedData[[arrayLength]])) FALSE else TRUE
}
```

```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Common data columns
  commonColumn <- colnames(passedData)[which(colnames(passedData) == sampleID):which(colnames(passedData) == spectrumCount)]
  
  # Plot variables and labels
  x <- retentionTime
  title <- "Extracted Ion Chromatogram"
  caption <- "m/z"
  xLabel <- "RT"
  yLabel <- "EIC"
  plotColumn <- 2
  plotRow <- 2
} else if (!newSampleStatus) {
  print("Unable to display Extracted Ion Chromatogram: No available sample data")
} else if (!targetFileStatus) {
  print("Unable to display Extracted Ion Chromatogram: No available target file data")
} else if (!extractedIonStatus) {
  print("Unable to display Extracted Ion Chromatogram: Inconsistencies between spectra and target m/z data")
} else if (!chromatogramRegionStatus) {
  print("Unable to display Extracted Ion Chromatogram: No available chromatogram region data")
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Check and update spectral data status
  spectralDataStatus <- any(passedData[[msLevel]] == 1)
  if (spectralDataStatus) {
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 1)
    
    # Check historical data path
    if (!is.null(historicalDataPath) && file.exists(historicalDataPath)) {
      # Check historical data
      historicalData <- readRDS(historicalDataPath)
      
      if (ncol(historicalData) == ncol(passedData) &&
          all(colnames(historicalData) == colnames(passedData)) &&
          length(unique(historicalData[[arrayLength]])) == 1 &&
          unique(historicalData[[arrayLength]]) == unique(passedData[[arrayLength]])) {
        # Append historical data
        historicalData <- historicalData %>%
          dplyr::filter(.data[[msLevel]] == 1)
        
        plotData <- rbind(historicalData, plotData)
      }
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
    if (length(unique(plotData[[projectCohort]])) > 1) {
      colour <- projectCohort
      colourLabel <- "Project"
    } else {
      colour <- plate
      colourLabel <- "Plate"
    }
    
    # Extract extracted ion current (EIC)
    plotData <- ticq::extractEIC(data = plotData, intensityArray = intensityArray, targetMZ = as.character(sort(unique(targetFile$mzValue))))
  }
}
```

## Mass Calibration References {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- targetFile %>%
    dplyr::filter(compoundType == "Mass Calibration Reference" & msLevel == 1)
  targetMZ <- as.character(sort(unique(targetMZ$mzValue)))
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$massCalibration,
      retentionTime = retentionTime
    )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
  } else {
    print("Unable to display Extracted Ion Chromatogram: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  print("Unable to display Extracted Ion Chromatogram: No available MS level 1 spectral data")
}
```

### LTR {.tabset}
#### LTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dLTR {.tabset}
#### dLTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### PQC {.tabset}
#### PQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dPQC {.tabset}
#### dPQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### QC {.tabset}
#### QC01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### CAL {.tabset}
#### CAL01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL05
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL06
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL07
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL08
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Blank {.tabset}
#### Single Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Double Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Sample {.tabset}
#### Sample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dSample {.tabset}
#### dSample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern)
  invisible(gc())
}
```

## Internal Standards {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- targetFile %>%
    dplyr::filter(compoundType == "Internal Standard" & msLevel == 1)
  targetMZ <- as.character(sort(unique(targetMZ$mzValue)))
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$analyte,
      retentionTime = retentionTime
    )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
  } else {
    print("Unable to display Extracted Ion Chromatogram: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  print("Unable to display Extracted Ion Chromatogram: No available MS level 1 spectral data")
}
```

### LTR {.tabset}
#### LTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dLTR {.tabset}
#### dLTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### PQC {.tabset}
#### PQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dPQC {.tabset}
#### dPQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### QC {.tabset}
#### QC01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### CAL {.tabset}
#### CAL01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL05
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL06
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL07
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL08
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Blank {.tabset}
#### Single Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Double Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Sample {.tabset}
#### Sample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dSample {.tabset}
#### dSample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern)
  invisible(gc())
}
```

## Endogenous Analytes {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- targetFile %>%
    dplyr::filter(compoundType == "Endogenous Analyte" & msLevel == 1)
  targetMZ <- as.character(sort(unique(targetMZ$mzValue)))
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$analyte,
      retentionTime = retentionTime
    )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
  } else {
    print("Unable to display Extracted Ion Chromatogram: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  print("Unable to display Extracted Ion Chromatogram: No available MS level 1 spectral data")
}
```

### LTR {.tabset}
#### LTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dLTR {.tabset}
#### dLTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### PQC {.tabset}
#### PQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dPQC {.tabset}
#### dPQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### QC {.tabset}
#### QC01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### CAL {.tabset}
#### CAL01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL05
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL06
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL07
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL08
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Blank {.tabset}
#### Single Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Double Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Sample {.tabset}
#### Sample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dSample {.tabset}
#### dSample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern)
  invisible(gc())
}

# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Clean environment
  rm(plotData, colour, colourLabel, targetMzStatus)
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Check and update spectral data status
  spectralDataStatus <- any(passedData[[msLevel]] == 2)
  if (spectralDataStatus) {
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 2)
    
    # Check historical data path
    if (!is.null(historicalDataPath) && file.exists(historicalDataPath)) {
      # Check historical data
      historicalData <- readRDS(historicalDataPath)
      
      if (ncol(historicalData) == ncol(passedData) &&
          all(colnames(historicalData) == colnames(passedData)) &&
          length(unique(historicalData[[arrayLength]])) == 1 &&
          unique(historicalData[[arrayLength]]) == unique(passedData[[arrayLength]])) {
        # Append historical data
        historicalData <- historicalData %>%
          dplyr::filter(.data[[msLevel]] == 2)
        
        plotData <- rbind(historicalData, plotData)
      }
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
    if (length(unique(plotData[[projectCohort]])) > 1) {
      colour <- projectCohort
      colourLabel <- "Project"
    } else {
      colour <- plate
      colourLabel <- "Plate"
    }
    
    # Extract extracted ion current (EIC)
    plotData <- ticq::extractEIC(data = plotData, intensityArray = intensityArray, targetMZ = as.character(sort(unique(targetFile$mzValue))))
  }
}
```

## Products {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- targetFile %>%
    dplyr::filter(compoundType == "Product" & msLevel == 2)
  targetMZ <- as.character(sort(unique(targetMZ$mzValue)))
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$analyte,
      retentionTime = retentionTime
    )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
  } else {
    print("Unable to display Extracted Ion Chromatogram: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  print("Unable to display Extracted Ion Chromatogram: No available MS level 2 spectral data")
}
```

### LTR {.tabset}
#### LTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### LTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dLTR {.tabset}
#### dLTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dLTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### PQC {.tabset}
#### PQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### PQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dPQC {.tabset}
#### dPQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dPQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### QC {.tabset}
#### QC01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### QC04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### CAL {.tabset}
#### CAL01
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL02
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL03
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL04
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL05
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL06
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL07
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### CAL08
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Blank {.tabset}
#### Single Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Double Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### Sample {.tabset}
#### Sample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### Sample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

### dSample {.tabset}
#### dSample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
}
```

#### dSample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display extracted ion chromatogram
    ticq::displayMultipleChromatogram(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern)
  invisible(gc())
}

# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Clean environment
  rm(plotData, colour, colourLabel, targetMzStatus)
}

# Check new sample, target file, extracted ion, and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Clean environment
  rm(commonColumn, x, title, caption, xLabel, yLabel, plotColumn, plotRow, spectralDataStatus)
}
```

# Statistical Analysis {.tabset}
The mass calibration references, internal standards, endogenous analytes, and products of interest present within the samples are assessed by their corresponding chromatogram region and sample type using statistical methodologies such as time series analysis.

## Time Series Analysis {.tabset}
Time series analysis provides a temporal trendline and assesses the performance of the mass calibration references, internal standards, endogenous analytes, and products by their corresponding target m/z, chromatogram region, and sample type. A report is generated highlighting the target m/z that have a significant 1st and 2nd standard deviation from the average mean performance.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Common data columns
  commonColumn <- colnames(passedData)[which(colnames(passedData) == sampleID):which(colnames(passedData) == spectrumCount)]
  
  # Plot variables and labels
  x <- timestamp
  title <- "Time Series Analysis"
  caption <- "m/z"
  xLabel <- "Timestamp"
  yLabel <- "EIC"
  shape <- sampleType
  shapeLabel <- "Sample Type"
  boundary <- "sd"
  xTickToggle <- TRUE
  plotColumn <- 2
  plotRow <- 2
} else if (!newSampleStatus) {
  print("Unable to perform Time Series Analysis: No available sample data")
} else if (!targetFileStatus) {
  print("Unable to perform Time Series Analysis: No available target file data")
} else if (!extractedIonStatus) {
  print("Unable to perform Time Series Analysis: Inconsistencies between spectra and target m/z data")
} else if (!chromatogramRegionStatus) {
  print("Unable to perform Time Series Analysis: No available chromatogram region data")
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Check and update spectral data status
  spectralDataStatus <- any(passedData[[msLevel]] == 1)
  if (spectralDataStatus) {
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 1)
    
    # Check historical data path
    if (!is.null(historicalDataPath) && file.exists(historicalDataPath)) {
      # Check historical data
      historicalData <- readRDS(historicalDataPath)
      
      if (ncol(historicalData) == ncol(passedData) &&
          all(colnames(historicalData) == colnames(passedData)) &&
          length(unique(historicalData[[arrayLength]])) == 1 &&
          unique(historicalData[[arrayLength]]) == unique(passedData[[arrayLength]])) {
        # Append historical data
        historicalData <- historicalData %>%
          dplyr::filter(.data[[msLevel]] == 1)
        
        plotData <- rbind(historicalData, plotData)
      }
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
    if (length(unique(plotData[[projectCohort]])) > 1) {
      colour <- projectCohort
      colourLabel <- "Project"
    } else {
      colour <- plate
      colourLabel <- "Plate"
    }
    
    # Extract extracted ion current (EIC)
    plotData <- ticq::extractEIC(data = plotData, intensityArray = intensityArray, targetMZ = as.character(sort(unique(targetFile$mzValue))))
  }
}
```

### Mass Calibration References {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- targetFile %>%
    dplyr::filter(compoundType == "Mass Calibration Reference" & msLevel == 1)
  targetMZ <- as.character(sort(unique(targetMZ$mzValue)))
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$massCalibration,
      retentionTime = retentionTime
    )
    
    # Sum intensity values of target m/z (EIC)
    plotData_filtered <- ticq::sumEIC(
      data = plotData_filtered,
      commonColumn = commonColumn,
      spectrumCount = spectrumCount,
      firstColumnIndex = which(colnames(plotData_filtered) == targetMZ[1])
    )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
    
    # Data frame to store analysis result
    analysisResult_TS_massCalibrationReference <- data.frame()
  } else {
    print("Unable to perform Time Series Analysis: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  print("Unable to perform Time Series Analysis: No available MS level 1 spectral data")
}
```

#### LTR {.tabset}
##### LTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### LTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### LTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

#### dLTR {.tabset}
##### dLTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### dLTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### dLTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

#### PQC {.tabset}
##### PQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### PQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### PQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

#### dPQC {.tabset}
##### dPQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### dPQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### dPQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

#### QC {.tabset}
##### QC01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### QC02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### QC03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### QC04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

#### CAL {.tabset}
##### CAL01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### CAL02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### CAL03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### CAL04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### CAL05
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### CAL06
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### CAL07
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### CAL08
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

#### Blank {.tabset}
##### Single Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

##### Double Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
  } else {
    print("No available data")
  }
}
```

#### Sample {.tabset}
##### Sample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Plasma", "LTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Serum", "LTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Urine", "LTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

#### dSample {.tabset}
##### dSample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_massCalibrationReference <- rbind(analysisResult_TS_massCalibrationReference, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
    
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern, result)
  invisible(gc())
}
```

### Internal Standards {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- targetFile %>%
    dplyr::filter(compoundType == "Internal Standard" & msLevel == 1)
  targetMZ <- as.character(sort(unique(targetMZ$mzValue)))
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$analyte,
      retentionTime = retentionTime
    )
    
    # Sum intensity values of target m/z (EIC)
    plotData_filtered <- ticq::sumEIC(
      data = plotData_filtered,
      commonColumn = commonColumn,
      spectrumCount = spectrumCount,
      firstColumnIndex = which(colnames(plotData_filtered) == targetMZ[1])
    )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
    
    # Data frame to store analysis result
    analysisResult_TS_internalStandard <- data.frame()
  } else {
    print("Unable to perform Time Series Analysis: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  print("Unable to perform Time Series Analysis: No available MS level 1 spectral data")
}
```

#### LTR {.tabset}
##### LTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### LTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### LTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

#### dLTR {.tabset}
##### dLTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### dLTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### dLTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

#### PQC {.tabset}
##### PQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### PQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### PQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

#### dPQC {.tabset}
##### dPQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### dPQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### dPQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

#### QC {.tabset}
##### QC01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### QC02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### QC03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### QC04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

#### CAL {.tabset}
##### CAL01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### CAL02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### CAL03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### CAL04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### CAL05
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### CAL06
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### CAL07
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### CAL08
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

#### Blank {.tabset}
##### Single Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

##### Double Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
  } else {
    print("No available data")
  }
}
```

#### Sample {.tabset}
##### Sample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Plasma", "LTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Serum", "LTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Urine", "LTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

#### dSample {.tabset}
##### dSample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_internalStandard <- rbind(analysisResult_TS_internalStandard, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
    
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern, result)
  invisible(gc())
}
```

### Endogenous Analytes {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- targetFile %>%
    dplyr::filter(compoundType == "Endogenous Analyte" & msLevel == 1)
  targetMZ <- as.character(sort(unique(targetMZ$mzValue)))
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$analyte,
      retentionTime = retentionTime
    )
    
    # Sum intensity values of target m/z (EIC)
    plotData_filtered <- ticq::sumEIC(
      data = plotData_filtered,
      commonColumn = commonColumn,
      spectrumCount = spectrumCount,
      firstColumnIndex = which(colnames(plotData_filtered) == targetMZ[1])
    )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
    
    # Data frame to store analysis result
    analysisResult_TS_endogenousAnalyte <- data.frame()
  } else {
    print("Unable to perform Time Series Analysis: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  print("Unable to perform Time Series Analysis: No available MS level 1 spectral data")
}
```

#### LTR {.tabset}
##### LTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### LTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### LTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

#### dLTR {.tabset}
##### dLTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### dLTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### dLTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

#### PQC {.tabset}
##### PQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### PQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### PQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

#### dPQC {.tabset}
##### dPQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### dPQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### dPQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

#### QC {.tabset}
##### QC01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### QC02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### QC03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### QC04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

#### CAL {.tabset}
##### CAL01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### CAL02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### CAL03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### CAL04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### CAL05
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### CAL06
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### CAL07
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### CAL08
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

#### Blank {.tabset}
##### Single Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

##### Double Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
  } else {
    print("No available data")
  }
}
```

#### Sample {.tabset}
##### Sample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Plasma", "LTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Serum", "LTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Urine", "LTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

#### dSample {.tabset}
##### dSample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_endogenousAnalyte <- rbind(analysisResult_TS_endogenousAnalyte, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
    
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern, result)
  invisible(gc())
}

# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Clean environment
  rm(plotData, colour, colourLabel, targetMzStatus)
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Check and update spectral data status
  spectralDataStatus <- any(passedData[[msLevel]] == 2)
  if (spectralDataStatus) {
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 2)
    
    # Check historical data path
    if (!is.null(historicalDataPath) && file.exists(historicalDataPath)) {
      # Check historical data
      historicalData <- readRDS(historicalDataPath)
      
      if (ncol(historicalData) == ncol(passedData) &&
          all(colnames(historicalData) == colnames(passedData)) &&
          length(unique(historicalData[[arrayLength]])) == 1 &&
          unique(historicalData[[arrayLength]]) == unique(passedData[[arrayLength]])) {
        # Append historical data
        historicalData <- historicalData %>%
          dplyr::filter(.data[[msLevel]] == 2)
        
        plotData <- rbind(historicalData, plotData)
      }
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
    if (length(unique(plotData[[projectCohort]])) > 1) {
      colour <- projectCohort
      colourLabel <- "Project"
    } else {
      colour <- plate
      colourLabel <- "Plate"
    }
    
    # Extract extracted ion current (EIC)
    plotData <- ticq::extractEIC(data = plotData, intensityArray = intensityArray, targetMZ = as.character(sort(unique(targetFile$mzValue))))
  }
}
```

### Products {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- targetFile %>%
    dplyr::filter(compoundType == "Product" & msLevel == 2)
  targetMZ <- as.character(sort(unique(targetMZ$mzValue)))
  
  targetMzStatus <- length(targetMZ) > 0
  if (targetMzStatus) {
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(
      data = plotData %>%
        dplyr::select(all_of(commonColumn), retentionTime, all_of(targetMZ)),
      regionOfInterest = chromatogramRegion$analyte,
      retentionTime = retentionTime
    )
    
    # Sum intensity values of target m/z (EIC)
    plotData_filtered <- ticq::sumEIC(
      data = plotData_filtered,
      commonColumn = commonColumn,
      spectrumCount = spectrumCount,
      firstColumnIndex = which(colnames(plotData_filtered) == targetMZ[1])
    )
    
    # Plot variables and labels
    firstColumnIndex <- which(colnames(plotData_filtered) == targetMZ[1])
    
    # Data frame to store analysis result
    analysisResult_TS_product <- data.frame()
  } else {
    print("Unable to perform Time Series Analysis: No available target m/z data")
  }
  
  # Clean environment
  rm(targetMZ)
} else if (!spectralDataStatus) {
  print("Unable to perform Time Series Analysis: No available MS level 2 spectral data")
}
```

#### LTR {.tabset}
##### LTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Plasma",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### LTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Serum",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### LTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = "LTR Urine",
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

#### dLTR {.tabset}
##### dLTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### dLTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### dLTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dLTR Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

#### PQC {.tabset}
##### PQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### PQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### PQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("PQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

#### dPQC {.tabset}
##### dPQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### dPQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### dPQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dPQC Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

#### QC {.tabset}
##### QC01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### QC02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### QC03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### QC04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("QC04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

#### CAL {.tabset}
##### CAL01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL01")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### CAL02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL02")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### CAL03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL03")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### CAL04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL04")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### CAL05
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL05")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### CAL06
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL06")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### CAL07
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL07")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### CAL08
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("CAL08")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

#### Blank {.tabset}
##### Single Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Single Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### Double Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Double Blank")
  
  if (any(pattern %in% sampleTypeList)) {
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% pattern),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    )
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

#### Sample {.tabset}
##### Sample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Plasma", "LTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Serum", "LTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("Sample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("sLTR Urine", "LTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

#### dSample {.tabset}
##### dSample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Plasma")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Serum")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data and target m/z status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus && targetMzStatus) {
  # Check sample type patterns
  pattern <- c("dSample Urine")
  
  if (any(pattern %in% sampleTypeList)) {
    # Compare against long term references
    tmpPattern <- c("dLTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Display time series analysis
    result <- ticq::displayMultipleTimeSeries(
      data = plotData_filtered %>%
        dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
      commonColumn = commonColumn,
      x = x,
      firstColumnIndex = firstColumnIndex,
      colour = colour,
      shape = shape,
      title = title,
      subtitle = pattern,
      caption = caption,
      xLabel = xLabel,
      yLabel = yLabel,
      colourLabel = colourLabel,
      shapeLabel = shapeLabel,
      boundary = boundary,
      referenceData = referenceData,
      xTickToggle = xTickToggle,
      plotColumn = plotColumn,
      plotRow = plotRow
    ) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append analysis result
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
    
  # Clean environment
  rm(plotData_filtered, firstColumnIndex, pattern, result)
  invisible(gc())
}

# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Clean environment
  rm(plotData, colour, colourLabel, targetMzStatus)
}

# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Clean environment
  rm(commonColumn, x, title, caption, xLabel, yLabel, shape, shapeLabel, boundary, xTickToggle, plotColumn, plotRow, spectralDataStatus)
}
```

## Mass Accuracy Analysis {.tabset}
Mass accuracy analysis provides an assessment of instrument performance in detecting target m/z based on the average mass accuracy (in ppm). A report is generated highlighting the target m/z that falls outside the accepted mass accuracy threshold.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file and extracted ion status
if (newSampleStatus && targetFileStatus && extractedIonStatus) {
  # Common data columns
  commonColumn <- colnames(passedData)[which(colnames(passedData) == sampleID):which(colnames(passedData) == spectrumCount)]
  
  # Plot data and target m/z data
  plotData <- passedData
  targetMZ <- sort(unique(targetFile$mzValue))
  
  # Check historical data path
  if (!is.null(historicalDataPath) && file.exists(historicalDataPath)) {
    # Check historical data
    historicalData <- readRDS(historicalDataPath)
    
    if (length(unique(historicalData[[arrayLength]])) == 1 && unique(historicalData[[arrayLength]]) == unique(plotData[[arrayLength]])) {
      # Append historical data
      plotData <- rbind(historicalData, plotData)
    }
    
    # Clean environment
    rm(historicalData)
    invisible(gc())
  }
  
  # Calculate average mass error
  plotData <- ticq::extractMassAccuracy(data = plotData, mzArray = mzArray, targetMZ = targetMZ)
  plotData <- ticq::calculateAverageMassAccuracy(
    data = plotData,
    commonColumn = commonColumn,
    spectrumCount = spectrumCount,
    firstColumnIndex = which(colnames(plotData) == as.character(targetMZ[1])),
    roundDecimal = roundDecimal
  )
  
  # Plot variables and labels
  x <- timestamp
  firstColumnIndex <- which(colnames(plotData) == as.character(targetMZ[1]))
  title <- "Mass Accuracy Analysis"
  subtitle <- paste(length(targetMZ), "Extracted Ions")
  caption <- "m/z"
  xLabel <- "Timestamp"
  yLabel <- "ppm"
  boundary <- "value"
  boundaryValue <- 5
  trendlineToggle <- FALSE
  xTickToggle <- TRUE
  facetWrapBy <- instrument
  plotColumn <- 2
  plotRow <- 2
  
  if (length(unique(plotData[[projectCohort]])) > 1) {
    colour <- projectCohort
    colourLabel <- "Project"
  } else {
    colour <- plate
    colourLabel <- "Plate"
  }
  
  # Display mass accuracy analysis
  analysisResult_MA <- ticq::displayMultipleTimeSeries(
    data = plotData,
    commonColumn = commonColumn,
    x = x,
    firstColumnIndex = firstColumnIndex,
    colour = colour,
    title = title,
    subtitle = subtitle,
    caption = caption,
    xLabel = xLabel,
    yLabel = yLabel,
    colourLabel = colourLabel,
    boundary = boundary,
    boundaryValue = boundaryValue,
    trendlineToggle = trendlineToggle,
    xTickToggle = xTickToggle,
    facetWrapBy = facetWrapBy,
    plotColumn = plotColumn,
    plotRow = plotRow
  )
  
  # Clean environment
  rm(commonColumn, plotData, targetMZ, x, firstColumnIndex, title, caption, xLabel, yLabel, boundary, boundaryValue, trendlineToggle,
     xTickToggle, facetWrapBy, plotColumn, plotRow, colour, colourLabel)
} else if (!newSampleStatus) {
  print("Unable to perform Mass Accuracy Analysis: No available sample data")
} else if (!targetFileStatus) {
  print("Unable to perform Mass Accuracy Analysis: No available target file data")
} else if (!extractedIonStatus) {
  print("Unable to perform Mass Accuracy Analysis: Inconsistencies between spectra and target m/z data")
}
```

# Report {.tabset}
## Time Series Analysis {.tabset}
The report highlights the deviation significance of mass calibration references, internal standards, endogenous analytes, and products present within the samples from the average mean performance.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (!newSampleStatus) {
  print("Unable to report Time Series Analysis: No available sample data")
} else if (!targetFileStatus) {
  print("Unable to report Time Series Analysis: No available target file data")
} else if (!extractedIonStatus) {
  print("Unable to report Time Series Analysis: Inconsistencies between spectra and target m/z data")
} else if (!chromatogramRegionStatus) {
  print("Unable to report Time Series Analysis: No available chromatogram region data")
} 
```

```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Check and update spectral data status
  spectralDataStatus <- any(passedData[[msLevel]] == 1)
}
```

### Mass Calibration References
The report highlights the deviation significance of m/z values associated with mass calibration references present within the samples.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal  
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- targetFile %>%
    dplyr::filter(compoundType == "Mass Calibration Reference" & msLevel == 1)
  targetMZ <- as.character(sort(unique(targetMZ$mzValue)))
  
  if (length(targetMZ) > 0) {
    # Display result
    if (ncol(analysisResult_TS_massCalibrationReference) != 0) {
      print(
        DT::datatable(
          data = analysisResult_TS_massCalibrationReference %>%
            dplyr::filter(.data[[projectCohort]] != "Historical"),
          filter = "top",
          options = list(scrollX = TRUE)
        ) %>%
          DT::formatStyle(
            columns = targetMZ,
            target = "cell",
            backgroundColor = styleEqual(
              c("Very Low", "Low", "Normal", "High", "Very High"),
              c("pink", "lightyellow", "lightgreen", "lightyellow", "pink")
            )
          )
      )
    } else {
      print("No available data")
    }
    
    # Clean environment
    rm(analysisResult_TS_massCalibrationReference)
    invisible(gc())
  } else {
    print("Unable to report Time Series Analysis: No available target m/z data")
  }
} else if (!spectralDataStatus) {
  print("Unable to report Time Series Analysis: No available MS level 1 spectral data")
}
```

### Internal Standards
The report highlights the deviation significance of m/z values associated with internal standards present within the samples.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal  
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- targetFile %>%
    dplyr::filter(compoundType == "Internal Standard" & msLevel == 1)
  targetMZ <- as.character(sort(unique(targetMZ$mzValue)))
  
  if (length(targetMZ) > 0) {
    # Display result
    if (ncol(analysisResult_TS_internalStandard) != 0) {
      print(
        DT::datatable(
          data = analysisResult_TS_internalStandard %>%
            dplyr::filter(.data[[projectCohort]] != "Historical"),
          filter = "top",
          options = list(scrollX = TRUE)
        ) %>%
          DT::formatStyle(
            columns = targetMZ,
            target = "cell",
            backgroundColor = styleEqual(
              c("Very Low", "Low", "Normal", "High", "Very High"),
              c("pink", "lightyellow", "lightgreen", "lightyellow", "pink")
            )
          )
      )
    } else {
      print("No available data")
    }
    
    # Clean environment
    rm(analysisResult_TS_internalStandard)
    invisible(gc())
  } else {
    print("Unable to report Time Series Analysis: No available target m/z data")
  }
} else if (!spectralDataStatus) {
  print("Unable to report Time Series Analysis: No available MS level 1 spectral data")
}
```

### Endogenous Analytes
The report highlights the deviation significance of m/z values associated with endogenous analytes present within the samples.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal  
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- targetFile %>%
    dplyr::filter(compoundType == "Endogenous Analyte" & msLevel == 1)
  targetMZ <- as.character(sort(unique(targetMZ$mzValue)))
  
  if (length(targetMZ) > 0) {
    # Display result
    if (ncol(analysisResult_TS_endogenousAnalyte) != 0) {
      print(
        DT::datatable(
          data = analysisResult_TS_endogenousAnalyte %>%
            dplyr::filter(.data[[projectCohort]] != "Historical"),
          filter = "top",
          options = list(scrollX = TRUE)
        ) %>%
          DT::formatStyle(
            columns = targetMZ,
            target = "cell",
            backgroundColor = styleEqual(
              c("Very Low", "Low", "Normal", "High", "Very High"),
              c("pink", "lightyellow", "lightgreen", "lightyellow", "pink")
            )
          )
      )
    } else {
      print("No available data")
    }
    
    # Clean environment
    rm(analysisResult_TS_endogenousAnalyte)
    invisible(gc())
  } else {
    print("Unable to report Time Series Analysis: No available target m/z data")
  }
} else if (!spectralDataStatus) {
  print("Unable to report Time Series Analysis: No available MS level 1 spectral data")
}

# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Clean environment
  rm(targetMZ)
} 
```

```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Check and update spectral data status
  spectralDataStatus <- any(passedData[[msLevel]] == 2)
} 
```

### Products
The report highlights the deviation significance of m/z values associated with products present within the samples.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal  
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file, extracted ion, chromatogram region, spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Check and update target m/z status
  targetMZ <- targetFile %>%
    dplyr::filter(compoundType == "Product" & msLevel == 2)
  targetMZ <- as.character(sort(unique(targetMZ$mzValue)))
  
  if (length(targetMZ) > 0) {
    # Display result
    if (ncol(analysisResult_TS_product) != 0) {
      print(
        DT::datatable(
          data = analysisResult_TS_product %>%
            dplyr::filter(.data[[projectCohort]] != "Historical"),
          filter = "top",
          options = list(scrollX = TRUE)
        ) %>%
          DT::formatStyle(
            columns = targetMZ,
            target = "cell",
            backgroundColor = styleEqual(
              c("Very Low", "Low", "Normal", "High", "Very High"),
              c("pink", "lightyellow", "lightgreen", "lightyellow", "pink")
            )
          )
      )
    } else {
      print("No available data")
    }
    
    # Clean environment
    rm(analysisResult_TS_product)
    invisible(gc())
  } else {
    print("Unable to report Time Series Analysis: No available target m/z data")
  }
} else if (!spectralDataStatus) {
  print("Unable to report Time Series Analysis: No available MS level 2 spectral data")
}

# Check new sample, target file, extracted ion, chromatogram region and spectral data status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus && spectralDataStatus) {
  # Clean environment
  rm(targetMZ)
} 

# Check new sample, target file, extracted ion and chromatogram region status
if (newSampleStatus && targetFileStatus && extractedIonStatus && chromatogramRegionStatus) {
  # Clean environment
  rm(spectralDataStatus)
} 
```

## Mass Accuracy Analysis
The report highlights m/z values within the spectra that falls outside the accepted mass accuracy (in ppm) threshold.
```{r, echo = FALSE, warning = FALSE}
# Check new sample, target file and extracted ion status
if (newSampleStatus && targetFileStatus && extractedIonStatus) {
  # Display result
  if (!is.null(analysisResult_MA) && ncol(analysisResult_MA) != 0) {
    print(
      DT::datatable(
        data = analysisResult_MA %>%
          dplyr::filter(.data[[projectCohort]] != "Historical"),
        filter = "top",
        options = list(scrollX = TRUE)
      ) %>%
        DT::formatStyle(
          columns = as.character(sort(unique(targetFile$mzValue))),
          target = "cell",
          backgroundColor = styleEqual(
            c("Low", "Normal", "High"),
            c("pink", "lightgreen", "pink")
          )
        )
    )
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(analysisResult_MA)
  invisible(gc())
} else if (!newSampleStatus) {
  print("Unable to report Mass Accuracy Analysis: No available sample data")
} else if (!targetFileStatus) {
  print("Unable to report Mass Accuracy Analysis: No available target file data")
} else if (!extractedIonStatus) {
  print("Unable to report Mass Accuracy Analysis: Inconsistencies between spectra and target m/z data")
}
```
