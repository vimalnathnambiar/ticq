---
title: "TICQ Report: `r params$title`"
subtitle: "Total Ion Current Quality Assessment of Mass Spectrometry Spectral Data"
author: "Vimalnath Nambiar and Shabarinath Nambiar"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: 
  html_notebook:
    toc: true
    toc_float: true
    toc_depth: 6
    theme: paper
  html_document:
    toc: true
    toc_float: true
    toc_depth: 6
    theme: paper
params:
    title: NULL
    input: NULL
    chromatogramRegion: NULL
    targetFile: NULL
    anpcMethodLibrary: NULL
    roundDecimal: NULL
    anonymiserStatus: FALSE
---

# Configuration Parameters {.tabset}
Parameters configured for TICQ assessment.
```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Load packages
ticq::loadPackage(packageList = c("DT", "dplyr"))

# Define input data
# input <- params$input
input <- "/run/media/vimalnathnambiar/WD/data/JSON/barwon/"

# Define chromatogram regions
# chromatogramRegion <- params$chromatogramRegion
chromatogramRegion <- ticq::configureChromatogramRegion(massCalStart = 0, massCalEnd = 0.3,
                                                        washStart = 5)

# Define target file or in-house ANPC method library (Either one)
targetFile <- params$targetFile
# anpcMethodLibrary <- params$anpcMethodLibrary
anpcMethodLibrary <- "MS-AA-POS"

# Define number of decimal places for precision value rounding
# roundDecimal <- params$roundDecimal
roundDecimal <- 4

# Define sample anonymiser status
anonymiserStatus <- params$anonymiserStatus
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Identify path to historical data (In-house ANPC method specific)
historicalDataPath <- paste0(getwd(), "/../data/historical/")
if (!is.null(anpcMethodLibrary)) {
  switch(anpcMethodLibrary,
         "MS-AA-POS" = historicalDataPath <- paste0(historicalDataPath, "MS-AA-POS.rds"),
         "MS-HIL-POS" = historicalDataPath <- paste0(historicalDataPath, "MS-HIL-POS.rds"),
         "MS-HIL-NEG" = historicalDataPath <- paste0(historicalDataPath, "MS-HIL-NEG.rds"),
         "MS-RP-POS" = historicalDataPath <- paste0(historicalDataPath, "MS-RP-POS.rds"),
         "MS-RP-NEG" = historicalDataPath <- paste0(historicalDataPath, "MS-RP-NEG.rds")
  )
} else {
  historicalDataPath <- NULL
}

# Extract target m/z data
targetMZ <- ticq::extractTargetMZ(targetFile = targetFile,
                                  anpcMethodLibrary = anpcMethodLibrary,
                                  roundDecimal = roundDecimal)

# Clean environment
rm(targetFile, anpcMethodLibrary)
```

## Input
```{r, echo = FALSE, warning = FALSE}
# Display input path
print(input)
```

## Chromatogram Region
```{r, echo = FALSE, warning = FALSE}
# Display chromatogram regions
print(chromatogramRegion)
```

## Target m/z
```{r, echo = FALSE, warning = FALSE}
# Check if target m/z data is available
if (!is.null(targetMZ)) {
  # Display number of decimal places used for precision value rounding
  if (!is.null(roundDecimal)) {
    print(paste("NOTE: Precision values rounded to", roundDecimal, "decimal place(s)"))
  } else {
    print("NOTE: Using DEFAULT precision values")
  }

  # Display target m/z data
  DT::datatable(data = targetMZ,
                filter = "top",
                options = list(scrollX = TRUE))
} else {
  print("No available target m/z data")
}
```

# Input Check
Input validated for the presence of JSON file(s) to be assessed.
```{r, echo = FALSE, warning = FALSE}
# Display number of JSON files to assess
inputFiles <- ticq::retrieveFileName(input = input, fileExtension = "JSON")
print(paste("Number of JSON files to process:", length(inputFiles)))

# Update new sample status
if (length(inputFiles) > 0) {
  newStatus <- TRUE
} else {
  newStatus <- FALSE
  
  # Clean environment
  rm(input, inputFiles)
}
```

# Spectral Data Extraction
Spectral data is extracted from JSON file(s) retrieved from input. 
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newStatus) {
  # Extract spectral data and metadata
  result <- ticq::extractSpectrum(input = input, inputFiles = inputFiles)
  passedData <- result$passedData
  
  # Update new sample status (and save data if applicable)
  if (nrow(passedData) != 0) {
    newStatus <- TRUE
    saveRDS(passedData, file = paste0(getwd(), "/../data/raw.rds"))
  } else {
    newStatus <- FALSE
  }
  
  # Display result
  print(paste("Number of files that failed spectral data extraction:", nrow(result$failedData)))
  if (nrow(result$failedData) != 0) {
    print(DT::datatable(data = result$failedData,
                        filter = "top",
                        options = list(scrollX = TRUE)))
  }
  
  # Clean environment
  rm(input, inputFiles, result)
  invisible(gc())
} else {
  print("Spectral data extraction not performed: No data files available for extraction")
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample status
if (newStatus) {
  # Column names of extracted spectral data
  sampleID <- "sampleID"
  project <- "project"
  cohort <- "cohort"
  projectCohort <- "projectCohort"
  matrix <- "matrix"
  sampleType <- "sampleType"
  method <- "method"
  instrument <- "instrument"
  plate <- "plate"
  date <- "date"
  time <- "time"
  timestamp <- "timestamp"
  spectrumCount <- "spectrumCount"
  spectrumIndex <- "spectrum.index"
  msLevel <- "spectrum.msLevel"
  retentionTime <- "spectrum.retentionTime"
  basePeakIntensity <- "spectrum.basePeakIntensity"
  basePeakMZ <- "spectrum.basePeakMZ"
  totalIonCurrent <- "spectrum.totalIonCurrent"
  mzArray <- "spectrum.mzArray"
  intensityArray <- "spectrum.intensityArray"
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample status and sample anonymiser status
if (newStatus && anonymiserStatus) {
  # Anonymise metadata
  passedData <- ticq::anonymiseMetadata(data = passedData,
                                        sampleID = sampleID,
                                        project = project,
                                        cohort = cohort,
                                        projectCohort = projectCohort,
                                        method = method,
                                        instrument = instrument,
                                        plate = plate)
}

# Clean environment
rm(anonymiserStatus)
```

# Preliminary Data Check {.tabset}
## Undefined Sample Type Check
Extracted samples are checked for the presence of undefined sample type (based on metadata).
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newStatus) {
  # Check for undefined sample types
  result <- ticq::checkUndefinedSampleType(data = passedData,
                                           commonColumn = colnames(passedData)[which(colnames(passedData) == sampleID):
                                                                               which(colnames(passedData) == spectrumCount)],
                                           sampleType = sampleType,
                                           spectrumCount = spectrumCount)
  
  # Update new sample status
  passedData <- result$passedData
  if (nrow(passedData) == 0) {
    newStatus <- FALSE
  }
  
  # Display result
  print(paste("Number of samples with undefined sample type:", nrow(result$failedData)))
  if (nrow(result$failedData) != 0) {
    print(DT::datatable(data = result$failedData,
                        filter = "top",
                        options = list(scrollX = TRUE)))
  }
  
  # Clean environment
  rm(result)
  invisible(gc())
} else {
  print("Undefined sample type check not performed: No new samples to analyse")
}
```

## Spectrum Count Check
Spectrum count of samples are checked against a threshold limit of 20% below average spectrum count of all samples (mean).
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newStatus) {
  # If historical data exists
  if (file.exists(historicalDataPath)) {
    historicalData <- readRDS(historicalDataPath)
    
    # Merge historical data and new data
    passedData <- rbind(historicalData, passedData)
    
    # Clean environment
    rm(historicalData)
    invisible(gc())
  }
  
  # Check spectrum count
  if (length(unique(passedData[[sampleID]])) > 1) {
    result <- ticq::checkSpectrumCount(data = passedData,
                                       commonColumn = colnames(passedData)[which(colnames(passedData) == sampleID):
                                                                           which(colnames(passedData) == spectrumCount)],
                                       sampleID = sampleID,
                                       spectrumCount = spectrumCount,
                                       threshold = 20)
  } else {
    print("Spectrum count check not performed: Only one sample to analyse")
    result <- NULL
  }
  
  # If spectrum count check performed
  if (!is.null(result)) {
    # Remove historical data from passed and failed results
    result$passedData <- result$passedData %>%
      dplyr::filter(.data[[projectCohort]] != "Historical")
    
    result$failedData <- result$failedData %>%
      dplyr::filter(.data[[projectCohort]] != "Historical")
    
    # Update new sample status
    passedData <- result$passedData
    if (nrow(passedData) == 0) {
      newStatus <- FALSE
    }
    
    # Display result
    print(paste("Sample size:", result$sampleSize))
    print(paste("Spectrum count (TOTAL):", result$total))
    print(paste("Spectrum count (MEAN):", result$mean))
    print(paste("Threshold limit (20% BELOW MEAN):", result$threshold))
    print(paste("Number of samples with a spectrum count below the threshold limit:", nrow(result$failedData)))
    if (nrow(result$failedData) != 0) {
      print(DT::datatable(data = result$failedData,
                          filter = "top",
                          options = list(scrollX = TRUE)))
    }
  }
  
  # Clean environment
  rm(result)
  invisible(gc())
} else {
  print("Spectrum count check not performed: No new samples to analyse")
}
```

# Sample Types To Be Analysed
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newStatus) {
  # Display sample types to be analysed
  sampleTypeList <- unique(passedData[[sampleType]])
  print(sampleTypeList)
} else {
  print("No new samples to analyse")
}
```

# Total Ion Chromatogram {.tabset}
Chromatogram overview (Total ion current, TIC vs Retention Time, RT) of each sample type along with 3 chromatographic regions of interest (mass calibration, analyte, and wash regions) are plotted using full scan MS level 1 spectral data. 
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newStatus) {
  # Check if spectral data is available
  if (any(passedData[[msLevel]] == 1)) {
    # Update spectral data status
    msStatus <- TRUE
    
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 1) %>%
      dplyr::select(all_of(colnames(passedData)[which(colnames(passedData) == sampleID):
                                                which(colnames(passedData) == spectrumCount)]),
                    retentionTime, totalIonCurrent)
    
    # If historical data exists
    if (file.exists(historicalDataPath)) {
      historicalData <- readRDS(historicalDataPath)
      
      # Filter historical data
      historicalData <- historicalData %>%
        dplyr::filter(.data[[msLevel]] == 1) %>%
        dplyr::select(all_of(colnames(historicalData)[which(colnames(historicalData) == sampleID):
                                                      which(colnames(historicalData) == spectrumCount)]),
                      retentionTime, totalIonCurrent)
      
      # Merge historical data and plot data
      plotData <- rbind(historicalData, plotData)
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
    x <- retentionTime
    y <- totalIonCurrent
    title <- "Total Ion Chromatogram"
    xLabel <- "RT"
    yLabel <- "TIC"
    shape <- sampleType
    shapeLabel <- "Sample Type"
    
      # Colour grouping variable and label
      if (length(unique(plotData[[projectCohort]])) > 1) {
        colour <- projectCohort
        colourLabel <- "Project"
      } else {
        colour <- plate
        colourLabel <- "Plate"
      }
  } else {
    # Update spectral data status
    msStatus <- FALSE
    print("Unable to display Total Ion Chromatogram: No available MS level 1 spectral data")
  }
} else {
  print("Unable to display Total Ion Chromatogram: No new samples to analyse")
}
```

## LTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma",
               "sLTR Serum", "LTR Serum",
               "sLTR Urine", "LTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern combination that exists
    for (i in unique(sub("sLTR |LTR ", "", pattern))) {
      # If any of the combined pattern exists
      tmpPattern <- c(paste("sLTR", i), paste("LTR", i))
      if (any(tmpPattern %in% sampleTypeList)) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% tmpPattern),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = paste("LTR", i),
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
      
      # Clean environment
      rm(tmpPattern)
    }
  } else {
    print("No available data")
  }
}
```

## dLTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dLTR Plasma", "dLTR Serum", "dLTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
}
```

## PQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("PQC Plasma", "PQC Serum", "PQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
}
```

## dPQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dPQC Plasma", "dPQC Serum", "dPQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
}
```

## QC
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("QC01", "QC02", "QC03", "QC04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
}
```

## CAL
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("CAL01", "CAL02", "CAL03", "CAL04", "CAL05", "CAL06", "CAL07", "CAL08")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
}
```

## Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("Single Blank", "Double Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
}
```

## Sample
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("Sample Plasma", "Sample Serum", "Sample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
}
```

## dSample
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dSample Plasma", "dSample Serum", "dSample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(x, y, title, xLabel, yLabel, pattern, i)
}
```

# Statistical Analysis {.tabset}
The chromatogram regions of interest (mass calibration, analyte, and wash regions) of the samples are assessed by their corresponding sample type using statistical methodologies such as PCA, time series, and violin plot analyses.
```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Splice chromatogram regions (New plot data)
  plotData <- ticq::spliceChromatogramRegion(data = plotData,
                                             commonColumn = colnames(plotData)[which(colnames(plotData) == sampleID):
                                                                               which(colnames(plotData) == spectrumCount)],
                                             spectrumCount = spectrumCount,
                                             chromatogramRegion = chromatogramRegion,
                                             retentionTime = retentionTime,
                                             sumColumn = totalIonCurrent)
  
  # Column names of spliced chromatogram regions
  overallRegion <- "overallRegion"
  prewashRegion <- "prewashRegion"
  massCalRegion <- "massCalRegion"
  analyteRegion <- "analyteRegion"
  washRegion <- "washRegion"
}
```

## Principal Component Analysis (PCA) {.tabset}
PCA provides an overview of the overall sample variance influenced by the 3 chromatogram regions of interest: mass calibration, analyte, and wash regions. 
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (!newStatus) {
  print("Unable to perform Principal Component Analysis: No new samples to analyse")
} else if (!msStatus) {
  print("Unable to perform Principal Component Analysis: No available MS level 1 spectral data")
} else {
  # Plot variables and labels
  startIDX <- which(colnames(plotData) == massCalRegion)
  screePlotToggle <- TRUE
  scoresPlotToggle <- FALSE
  loadingsPlotToggle <- FALSE
  biPlotToggle <- TRUE
}
```

### LTR {.tabset}
#### LTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = "LTR Plasma",
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### LTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = "LTR Serum",
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### LTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = "LTR Urine",
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

### dLTR {.tabset}
#### dLTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dLTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### dLTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dLTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### dLTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dLTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

### PQC {.tabset}
#### PQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("PQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### PQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("PQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### PQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("PQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

### dPQC {.tabset}
#### dPQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dPQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### dPQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dPQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### dPQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dPQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

### QC {.tabset}
#### QC01
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("QC01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### QC02
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("QC02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### QC03
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("QC03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### QC04
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("QC04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

### CAL {.tabset}
#### CAL01
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("CAL01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### CAL02
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("CAL02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### CAL03
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("CAL03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### CAL04
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("CAL04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### CAL05
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("CAL05")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### CAL06
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("CAL06")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### CAL07
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("CAL07")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### CAL08
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("CAL08")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

### Blank {.tabset}
#### Single Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("Single Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### Double Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("Double Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = pattern,
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

### Sample {.tabset}
#### Sample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma", "Sample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = "Sample Plasma",
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### Sample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum", "Sample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = "Sample Serum",
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### Sample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine", "Sample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = "Sample Urine",
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

### dSample {.tabset}
#### dSample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dLTR Plasma", "dSample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = "dSample Plasma",
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### dSample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dLTR Serum", "dSample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = "dSample Serum",
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
}
```

#### dSample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dLTR Urine", "dSample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot PCA
    ticq::plotPCA(data = plotData %>%
                    dplyr::filter(.data[[sampleType]] %in% pattern),
                  startIDX = startIDX,
                  colour = colour,
                  shape = shape,
                  subtitle = "dSample Plasma",
                  colourLabel = colourLabel,
                  shapeLabel = shapeLabel,
                  screePlotToggle = screePlotToggle,
                  scoresPlotToggle = scoresPlotToggle,
                  loadingsPlotToggle = loadingsPlotToggle,
                  biPlotToggle = biPlotToggle)
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(startIDX, screePlotToggle, scoresPlotToggle, loadingsPlotToggle, biPlotToggle, pattern)
}
```

## Time Series Analysis {.tabset}
Time series analysis focuses on the prewash region (combined mass calibration and analyte regions). This analysis provides a temporal trendline and assesses the combined performance of mass calibration references, internal standards and endogenous analytes present within the samples in the region. A report is generated highlighting the samples that have a significant 1st and 2nd standard deviation from the average mean performance of the region.
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Plot variables and labels
  x <- timestamp
  y <- prewashRegion
  xLabel <- "Timestamp"
  yLabel <- "Prewash Region (TIC)"
  boundary <- "sd"
  xTickToggle <- TRUE
  
  # Data frame to store analysis result
  analysisResult_TS <- data.frame()
} else if (!newStatus) {
  print("Unable to perform Time Series Analysis: No new samples to analyse")
} else if (!msStatus) {
  print("Unable to perform Time Series Analysis: No available MS level 1 spectral data")
}
```

### LTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma",
               "sLTR Serum", "LTR Serum",
               "sLTR Urine", "LTR Urine")

  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate time series plot for each pattern combination that exists
    for (i in unique(sub("sLTR |LTR ", "", pattern))) {
      # If any of the combined pattern exists
      tmpPattern <- c(paste("sLTR", i), paste("LTR", i))
      if (any(tmpPattern %in% sampleTypeList)) {
        # Plot time series
        result <- ticq::plotTimeSeries(data = plotData %>%
                                         dplyr::filter(.data[[sampleType]] %in% tmpPattern),
                                       x = x,
                                       y = y,
                                       colour = colour,
                                       shape = shape,
                                       subtitle = paste("LTR", i),
                                       xLabel = xLabel,
                                       yLabel = yLabel,
                                       colourLabel = colourLabel,
                                       shapeLabel = shapeLabel,
                                       boundary = boundary,
                                       xTickToggle = xTickToggle)

        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
      }

      # Clean environment
      rm(tmpPattern)
    }
  } else {
    print("No available data")
  }
}
```

### dLTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dLTR Plasma", "dLTR Serum", "dLTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate time series plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot time series
        result <- ticq::plotTimeSeries(data = plotData %>%
                                         dplyr::filter(.data[[sampleType]] %in% i),
                                       x = x,
                                       y = y,
                                       colour = colour,
                                       shape = shape,
                                       subtitle = i,
                                       xLabel = xLabel,
                                       yLabel = yLabel,
                                       colourLabel = colourLabel,
                                       shapeLabel = shapeLabel,
                                       boundary = boundary,
                                       xTickToggle = xTickToggle)
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

### PQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("PQC Plasma", "PQC Serum", "PQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate time series plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot time series
        result <- ticq::plotTimeSeries(data = plotData %>%
                                         dplyr::filter(.data[[sampleType]] %in% i),
                                       x = x,
                                       y = y,
                                       colour = colour,
                                       shape = shape,
                                       subtitle = i,
                                       xLabel = xLabel,
                                       yLabel = yLabel,
                                       colourLabel = colourLabel,
                                       shapeLabel = shapeLabel,
                                       boundary = boundary,
                                       xTickToggle = xTickToggle)
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

### dPQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dPQC Plasma", "dPQC Serum", "dPQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate time series plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot time series
        result <- ticq::plotTimeSeries(data = plotData %>%
                                         dplyr::filter(.data[[sampleType]] %in% i),
                                       x = x,
                                       y = y,
                                       colour = colour,
                                       shape = shape,
                                       subtitle = i,
                                       xLabel = xLabel,
                                       yLabel = yLabel,
                                       colourLabel = colourLabel,
                                       shapeLabel = shapeLabel,
                                       boundary = boundary,
                                       xTickToggle = xTickToggle)
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

### QC
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("QC01", "QC02", "QC03", "QC04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate time series plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot time series
        result <- ticq::plotTimeSeries(data = plotData %>%
                                         dplyr::filter(.data[[sampleType]] %in% i),
                                       x = x,
                                       y = y,
                                       colour = colour,
                                       shape = shape,
                                       subtitle = i,
                                       xLabel = xLabel,
                                       yLabel = yLabel,
                                       colourLabel = colourLabel,
                                       shapeLabel = shapeLabel,
                                       boundary = boundary,
                                       xTickToggle = xTickToggle)
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

### CAL
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("CAL01", "CAL02", "CAL03", "CAL04", "CAL05", "CAL06", "CAL07", "CAL08")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate time series plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot time series
        result <- ticq::plotTimeSeries(data = plotData %>%
                                         dplyr::filter(.data[[sampleType]] %in% i),
                                       x = x,
                                       y = y,
                                       colour = colour,
                                       shape = shape,
                                       subtitle = i,
                                       xLabel = xLabel,
                                       yLabel = yLabel,
                                       colourLabel = colourLabel,
                                       shapeLabel = shapeLabel,
                                       boundary = boundary,
                                       xTickToggle = xTickToggle)
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

### Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("Single Blank", "Double Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate time series plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot time series
        result <- ticq::plotTimeSeries(data = plotData %>%
                                         dplyr::filter(.data[[sampleType]] %in% i),
                                       x = x,
                                       y = y,
                                       colour = colour,
                                       shape = shape,
                                       subtitle = i,
                                       xLabel = xLabel,
                                       yLabel = yLabel,
                                       colourLabel = colourLabel,
                                       shapeLabel = shapeLabel,
                                       boundary = boundary,
                                       xTickToggle = xTickToggle)
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

### Sample
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("Sample Plasma", "Sample Serum", "Sample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate time series plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Search long term references for comparison
        tmpPattern <- sub("Sample ", "", i)
        tmpPattern <- c(paste("sLTR", tmpPattern), paste("LTR", tmpPattern))
        referenceData <- plotData %>%
          dplyr::filter(.data[[sampleType]] %in% tmpPattern)
                
        # Plot time series
        result <- ticq::plotTimeSeries(data = plotData %>%
                                         dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
                                       x = x,
                                       y = y,
                                       colour = colour,
                                       shape = shape,
                                       subtitle = i,
                                       xLabel = xLabel,
                                       yLabel = yLabel,
                                       colourLabel = colourLabel,
                                       shapeLabel = shapeLabel,
                                       boundary = boundary,
                                       referenceData = referenceData,
                                       xTickToggle = xTickToggle) %>%
          dplyr::filter(.data[[sampleType]] %in% i)
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
        
        # Clean environment
        rm(tmpPattern, referenceData)
        invisible(gc())
      }
    }
  } else {
    print("No available data")
  }
}
```

### dSample
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dSample Plasma", "dSample Serum", "dSample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate time series plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Search long term references for comparison
        tmpPattern <- sub("dSample ", "", i)
        tmpPattern <- c(paste("dLTR", tmpPattern))
        referenceData <- plotData %>%
          dplyr::filter(.data[[sampleType]] %in% tmpPattern)
                
        # Plot time series
        result <- ticq::plotTimeSeries(data = plotData %>%
                                         dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
                                       x = x,
                                       y = y,
                                       colour = colour,
                                       shape = shape,
                                       subtitle = i,
                                       xLabel = xLabel,
                                       yLabel = yLabel,
                                       colourLabel = colourLabel,
                                       shapeLabel = shapeLabel,
                                       boundary = boundary,
                                       referenceData = referenceData,
                                       xTickToggle = xTickToggle) %>%
          dplyr::filter(.data[[sampleType]] %in% i)
        
        # Append analysis result
        analysisResult_TS <- rbind(analysisResult_TS, result)
        
        # Clean environment
        rm(tmpPattern, referenceData)
        invisible(gc())
      }
    }
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(x, y, xLabel, yLabel, boundary, xTickToggle, pattern, i, result)
  invisible(gc())
}
```

## Violin Plot Analysis {.tabset}
Violin plot analysis focuses on the two distinct chromatogram regions that made up the prewash region previously assessed - mass calibration and analyte region. Two reports are generated highlighting the samples that have a significant 1st and 2nd standard deviation from the average mean of the overall data distribution in the two regions, respectively.
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Plot variables and labels
  x <- instrument
  xLabel <- "Instrument"
  boundary <- "sd"
  violinPlotToggle <- TRUE
  boxPlotToggle <- TRUE
  boxWidth <- 0.05
} else if (!newStatus) {
  print("Unable to perform Violin Plot Analysis: No new samples to analyse")
} else if (!msStatus) {
  print("Unable to perform Violin Plot Analysis: No available MS level 1 spectral data")
}
```

### Mass Calibration Region {.tabset}
Violin plot analysis of the mass calibration region assesses the performance of the mass calibration references present within the samples.
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Plot variables and labels
  y <- massCalRegion
  yLabel <- "Mass Calibration Region (TIC)"
  
  # Data frame to store analysis result
  analysisResult_VP_massCalRegion <- data.frame()
}
```

#### LTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma",
               "sLTR Serum", "LTR Serum",
               "sLTR Urine", "LTR Urine")

  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern combination that exists
    for (i in unique(sub("sLTR |LTR ", "", pattern))) {
      # If any of the combined pattern exists
      tmpPattern <- c(paste("sLTR", i), paste("LTR", i))
      if (any(tmpPattern %in% sampleTypeList)) {
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% tmpPattern),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = paste("LTR", i),
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth)
        
        # Append analysis result
        analysisResult_VP_massCalRegion <- rbind(analysisResult_VP_massCalRegion, result)
      }
      
      # Clean environment
      rm(tmpPattern)
    }
  } else {
    print("No available data")
  }
}
```

#### dLTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dLTR Plasma", "dLTR Serum", "dLTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% i),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth)

        # Append analysis result
        analysisResult_VP_massCalRegion <- rbind(analysisResult_VP_massCalRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### PQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("PQC Plasma", "PQC Serum", "PQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% i),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth)

        # Append analysis result
        analysisResult_VP_massCalRegion <- rbind(analysisResult_VP_massCalRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### dPQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dPQC Plasma", "dPQC Serum", "dPQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% i),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth)

        # Append analysis result
        analysisResult_VP_massCalRegion <- rbind(analysisResult_VP_massCalRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### QC
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("QC01", "QC02", "QC03", "QC04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% i),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth)

        # Append analysis result
        analysisResult_VP_massCalRegion <- rbind(analysisResult_VP_massCalRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### CAL
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("CAL01", "CAL02", "CAL03", "CAL04", "CAL05", "CAL06", "CAL07", "CAL08")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% i),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth)

        # Append analysis result
        analysisResult_VP_massCalRegion <- rbind(analysisResult_VP_massCalRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("Single Blank", "Double Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% i),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth)

        # Append analysis result
        analysisResult_VP_massCalRegion <- rbind(analysisResult_VP_massCalRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### Sample
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("Sample Plasma", "Sample Serum", "Sample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Search long term references for comparison
        tmpPattern <- sub("Sample ", "", i)
        tmpPattern <- c(paste("sLTR", tmpPattern), paste("LTR", tmpPattern))
        referenceData <- plotData %>%
          dplyr::filter(.data[[sampleType]] %in% tmpPattern)
        
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   referenceData = referenceData,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth) %>%
          dplyr::filter(.data[[sampleType]] %in% i)

        # Append analysis result
        analysisResult_VP_massCalRegion <- rbind(analysisResult_VP_massCalRegion, result)
        
        # Clean environment
        rm(tmpPattern, referenceData)
        invisible(gc())
      }
    }
  } else {
    print("No available data")
  }
}
```

#### dSample
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dSample Plasma", "dSample Serum", "dSample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Search long term references for comparison
        tmpPattern <- sub("dSample ", "", i)
        tmpPattern <- c(paste("dLTR", tmpPattern))
        referenceData <- plotData %>%
          dplyr::filter(.data[[sampleType]] %in% tmpPattern)
        
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   referenceData = referenceData,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth) %>%
          dplyr::filter(.data[[sampleType]] %in% i)

        # Append analysis result
        analysisResult_VP_massCalRegion <- rbind(analysisResult_VP_massCalRegion, result)
        
        # Clean environment
        rm(tmpPattern, referenceData)
        invisible(gc())
      }
    }
  } else {
    print("No available data")
  }
}
```

### Analyte Region {.tabset}
Violin plot analysis of the mass calibration region assesses the combined performance of the internal standards and endogenous analytes present within the samples.
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Plot variables and labels
  y <- analyteRegion
  yLabel <- "Analyte Region (TIC)"
  
  # Data frame to store analysis result
  analysisResult_VP_analyteRegion <- data.frame()
}
```

#### LTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma",
               "sLTR Serum", "LTR Serum",
               "sLTR Urine", "LTR Urine")

  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern combination that exists
    for (i in unique(sub("sLTR |LTR ", "", pattern))) {
      # If any of the combined pattern exists
      tmpPattern <- c(paste("sLTR", i), paste("LTR", i))
      if (any(tmpPattern %in% sampleTypeList)) {
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% tmpPattern),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = paste("LTR", i),
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth)

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
      }
      
      # Clean environment
      rm(tmpPattern)
    }
  } else {
    print("No available data")
  }
}
```

#### dLTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dLTR Plasma", "dLTR Serum", "dLTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% i),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth)

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### PQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("PQC Plasma", "PQC Serum", "PQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% i),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth)

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### dPQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dPQC Plasma", "dPQC Serum", "dPQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% i),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth)

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### QC
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("QC01", "QC02", "QC03", "QC04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% i),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth)

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### CAL
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("CAL01", "CAL02", "CAL03", "CAL04", "CAL05", "CAL06", "CAL07", "CAL08")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% i),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth)

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("Single Blank", "Double Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% i),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth)

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
      }
    }
  } else {
    print("No available data")
  }
}
```

#### Sample
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("Sample Plasma", "Sample Serum", "Sample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Search long term references for comparison
        tmpPattern <- sub("Sample ", "", i)
        tmpPattern <- c(paste("sLTR", tmpPattern), paste("LTR", tmpPattern))
        referenceData <- plotData %>%
          dplyr::filter(.data[[sampleType]] %in% tmpPattern)
        
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   referenceData = referenceData,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth) %>%
          dplyr::filter(.data[[sampleType]] %in% i)

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
        
        # Clean environment
        rm(tmpPattern, referenceData)
        invisible(gc())
      }
    }
  } else {
    print("No available data")
  }
}
```

#### dSample
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dSample Plasma", "dSample Serum", "dSample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate violin plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Search long term references for comparison
        tmpPattern <- sub("dSample ", "", i)
        tmpPattern <- c(paste("dLTR", tmpPattern))
        referenceData <- plotData %>%
          dplyr::filter(.data[[sampleType]] %in% tmpPattern)
        
        # Plot violin plot
        result <- ticq::plotViolin(data = plotData %>%
                                     dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, i)),
                                   x = x,
                                   y = y,
                                   colour = colour,
                                   shape = shape,
                                   subtitle = i,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   shapeLabel = shapeLabel,
                                   boundary = boundary,
                                   referenceData = referenceData,
                                   violinPlotToggle = violinPlotToggle,
                                   boxPlotToggle = boxPlotToggle,
                                   boxWidth = boxWidth) %>%
          dplyr::filter(.data[[sampleType]] %in% i)

        # Append analysis result
        analysisResult_VP_analyteRegion <- rbind(analysisResult_VP_analyteRegion, result)
        
        # Clean environment
        rm(tmpPattern, referenceData)
        invisible(gc())
      }
    }
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(shape,
     shapeLabel,
     colour,
     colourLabel,
     plotData, 
     overallRegion, 
     prewashRegion, 
     massCalRegion, 
     analyteRegion, 
     washRegion,
     x,
     xLabel,
     boundary,
     violinPlotToggle,
     boxPlotToggle,
     boxWidth,
     y,
     yLabel,
     pattern,
     i,
     result)
  invisible(gc())
}
```

# Report {.tabset}
## Time Series Analysis
The report highlights the deviation significance of the samples from the average mean performance of the prewash region.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal    
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Display result
  if (ncol(analysisResult_TS) != 0) {
    print(DT::datatable(data = analysisResult_TS %>%
                          dplyr::select(all_of(colnames(analysisResult_TS)[which(colnames(analysisResult_TS) == sampleID):
                                                                           which(colnames(analysisResult_TS) == spectrumCount)]),
                                        prewashRegion, sampleRange) %>%
                          dplyr::filter(.data[[projectCohort]] != "Historical"),
                        filter = "top",
                        options = list(scrollX = TRUE)) %>%
            DT::formatStyle("sampleRange",
                            target = "row",
                            backgroundColor = styleEqual(c("Very Low", "Low", "Normal", "High", "Very High"), 
                                                         c("red", "yellow", "green", "yellow", "red"))))
  } else {
    print("Unable to display results - No available data")
  }
  
  # Clean environment
  rm(analysisResult_TS)
  invisible(gc())
}
```

## Violin Plot Analysis {.tabset}
The reports below highlights the deviation significance of the samples from the average mean of the overall data distribution in the mass calibration and analyte regions, respectively. 

### Mass Calibration Region
The report highlights the deviation significance of the performance of the mass calibration references present within the samples.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal    
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Display result
  if (ncol(analysisResult_VP_massCalRegion) != 0) {
    print(DT::datatable(data = analysisResult_VP_massCalRegion %>%
                          dplyr::select(all_of(
                            colnames(analysisResult_VP_massCalRegion)[which(colnames(analysisResult_VP_massCalRegion) == sampleID):
                                                                      which(colnames(analysisResult_VP_massCalRegion) == spectrumCount)]),
                            massCalRegion, sampleRange) %>%
                          dplyr::filter(.data[[projectCohort]] != "Historical"),
                        filter = "top",
                        options = list(scrollX = TRUE)) %>%
            DT::formatStyle("sampleRange",
                            target = "row",
                            backgroundColor = styleEqual(c("Very Low", "Low", "Normal", "High", "Very High"), 
                                                         c("red", "yellow", "green", "yellow", "red"))))
  } else {
    print("Unable to display results - No available data")
  }
  
  # Clean environment
  rm(analysisResult_VP_massCalRegion)
  invisible(gc())
}
```

### Analyte Region
The report highlights deviation significance of the combined performance of the internal standards and endogenous analytes present within the samples.

**RED** = Very High or Very Low  
**YELLOW** = Low or High  
**GREEN** = Normal    
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Display result
  if (ncol(analysisResult_VP_analyteRegion) != 0) {
    print(DT::datatable(data = analysisResult_VP_analyteRegion %>%
                          dplyr::select(all_of(
                            colnames(analysisResult_VP_analyteRegion)[which(colnames(analysisResult_VP_analyteRegion) == sampleID):
                                                                      which(colnames(analysisResult_VP_analyteRegion) == spectrumCount)]),
                            analyteRegion, sampleRange) %>%
                          dplyr::filter(.data[[projectCohort]] != "Historical"),
                        filter = "top",
                        options = list(scrollX = TRUE)) %>%
            DT::formatStyle("sampleRange",
                            target = "row",
                            backgroundColor = styleEqual(c("Very Low", "Low", "Normal", "High", "Very High"), 
                                                         c("red", "yellow", "green", "yellow", "red"))))
  } else {
    print("Unable to display results - No available data")
  }
  
  # Clean environment
  rm(analysisResult_VP_analyteRegion)
  invisible(gc())
}

# Check new sample status
if (newStatus) {
  # Clean environment
  rm(msStatus)
}
```

# Base Peak Chromatogram {.tabset}
Chromatogram overview (Base Peak Intensity, BPI vs Retention Time, RT) of each sample type along with 3 chromatographic regions of interest (mass calibration, analyte, and wash regions) are plotted using full scan MS level 1 spectral data. 
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newStatus) {
  # Check if spectral data is available
  if (any(passedData[[msLevel]] == 1)) {
    # Update spectral data status
    msStatus <- TRUE
    
    # Extract plot data
    plotData <- passedData %>% 
      dplyr::filter(.data[[msLevel]] == 1) %>%
      dplyr::select(all_of(colnames(passedData)[which(colnames(passedData) == sampleID):
                                                which(colnames(passedData) == spectrumCount)]),
                    retentionTime, basePeakIntensity)
    
    # If historical data exists
    if (file.exists(historicalDataPath)) {
      historicalData <- readRDS(historicalDataPath)
      
      # Filter historical data
      historicalData <- historicalData %>%
        dplyr::filter(.data[[msLevel]] == 1) %>%
        dplyr::select(all_of(colnames(historicalData)[which(colnames(historicalData) == sampleID):
                                                      which(colnames(historicalData) == spectrumCount)]),
                      retentionTime, basePeakIntensity)
      
      # Merge historical data and plot data
      plotData <- rbind(historicalData, plotData)
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
    x <- retentionTime
    y <- basePeakIntensity
    title <- "Base Peak Chromatogram"
    xLabel <- "RT"
    yLabel <- "BPI"
    
      # Colour grouping variable and label
      if (length(unique(plotData[[projectCohort]])) > 1) {
        colour <- projectCohort
        colourLabel <- "Project"
      } else {
        colour <- plate
        colourLabel <- "Plate"
      }
  } else {
    # Update spectral data status
    msStatus <- FALSE
    print("Unable to display Base Peak Chromatogram: No available MS level 1 spectral data")
  }
} else {
  print("Unable to display Base Peak Chromatogram: No new samples to analyse")
}
```

## LTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma",
               "sLTR Serum", "LTR Serum",
               "sLTR Urine", "LTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern combination that exists
    for (i in unique(sub("sLTR |LTR ", "", pattern))) {
      # If any of the combined pattern exists
      tmpPattern <- c(paste("sLTR", i), paste("LTR", i))
      if (any(tmpPattern %in% sampleTypeList)) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% tmpPattern),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = paste("LTR", i),
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
      
      # Clean environment
      rm(tmpPattern)
    }
  } else {
    print("No available data")
  }
}
```

## dLTR
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dLTR Plasma", "dLTR Serum", "dLTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
}
```

## PQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("PQC Plasma", "PQC Serum", "PQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
}
```

## dPQC
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dPQC Plasma", "dPQC Serum", "dPQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
}
```

## QC
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("QC01", "QC02", "QC03", "QC04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
}
```

## CAL
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("CAL01", "CAL02", "CAL03", "CAL04", "CAL05", "CAL06", "CAL07", "CAL08")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
}
```

## Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("Single Blank", "Double Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
}
```

## Sample
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("Sample Plasma", "Sample Serum", "Sample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = x,
                               y = y,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
}
```

## dSample
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Sample type patterns
  pattern <- c("dSample Plasma", "dSample Serum", "dSample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Generate chromatogram plot for each pattern that exists
    for (i in pattern) {
      # If pattern exists
      if (i %in% sampleTypeList) {
        # Plot chromatogram
        ticq::plotChromatogram(data = plotData %>%
                                 dplyr::filter(.data[[sampleType]] %in% i),
                               x = retentionTime,
                               y = basePeakIntensity,
                               colour = colour,
                               title = title,
                               subtitle = i,
                               xLabel = xLabel,
                               yLabel = yLabel,
                               colourLabel = colourLabel,
                               chromatogramRegion = chromatogramRegion)
      }
    }
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData, x, y, title, xLabel, yLabel, colour, colourLabel, pattern, i)
  invisible(gc())
}

# Check new sample status
if (newStatus) {
  # Clean environment
  rm(msStatus)
}
```

# Extracted Ion Chromatogram {.tabset}
Chromatogram overview (Extracted Ion Current, EIC vs Retention Time, RT) of targeted mass calibration references, internal standards, endogenous analytes, and product ions present within the samples are plotted by their corresponding chromatogram region and sample type. The chromatograms are plotted using MS level 1 spectral data for mass calibration references, internal standards, and endogenous analytes; whereas MS level 2 spectral data is used for product ions. 
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and availability of target m/z data
if (newStatus && !is.null(targetMZ)) {
  # Filter target m/z data against MS level of spectral data present
  targetMZ <- targetMZ[targetMZ$msLevel %in% unique(passedData[[msLevel]]), ]
  if (nrow(targetMZ) == 0) {
    # Update new sample status
    newStatus <- FALSE
    print("Unable to generate Extracted Ion Chromatogram: No available target m/z data")
  }
} else if (!newStatus) {
  print("Unable to generate Extracted Ion Chromatogram: No new samples to analyse")
} else if (is.null(targetMZ)) {
  # Update new sample status
  newStatus <- FALSE
  print("Unable to generate Extracted Ion Chromatogram: No available target m/z data")
}
```

```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newStatus) {
  # Common data columns
  commonColumn <- colnames(passedData)[which(colnames(passedData) == sampleID):which(colnames(passedData) == spectrumCount)]
  
  # Plot variables and labels
  x <- retentionTime
  caption <- "m/z"
  xLabel <- "RT"
  yLabel <- "EIC"
  nPlotCol <- 2
  nPlotRow <- 2
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample status
if (newStatus) {
  # Check if spectral data is available
  if (any(passedData[[msLevel]] == 1)) {
    # Update spectral data status
    msStatus <- TRUE
    
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 1)
    
    # If historical data exists
    if (file.exists(historicalDataPath)) {
      historicalData <- readRDS(historicalDataPath)
      
      # Filter historical data
      historicalData <- historicalData %>%
        dplyr::filter(.data[[msLevel]] == 1)
      
      # Merge historical data and plot data
      plotData <- rbind(historicalData, plotData)
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
      # Colour grouping variable and label
      if (length(unique(plotData[[projectCohort]])) > 1) {
        colour <- projectCohort
        colourLabel <- "Project"
      } else {
        colour <- plate
        colourLabel <- "Plate"
      }
    
    # Extract intensity of each target m/z (EIC) detected in spectra into columns
    plotData <- ticq::extractEIC(data = plotData,
                                 intensityArray = intensityArray,
                                 targetList = as.character(sort(unique(targetMZ$mzValue))))
  } else {
    # Update spectral data status
    msStatus <- FALSE
  }
}
```

## Mass Calibration References {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Filter and sort unique target m/z
  targetList <- targetMZ %>%
    dplyr::filter(analyteType == "Mass Calibration" & msLevel == 1)
  targetList <- as.character(sort(unique(targetList$mzValue)))
  
  # Check availability of target m/z
  if (length(targetList) > 0) {
    # Update target m/z status
    targetStatus <- TRUE
    
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(data = plotData %>%
                                                          dplyr::select(all_of(commonColumn),
                                                                        retentionTime,
                                                                        all_of(targetList)),
                                                        regionOfInterest = chromatogramRegion$massCal,
                                                        retentionTime = retentionTime)
    
    # Plot variables and labels
    startIDX <- which(colnames(plotData_filtered) == targetList[1])
  } else {
    # Update target m/z status
    targetStatus <- FALSE
    print("Unable to display Extracted Ion Chromatogram: No available target m/z data")
  }
} else if (newStatus && !msStatus) {
  print("Unable to display Extracted Ion Chromatogram: No available MS level 1 spectral data")
}
```

### LTR {.tabset}
#### LTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### LTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### LTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### dLTR {.tabset}
#### dLTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dLTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dLTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### PQC {.tabset}
#### PQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### PQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### PQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### dPQC {.tabset}
#### dPQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>% 
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dPQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dPQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### QC {.tabset}
#### QC01
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### QC02
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### QC03
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### QC04
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### CAL {.tabset}
#### CAL01
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL02
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL03
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL04
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL05
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL05")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL06
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL06")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL07
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL07")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL08
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL08")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### Blank {.tabset}
#### Single Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Single Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### Double Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Double Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### Sample {.tabset}
#### Sample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### Sample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### Sample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### dSample {.tabset}
#### dSample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dSample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dSample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData_filtered, startIDX, pattern)
  invisible(gc())
}
```

## Internal Standards {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Filter and sort unique target m/z
  targetList <- targetMZ %>%
    dplyr::filter(analyteType == "Internal Standard" & msLevel == 1)
  targetList <- as.character(sort(unique(targetList$mzValue)))
  
  # Check availability of target m/z
  if (length(targetList) > 0) {
    # Update target m/z status
    targetStatus <- TRUE
    
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(data = plotData %>%
                                                          dplyr::select(all_of(commonColumn),
                                                                        retentionTime,
                                                                        all_of(targetList)),
                                                        regionOfInterest = chromatogramRegion$analyte,
                                                        retentionTime = retentionTime)
    
    # Plot variables and labels
    startIDX <- which(colnames(plotData_filtered) == targetList[1])
  } else {
    # Update target m/z status
    targetStatus <- FALSE
    print("Unable to display Extracted Ion Chromatogram: No available target m/z data")
  }
} else if (newStatus && !msStatus) {
  print("Unable to display Extracted Ion Chromatogram: No available MS level 1 spectral data")
}
```

### LTR {.tabset}
#### LTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### LTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### LTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### dLTR {.tabset}
#### dLTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dLTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dLTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### PQC {.tabset}
#### PQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### PQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### PQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### dPQC {.tabset}
#### dPQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>% 
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dPQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dPQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### QC {.tabset}
#### QC01
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### QC02
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### QC03
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### QC04
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### CAL {.tabset}
#### CAL01
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL02
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL03
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL04
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL05
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL05")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL06
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL06")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL07
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL07")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL08
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL08")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### Blank {.tabset}
#### Single Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Single Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### Double Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Double Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### Sample {.tabset}
#### Sample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### Sample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### Sample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### dSample {.tabset}
#### dSample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dSample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dSample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData_filtered, startIDX, pattern)
  invisible(gc())
}
```

## Endogenous Analytes {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Filter and sort unique target m/z
  targetList <- targetMZ %>%
    dplyr::filter(analyteType == "Analyte" & msLevel == 1)
  targetList <- as.character(sort(unique(targetList$mzValue)))
  
  # Check availability of target m/z
  if (length(targetList) > 0) {
    # Update target m/z status
    targetStatus <- TRUE
    
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(data = plotData %>%
                                                          dplyr::select(all_of(commonColumn),
                                                                        retentionTime,
                                                                        all_of(targetList)),
                                                        regionOfInterest = chromatogramRegion$analyte,
                                                        retentionTime = retentionTime)
    
    # Plot variables and labels
    startIDX <- which(colnames(plotData_filtered) == targetList[1])
  } else {
    # Update target m/z status
    targetStatus <- FALSE
    print("Unable to display Extracted Ion Chromatogram: No available target m/z data")
  }
} else if (newStatus && !msStatus) {
  print("Unable to display Extracted Ion Chromatogram: No available MS level 1 spectral data")
}
```

### LTR {.tabset}
#### LTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### LTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### LTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### dLTR {.tabset}
#### dLTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dLTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dLTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### PQC {.tabset}
#### PQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### PQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### PQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### dPQC {.tabset}
#### dPQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>% 
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dPQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dPQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### QC {.tabset}
#### QC01
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### QC02
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### QC03
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### QC04
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### CAL {.tabset}
#### CAL01
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL02
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL03
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL04
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL05
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL05")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL06
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL06")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL07
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL07")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL08
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL08")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### Blank {.tabset}
#### Single Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Single Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### Double Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Double Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### Sample {.tabset}
#### Sample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### Sample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### Sample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### dSample {.tabset}
#### dSample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dSample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dSample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData_filtered, startIDX, pattern)
  invisible(gc())
}

# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Clean environment
  rm(msStatus, plotData, colour, colourLabel, targetList, targetStatus)
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample status
if (newStatus) {
  # Check if spectral data is available
  if (any(passedData[[msLevel]] == 2)) {
    # Update spectral data status
    msStatus <- TRUE
    
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 2)
    
    # If historical data exists
    if (file.exists(historicalDataPath)) {
      historicalData <- readRDS(historicalDataPath)
      
      # Filter historical data
      historicalData <- historicalData %>%
        dplyr::filter(.data[[msLevel]] == 2)
      
      # Merge historical data and plot data
      plotData <- rbind(historicalData, plotData)
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
      # Colour grouping variable and label
      if (length(unique(plotData[[projectCohort]])) > 1) {
        colour <- projectCohort
        colourLabel <- "Project"
      } else {
        colour <- plate
        colourLabel <- "Plate"
      }
    
    # Extract intensity of each target m/z (EIC) detected in spectra into columns
    plotData <- ticq::extractEIC(data = plotData,
                                 intensityArray = intensityArray,
                                 targetList = as.character(sort(unique(targetMZ$mzValue))))
  } else {
    # Update spectral data status
    msStatus <- FALSE
  }
}
```

## Product Ions {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Filter and sort unique target m/z
  targetList <- targetMZ %>%
    dplyr::filter(analyteType == "Product" & msLevel == 2)
  targetList <- as.character(sort(unique(targetList$mzValue)))
  
  # Check availability of target m/z
  if (length(targetList) > 0) {
    # Update target m/z status
    targetStatus <- TRUE
    
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(data = plotData %>%
                                                          dplyr::select(all_of(commonColumn),
                                                                        retentionTime,
                                                                        all_of(targetList)),
                                                        regionOfInterest = chromatogramRegion$analyte,
                                                        retentionTime = retentionTime)
    
    # Plot variables and labels
    startIDX <- which(colnames(plotData_filtered) == targetList[1])
  } else {
    # Update target m/z status
    targetStatus <- FALSE
    print("Unable to display Extracted Ion Chromatogram: No available target m/z data")
  }
} else if (newStatus && !msStatus) {
  print("Unable to display Extracted Ion Chromatogram: No available MS level 1 spectral data")
}
```

### LTR {.tabset}
#### LTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### LTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### LTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### dLTR {.tabset}
#### dLTR Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dLTR Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dLTR Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### PQC {.tabset}
#### PQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### PQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### PQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### dPQC {.tabset}
#### dPQC Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>% 
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dPQC Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dPQC Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### QC {.tabset}
#### QC01
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### QC02
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### QC03
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### QC04
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### CAL {.tabset}
#### CAL01
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL02
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL03
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL04
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL05
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL05")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL06
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL06")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL07
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL07")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### CAL08
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL08")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### Blank {.tabset}
#### Single Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Single Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### Double Blank
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Double Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### Sample {.tabset}
#### Sample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### Sample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### Sample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

### dSample {.tabset}
#### dSample Plasma
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dSample Serum
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
}
```

#### dSample Urine
```{r, echo = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot chromatogram
    ticq::plotMultipleChromatogram(data = plotData_filtered %>%
                                     dplyr::filter(.data[[sampleType]] %in% pattern),
                                   x = x,
                                   startIDX = startIDX,
                                   colour = colour,
                                   caption = caption,
                                   xLabel = xLabel,
                                   yLabel = yLabel,
                                   colourLabel = colourLabel,
                                   nPlotCol = nPlotCol,
                                   nPlotRow = nPlotRow)
  } else {
    print("No available data")
  }
  
  # Clean environment
  rm(plotData_filtered, startIDX, pattern)
  invisible(gc())
}

# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Clean environment
  rm(plotData, colour, colourLabel, targetList, targetStatus)
}

# Check new sample status
if (newStatus) {
  # Clean environment
  rm(commonColumn, x, caption, xLabel, yLabel, nPlotCol, nPlotRow, msStatus)
}
```

# Statistical Analysis {.tabset}
The mass calibration references, internal standards, endogenous analytes, and product ions of interest present within the samples are assessed by their corresponding chromatogram region and sample type using statistical methodologies such as time series analysis.

## Time Series Analysis {.tabset}
Time series analysis provides a temporal trendline and assesses the performance of the mass calibration references, internal standards, endogenous analytes, and product ions by their corresponding target m/z, chromatogram region, and sample type. A report is generated highlighting the target m/z that have a significant 1st and 2nd standard deviation from the average mean performance.
```{r, echo = FALSE, warning = FALSE}
# Check new sample status
if (newStatus) {
  # Common data columns
  commonColumn <- colnames(passedData)[which(colnames(passedData) == sampleID):
                                       which(colnames(passedData) == spectrumCount)]
  
  # Plot variables and labels
  x <- timestamp
  caption <- "m/z"
  xLabel <- "Timestamp"
  yLabel <- "EIC"
  shape <- sampleType
  shapeLabel <- "Sample Type"
  boundary <- "sd"
  xTickToggle <- FALSE
  nPlotCol <- 2
  nPlotRow <- 2
} else {
  print("Unable to perform Time Series Analysis: No new samples to analyse")
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample status
if (newStatus) {
  # Check if spectral data is available
  if (any(passedData[[msLevel]] == 1)) {
    # Update spectral data status
    msStatus <- TRUE
    
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 1)
    
    # If historical data exists
    if (file.exists(historicalDataPath)) {
      historicalData <- readRDS(historicalDataPath)
      
      # Filter historical data
      historicalData <- historicalData %>%
        dplyr::filter(.data[[msLevel]] == 1)
      
      # Merge historical data and plot data
      plotData <- rbind(historicalData, plotData)
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
      # Colour grouping variable and label
      if (length(unique(plotData[[projectCohort]])) > 1) {
        colour <- projectCohort
        colourLabel <- "Project"
      } else {
        colour <- plate
        colourLabel <- "Plate"
      }
    
    # Extract intensity of each target m/z (EIC) detected in spectra into columns
    plotData <- ticq::extractEIC(data = plotData,
                                 intensityArray = intensityArray,
                                 targetList = as.character(sort(unique(targetMZ$mzValue))))
  } else {
    # Update spectral data status
    msStatus <- FALSE
  }
}
```

### Mass Calibration References {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Filter and sort unique target m/z
  targetList <- targetMZ %>%
    dplyr::filter(analyteType == "Mass Calibration" & msLevel == 1)
  targetList <- as.character(sort(unique(targetList$mzValue)))
  
  # Check availability of target m/z
  if (length(targetList) > 0) {
    # Update target m/z status
    targetStatus <- TRUE
    
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(data = plotData %>%
                                                          dplyr::select(all_of(commonColumn),
                                                                        retentionTime,
                                                                        all_of(targetList)),
                                                        regionOfInterest = chromatogramRegion$massCal,
                                                        retentionTime = retentionTime)
    
    # Sum intensity values of target m/z (EIC)
    plotData_filtered <- ticq::sumEIC(data = plotData_filtered,
                                      commonColumn = commonColumn,
                                      spectrumCount = spectrumCount,
                                      startIDX = which(colnames(plotData_filtered) == targetList[1]))
    
    # Plot variables and labels
    startIDX <- which(colnames(plotData_filtered) == targetList[1])
    
    # Data frame to store analysis result
    analysisResult_TS_massCal <- data.frame()
  } else {
    # Update target m/z status
    targetStatus <- FALSE
    print("Unable to perform Time Series Analysis: No available target m/z data")
  }
} else if (newStatus && !msStatus) {
  print("Unable to perform Time Series Analysis: No available MS level 1 spectral data")
}
```

#### LTR {.tabset}
##### LTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else {
    print("No available data")
  }
}
```

##### LTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### LTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

#### dLTR {.tabset}
##### dLTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### dLTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### dLTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

#### PQC {.tabset}
##### PQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### PQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### PQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

#### dPQC {.tabset}
##### dPQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### dPQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### dPQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

#### QC {.tabset}
##### QC01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### QC02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### QC03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### QC04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

#### CAL {.tabset}
##### CAL01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL05
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL05")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL06
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL06")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL07
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL07")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL08
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL08")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

#### Blank {.tabset}
##### Single Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Single Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

##### Double Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Double Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
  } else { 
    print("No available data") 
  }
}
```

#### Sample {.tabset}
##### Sample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("sLTR Plasma", "LTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("sLTR Serum", "LTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("sLTR Urine", "LTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

#### dSample {.tabset}
##### dSample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("dLTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("dLTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("dLTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_massCal <- rbind(analysisResult_TS_massCal, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
  
    
  # Clean environment
  rm(plotData_filtered, startIDX, pattern, result)
  invisible(gc())
}
```

### Internal Standards {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Filter and sort unique target m/z
  targetList <- targetMZ %>%
    dplyr::filter(analyteType == "Internal Standard" & msLevel == 1)
  targetList <- as.character(sort(unique(targetList$mzValue)))
  
  # Check availability of target m/z
  if (length(targetList) > 0) {
    # Update target m/z status
    targetStatus <- TRUE
    
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(data = plotData %>%
                                                          dplyr::select(all_of(commonColumn),
                                                                        retentionTime,
                                                                        all_of(targetList)),
                                                        regionOfInterest = chromatogramRegion$analyte,
                                                        retentionTime = retentionTime)
    
    # Sum intensity values of target m/z (EIC)
    plotData_filtered <- ticq::sumEIC(data = plotData_filtered,
                                      commonColumn = commonColumn,
                                      spectrumCount = spectrumCount,
                                      startIDX = which(colnames(plotData_filtered) == targetList[1]))
    
    # Plot variables and labels
    startIDX <- which(colnames(plotData_filtered) == targetList[1])
    
    # Data frame to store analysis result
    analysisResult_TS_istd <- data.frame()
  } else {
    # Update target m/z status
    targetStatus <- FALSE
    print("Unable to perform Time Series Analysis: No available target m/z data")
  }
} else if (newStatus && !msStatus) {
  print("Unable to perform Time Series Analysis: No available MS level 1 spectral data")
}
```

#### LTR {.tabset}
##### LTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else {
    print("No available data")
  }
}
```

##### LTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### LTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

#### dLTR {.tabset}
##### dLTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### dLTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### dLTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

#### PQC {.tabset}
##### PQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### PQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### PQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

#### dPQC {.tabset}
##### dPQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### dPQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### dPQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

#### QC {.tabset}
##### QC01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### QC02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### QC03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### QC04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

#### CAL {.tabset}
##### CAL01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL05
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL05")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL06
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL06")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL07
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL07")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL08
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL08")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

#### Blank {.tabset}
##### Single Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Single Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

##### Double Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Double Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
  } else { 
    print("No available data") 
  }
}
```

#### Sample {.tabset}
##### Sample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("sLTR Plasma", "LTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("sLTR Serum", "LTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("sLTR Urine", "LTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

#### dSample {.tabset}
##### dSample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("dLTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("dLTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("dLTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_istd <- rbind(analysisResult_TS_istd, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
  
    
  # Clean environment
  rm(plotData_filtered, startIDX, pattern, result)
  invisible(gc())
}
```

### Endogenous Analytes {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Filter and sort unique target m/z
  targetList <- targetMZ %>%
    dplyr::filter(analyteType == "Analyte" & msLevel == 1)
  targetList <- as.character(sort(unique(targetList$mzValue)))
  
  # Check availability of target m/z
  if (length(targetList) > 0) {
    # Update target m/z status
    targetStatus <- TRUE
    
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(data = plotData %>%
                                                          dplyr::select(all_of(commonColumn),
                                                                        retentionTime,
                                                                        all_of(targetList)),
                                                        regionOfInterest = chromatogramRegion$analyte,
                                                        retentionTime = retentionTime)
    
    # Sum intensity values of target m/z (EIC)
    plotData_filtered <- ticq::sumEIC(data = plotData_filtered,
                                      commonColumn = commonColumn,
                                      spectrumCount = spectrumCount,
                                      startIDX = which(colnames(plotData_filtered) == targetList[1]))
    
    # Plot variables and labels
    startIDX <- which(colnames(plotData_filtered) == targetList[1])
    
    # Data frame to store analysis result
    analysisResult_TS_analyte <- data.frame()
  } else {
    # Update target m/z status
    targetStatus <- FALSE
    print("Unable to perform Time Series Analysis: No available target m/z data")
  }
} else if (newStatus && !msStatus) {
  print("Unable to perform Time Series Analysis: No available MS level 1 spectral data")
}
```

#### LTR {.tabset}
##### LTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else {
    print("No available data")
  }
}
```

##### LTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### LTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

#### dLTR {.tabset}
##### dLTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### dLTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### dLTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

#### PQC {.tabset}
##### PQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### PQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### PQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

#### dPQC {.tabset}
##### dPQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### dPQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### dPQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

#### QC {.tabset}
##### QC01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### QC02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### QC03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### QC04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

#### CAL {.tabset}
##### CAL01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL05
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL05")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL06
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL06")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL07
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL07")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL08
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL08")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

#### Blank {.tabset}
##### Single Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Single Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

##### Double Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Double Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
  } else { 
    print("No available data") 
  }
}
```

#### Sample {.tabset}
##### Sample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("sLTR Plasma", "LTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("sLTR Serum", "LTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("sLTR Urine", "LTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

#### dSample {.tabset}
##### dSample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("dLTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("dLTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("dLTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_analyte <- rbind(analysisResult_TS_analyte, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
  
    
  # Clean environment
  rm(plotData_filtered, startIDX, pattern, result)
  invisible(gc())
}

# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Clean environment
  rm(plotData, colour, colourLabel, targetList, targetStatus)
}
```

```{r, echo = FALSE, warning = FALSE, include = FALSE}
# Check new sample status
if (newStatus) {
  # Check if spectral data is available
  if (any(passedData[[msLevel]] == 2)) {
    # Update spectral data status
    msStatus <- TRUE
    
    # Extract plot data
    plotData <- passedData %>%
      dplyr::filter(.data[[msLevel]] == 2)
    
    # If historical data exists
    if (file.exists(historicalDataPath)) {
      historicalData <- readRDS(historicalDataPath)
      
      # Filter historical data
      historicalData <- historicalData %>%
        dplyr::filter(.data[[msLevel]] == 2)
      
      # Merge historical data and plot data
      plotData <- rbind(historicalData, plotData)
      
      # Clean environment
      rm(historicalData)
      invisible(gc())
    }
    
    # Plot variables and labels
      # Colour grouping variable and label
      if (length(unique(plotData[[projectCohort]])) > 1) {
        colour <- projectCohort
        colourLabel <- "Project"
      } else {
        colour <- plate
        colourLabel <- "Plate"
      }
    
    # Extract intensity of each target m/z (EIC) detected in spectra into columns
    plotData <- ticq::extractEIC(data = plotData,
                                 intensityArray = intensityArray,
                                 targetList = as.character(sort(unique(targetMZ$mzValue))))
  } else {
    # Update spectral data status
    msStatus <- FALSE
  }
}
```

### Product Ions {.tabset}
```{r, echo = FALSE, warning = FALSE}
# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Filter and sort unique target m/z
  targetList <- targetMZ %>%
    dplyr::filter(analyteType == "Product" & msLevel == 2)
  targetList <- as.character(sort(unique(targetList$mzValue)))
  
  # Check availability of target m/z
  if (length(targetList) > 0) {
    # Update target m/z status
    targetStatus <- TRUE
    
    # Filter plot data for chromatogram region of interest
    plotData_filtered <- ticq::filterChromatogramRegion(data = plotData %>%
                                                          dplyr::select(all_of(commonColumn),
                                                                        retentionTime,
                                                                        all_of(targetList)),
                                                        regionOfInterest = chromatogramRegion$analyte,
                                                        retentionTime = retentionTime)
    
    # Sum intensity values of target m/z (EIC)
    plotData_filtered <- ticq::sumEIC(data = plotData_filtered,
                                      commonColumn = commonColumn,
                                      spectrumCount = spectrumCount,
                                      startIDX = which(colnames(plotData_filtered) == targetList[1]))
    
    # Plot variables and labels
    startIDX <- which(colnames(plotData_filtered) == targetList[1])
    
    # Data frame to store analysis result
    analysisResult_TS_product <- data.frame()
  } else {
    # Update target m/z status
    targetStatus <- FALSE
    print("Unable to perform Time Series Analysis: No available target m/z data")
  }
} else if (newStatus && !msStatus) {
  print("Unable to perform Time Series Analysis: No available MS level 1 spectral data")
}
```

#### LTR {.tabset}
##### LTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Plasma", "LTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else {
    print("No available data")
  }
}
```

##### LTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Serum", "LTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### LTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("sLTR Urine", "LTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

#### dLTR {.tabset}
##### dLTR Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### dLTR Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### dLTR Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dLTR Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

#### PQC {.tabset}
##### PQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### PQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### PQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("PQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

#### dPQC {.tabset}
##### dPQC Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### dPQC Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### dPQC Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dPQC Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

#### QC {.tabset}
##### QC01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### QC02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### QC03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### QC04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("QC04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

#### CAL {.tabset}
##### CAL01
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL01")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL02
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL02")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL03
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL03")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL04
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL04")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL05
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL05")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL06
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL06")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL07
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL07")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### CAL08
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("CAL08")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

#### Blank {.tabset}
##### Single Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Single Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

##### Double Blank
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Double Blank")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% pattern),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
  } else { 
    print("No available data") 
  }
}
```

#### Sample {.tabset}
##### Sample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("sLTR Plasma", "LTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("sLTR Serum", "LTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### Sample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("Sample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("sLTR Urine", "LTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

#### dSample {.tabset}
##### dSample Plasma
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Plasma")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("dLTR Plasma")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Serum
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Serum")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("dLTR Serum")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
}
```

##### dSample Urine
```{r, echo = FALSE, warning = FALSE, warning = FALSE}
# Check new sample status, spectral data status and target m/z status
if (newStatus && msStatus && targetStatus) {
  # Sample type patterns
  pattern <- c("dSample Urine")
  
  # Check if any of the patterns exists in sample type list
  if (any(pattern %in% sampleTypeList)) {
    # Search long term references for comparison
    tmpPattern <- c("dLTR Urine")
    referenceData <- plotData_filtered %>%
      dplyr::filter(.data[[sampleType]] %in% tmpPattern)
    
    # Plot time series
    result <- ticq::plotMultipleTimeSeries(data = plotData_filtered %>%
                                             dplyr::filter(.data[[sampleType]] %in% c(tmpPattern, pattern)),
                                           commonColumn = commonColumn,
                                           x = x,
                                           startIDX = startIDX,
                                           colour = colour,
                                           shape = shape,
                                           caption = caption,
                                           xLabel = xLabel,
                                           yLabel = yLabel,
                                           colourLabel = colourLabel,
                                           shapeLabel = shapeLabel,
                                           boundary = boundary,
                                           referenceData = referenceData,
                                           xTickToggle = xTickToggle,
                                           nPlotCol = nPlotCol,
                                           nPlotRow = nPlotRow) %>%
      dplyr::filter(.data[[sampleType]] %in% pattern)
    
    # Append result to overall 
    analysisResult_TS_product <- rbind(analysisResult_TS_product, result)
    
    # Clean environment
    rm(tmpPattern, referenceData)
    invisible(gc())
  } else { 
    print("No available data") 
  }
  
    
  # Clean environment
  rm(plotData_filtered, startIDX, pattern, result)
  invisible(gc())
}

# Check new sample status and spectral data status
if (newStatus && msStatus) {
  # Clean environment
  rm(plotData, colour, colourLabel, targetList, targetStatus)
}

# Check new sample status
if (newStatus) {
  # Clean environment
  rm(commonColumn, x, caption, xLabel, yLabel, shape, shapeLabel, boundary, xTickToggle, nPlotCol, nPlotRow, msStatus)
}
```
